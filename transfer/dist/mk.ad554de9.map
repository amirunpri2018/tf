{"version":3,"sources":["src/mk.js"],"names":["console","log","images","mk","ATTACK","GAME_END","ARENAS","FIGHTERS","STEP_DURATION","PLAYER_TOP","BLOCK_DAMAGE","controllers","Base","options","_callbacks","callbacks","_initializeFighters","fighters","a","arena","arenas","Arena","width","height","container","game","reset","forEach","f","getMove","stop","_opponents","destroy","prototype","i","length","push","Fighter","name","orientation","orientations","LEFT","RIGHT","getName","getOpponent","init","promise","current","total","setMove","moves","types","STAND","_setFighersArena","_initialize","_initialized","setArena","setX","fighterAttacked","fighter","damage","opponent","opponentLife","getLife","callback","_requiredDistance","_attackCompatible","type","endureAttack","call","attack","opponentStand","m","SQUAT","LOW_PUNCH","LOW_KICK","attacker","fMiddle","getX","getWidth","oMiddle","distance","Math","abs","UPPERCUT","BACKWARD_JUMP_KICK","FORWARD_JUMP_KICK","FORWARD_JUMP_PUNCH","BACKWARD_JUMP_PUNCH","fighterDead","WIN","keys","UP","DOWN","BLOCK","HP","LP","LK","HK","Basic","_player","_addHandlers","pressed","self","document","addEventListener","e","keyCode","move","_getMove","_moveFighter","k","p","leftOrient","rightOrient","orient","getOrientation","Object","BACKWARD_JUMP","SPIN_KICK","WALK_BACKWARD","FORWARD_JUMP","WALK","SQUAT_LOW_KICK","SQUAT_HIGH_KICK","SQUAT_LOW_PUNCH","HIGH_KICK","JUMP","HIGH_PUNCH","STAND_UP","WebcamInput","_addMovementHandlers","window","Detect","onPunch","onKick","onStand","p1","p2","Multiplayer","f1","f2","Network","_isHost","isHost","_gameName","gameName","_transport","transport","Transports","socketio","PLAYER_CONNECTED","Requests","CREATE_GAME","JOIN_GAME","Responses","SUCCESS","GAME_EXISTS","GAME_NOT_EXISTS","GAME_FULL","Messages","EVENT","LIFE_UPDATE","POSITION_UPDATE","_socket","io","connect","emit","apply","arguments","on","_createGame","_addSocketHandlers","data","setLife","x","setY","y","setInterval","isJumping","getY","c","_joinGame","response","alert","start","gameType","Promise","toLowerCase","ready","TOWER","THRONE_ROOM","_container","_game","canvas","createElement","appendChild","_context","getContext","_canvas","refresh","removeChild","undefined","_drawArena","img","conf","config","texture","drawImage","src","onload","getState","moveFighter","pos","op","isOver","getVisibleHeight","getVisibleWidth","_synchronizeFighters","_setFightersOrientation","diff","min","setOrientation","FALL","ENDURE","SQUAT_ENDURE","KNOCK_DOWN","ATTRACTIVE_STAND_UP","Move","owner","stepDuration","_stepDuration","_interval","_currentStep","_actionPending","go","step","_beforeGo","_nextStep","_action","_steps","setState","_moveNextStep","loaded","o","_totalSteps","_getImageUrl","addHandlers","id","ownerOrientation","_beforeStop","clearInterval","func","_shouldStop","CycleMove","duration","steps","Stand","Walk","WalkBack","FiniteMove","_bottom","getBottom","lock","unlock","keepDistance","currentBottom","Fall","Win","Squat","Block","StandUp","AttractiveStandUp","Endure","KnockDown","xDisplacement","SquatEndure","Jump","_moveBack","ForwardJump","_ownerHeight","setHeight","BackwardJump","Attack","_damage","_hitPassed","_returnStand","returnStand","_returnStandStep","returnStandStep","_dontReturn","round","getDamage","HighKick","LowKick","LowPunch","HighPunch","Uppercut","SquatLowKick","SquatHighKick","SquatLowPunch","SpinKick","JumpAttack","isForward","_offset","_totalPics","_counter","JumpKick","JumpPunch","list","subzero","kano","_name","_arena","_life","_orientation","_width","_height","_locked","_position","initialized","_currentMove","typep","_currentState","setWidth","state","attackType","life","max","bottomY","currentMove"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAIA,aAJA,IAAA,EAAA,EAAA,QAAA,uBAIA,SAAA,EAAA,GAAA,GAAA,GAAA,EAAA,WAAA,OAAA,EAAA,IAAA,EAAA,GAAA,GAAA,MAAA,EAAA,IAAA,IAAA,KAAA,EAAA,GAAA,OAAA,UAAA,eAAA,KAAA,EAAA,GAAA,CAAA,IAAA,EAAA,OAAA,gBAAA,OAAA,yBAAA,OAAA,yBAAA,EAAA,GAAA,GAAA,EAAA,KAAA,EAAA,IAAA,OAAA,eAAA,EAAA,EAAA,GAAA,EAAA,GAAA,EAAA,GAAA,OAAA,EAAA,QAAA,EAAA,EAFAA,QAAQC,IAAIC,GAEZ,WACMC,IAAAA,EAAK,CAETA,UAAe,CACbC,OAAQ,SACRC,SAAU,YAGZF,OAAY,CACVG,OAAQ,SACRC,SAAU,WACVC,cAAe,GACfC,WAAY,IACZC,aAAc,IAGhBP,YAAiB,IAEjBA,EAAGQ,YAAYC,KAAO,SAASC,GACzB,GAACA,EAAD,CAECC,KAAAA,WAAaD,EAAQE,WAAa,GAElCC,KAAAA,oBAAoBH,EAAQI,UAE3BC,IAAAA,EAAIL,EAAQM,MACbA,KAAAA,MAAQ,IAAIhB,EAAGiB,OAAOC,MAAM,CAC/BJ,SAAU,KAAKA,SACfE,MAAOD,EAAEC,MACTG,MAAOJ,EAAEI,MACTC,OAAQL,EAAEK,OACVC,UAAWN,EAAEM,UACbC,KAAM,SAIVtB,EAAGuB,MAAQ,WACLD,IAAAA,EAAO,KAAKA,KACU,mBAAfA,EAAKC,OAAsBD,EAAKC,QAC3CD,EAAKR,SAASU,QAAQ,SAASC,GAC7BA,EAAEC,UAAUC,SAEdL,EAAKR,SAAW,KAChBQ,EAAKM,WAAa,KAClBN,EAAKN,MAAMa,UACXP,EAAKN,MAAQ,KACbM,EAAKX,WAAa,KACbW,KAAAA,KAAO,MAGdtB,EAAGQ,YAAYC,KAAKqB,UAAUjB,oBAAsB,SAASC,GACtDA,KAAAA,SAAW,GACXc,KAAAA,WAAa,GAEb,IAAA,IAAIG,EAAI,EAAGA,EAAIjB,EAASkB,OAAQD,GAAK,EACnCjB,KAAAA,SAASmB,KACZ,IAAIjC,EAAGc,SAASoB,QAAQ,CACtBC,KAAMrB,EAASiB,GAAGI,KAClBnB,MAAO,KAAKA,MACZoB,YAAmB,IAANL,EAAU/B,EAAGc,SAASuB,aAAaC,KAAOtC,EAAGc,SAASuB,aAAaE,MAChFjB,KAAM,QAIPM,KAAAA,WAAW,KAAKd,SAAS,GAAG0B,WAAa,KAAK1B,SAAS,GACvDc,KAAAA,WAAW,KAAKd,SAAS,GAAG0B,WAAa,KAAK1B,SAAS,IAG9Dd,EAAGQ,YAAYC,KAAKqB,UAAUW,YAAc,SAAShB,GAC5C,OAAA,KAAKG,WAAWH,EAAEe,QAAQL,QAGnCnC,EAAGQ,YAAYC,KAAKqB,UAAUY,KAAO,SAASC,GAGvC,IAHgD,IAAA,EAAA,KACjDC,EAAU,EACRC,EAAQ,KAAK/B,SAASkB,OACnBD,EAAAA,SAAAA,GACHN,IAAAA,EAAI,EAAKX,SAASiB,GACtBN,EAAEiB,KAAK,WACLjB,EAAEqB,QAAQ9C,EAAG+C,MAAMC,MAAMC,QACzBL,GAAW,KACKC,IACd,EAAK7B,MAAM0B,OACX,EAAKQ,mBACL,EAAKC,cACLR,EAAQS,mBATLrB,EAAI,EAAGA,EAAI,KAAKjB,SAASkB,OAAQD,GAAK,EAAtCA,EAAAA,IAeX/B,EAAGQ,YAAYC,KAAKqB,UAAUqB,YAAc,WACpC,KAAA,uDAGRnD,EAAGQ,YAAYC,KAAKqB,UAAUoB,iBAAmB,WAE1C,IADDzB,IAAAA,EACKM,EAAI,EAAGA,EAAI,KAAKjB,SAASkB,OAAQD,GAAK,GAC7CN,EAAI,KAAKX,SAASiB,IAChBsB,SAAS,KAAKrC,OAElBS,EAAE6B,KAAK,MAGTtD,EAAGQ,YAAYC,KAAKqB,UAAUyB,gBAAkB,SAASC,EAASC,GAC5DC,IAAAA,EAAW,KAAKjB,YAAYe,GAC9BG,EAAeD,EAASE,UACxBC,EAAW,KAAKlD,WAAWX,EAAGY,UAAUX,QAExC,KAAK6D,kBAAkBN,EAASE,IAChC,KAAKK,kBAAkBP,EAAQ9B,UAAUsC,KAAMN,EAAShC,UAAUsC,QAElEN,EAASO,aAAaR,EAAQD,EAAQ9B,UAAUsC,MACxB,mBAAbH,GACTA,EAASK,KAAK,KAAMV,EAASE,EAAUC,EAAeD,EAASE,aAKrE5D,EAAGQ,YAAYC,KAAKqB,UAAUiC,kBAAoB,SAASI,EAAQC,GAC7DC,IAAAA,EAAIrE,EAAG+C,MAAMC,MACboB,OAAAA,IAAkBC,EAAEC,OAClBH,IAAWE,EAAEE,WAAaJ,IAAWE,EAAEG,UAe/CxE,EAAGQ,YAAYC,KAAKqB,UAAUgC,kBAAoB,SAASW,EAAUf,GAC/DgB,IAAAA,EAAUD,EAASE,OAASF,EAASG,WAAa,EACpDC,EAAUnB,EAASiB,OAASjB,EAASkB,WAAa,EAClDE,EAAWC,KAAKC,IAAIN,EAAUG,GAC9BR,EAAIrE,EAAG+C,MAAMC,MACbgB,EAAOS,EAAS/C,UAAUsC,KAC1B7C,EAAQuC,EAASkB,WACfE,OAAAA,GAAY3D,IAGZ6C,IAASK,EAAEY,UAAYH,GAAoB,IAAR3D,IAIpC6C,IAASK,EAAEa,oBACVlB,IAASK,EAAEc,mBACXnB,IAASK,EAAEe,oBACXpB,IAASK,EAAEgB,sBACbP,GAAoB,IAAR3D,IAOhBnB,EAAGQ,YAAYC,KAAKqB,UAAUwD,YAAc,SAAS9B,GAC/CE,IAAAA,EAAW,KAAKjB,YAAYe,GAC9BK,EAAW,KAAKlD,WAAWX,EAAGY,UAAUV,UAC1CwD,EAAShC,UAAUC,OACnB+B,EAASZ,QAAQ9C,EAAG+C,MAAMC,MAAMuC,KACR,mBAAb1B,GACTA,EAASK,KAAK,KAAMV,IAIxBxD,EAAGQ,YAAYgF,KAAO,CACpBjD,MAAO,GACPD,KAAM,GACNmD,GAAI,GACJC,KAAM,GACNC,MAAO,GACPC,GAAI,GACJC,GAAI,GACJC,GAAI,GACJC,GAAI,IAGN/F,EAAGQ,YAAYwF,MAAQ,SAAStF,GAC9BV,EAAGQ,YAAYC,KAAKyD,KAAK,KAAMxD,IAGjCV,EAAGQ,YAAYwF,MAAMlE,UAAY,IAAI9B,EAAGQ,YAAYC,KAEpDT,EAAGQ,YAAYwF,MAAMlE,UAAUqB,YAAc,WACtC8C,KAAAA,QAAU,EACVC,KAAAA,gBAGPlG,EAAGQ,YAAYwF,MAAMlE,UAAUoE,aAAe,WACxCC,IAAAA,EAAU,GACZC,EAAO,KACP3E,EAAI,KAAKX,SAAS,KAAKmF,SACzBI,SAASC,iBACP,UACA,SAASC,GACPJ,EAAQI,EAAEC,UAAW,EACjBC,IAAAA,EAAOL,EAAKM,SAASP,EAASnG,EAAGQ,YAAYgF,KAAMY,EAAKH,SAC5DG,EAAKO,aAAalF,EAAGgF,KAEvB,GAEFJ,SAASC,iBACP,QACA,SAASC,UACAJ,EAAQI,EAAEC,SACbC,IAAAA,EAAOL,EAAKM,SAASP,EAASnG,EAAGQ,YAAYgF,KAAMY,EAAKH,SAC5DG,EAAKO,aAAalF,EAAGgF,KAEvB,IAIJzG,EAAGQ,YAAYwF,MAAMlE,UAAU6E,aAAe,SAASlF,EAAG4C,GACpDA,GACF5C,EAAEqB,QAAQuB,IAIdrE,EAAGQ,YAAYwF,MAAMlE,UAAU4E,SAAW,SAASP,EAASS,EAAGC,GACvDxC,IAAAA,EAAIrE,EAAG+C,MAAMC,MACbvB,EAAI,KAAKX,SAAS+F,GAClBC,EAAa9G,EAAGc,SAASuB,aAAaC,KACtCyE,EAAc/G,EAAGc,SAASuB,aAAaE,MACvCyE,EAASvF,EAAEwF,iBAEbxF,OAAAA,EAAEC,UAAUsC,OAASK,EAAEC,OAAU6B,EAAQS,EAAElB,MAG3CjE,EAAEC,UAAUsC,OAASK,EAAEsB,OAAUQ,EAAQS,EAAEjB,OAGX,IAAhCuB,OAAO1B,KAAKW,GAASnE,OAChBqC,EAAEpB,MAEPkD,EAAQS,EAAEjB,OACLtB,EAAEsB,MACAQ,EAAQS,EAAEtE,MACf6D,EAAQS,EAAEnB,IACLpB,EAAE8C,cACAhB,EAAQS,EAAEb,KAAOiB,IAAWF,EAC9BzC,EAAE+C,UAEJ/C,EAAEgD,cACAlB,EAAQS,EAAErE,OACf4D,EAAQS,EAAEnB,IACLpB,EAAEiD,aACAnB,EAAQS,EAAEb,KAAOiB,IAAWD,EAC9B1C,EAAE+C,UAEJ/C,EAAEkD,KACApB,EAAQS,EAAElB,MACfS,EAAQS,EAAEhB,IACLvB,EAAEY,SACAkB,EAAQS,EAAEd,IACZzB,EAAEmD,eACArB,EAAQS,EAAEb,IACZ1B,EAAEoD,gBACAtB,EAAQS,EAAEf,IACZxB,EAAEqD,gBAEJrD,EAAEC,MACA6B,EAAQS,EAAEb,IACftE,EAAEC,UAAUsC,OAASK,EAAEiD,aAClBjD,EAAEc,kBACA1D,EAAEC,UAAUsC,OAASK,EAAE8C,cACzB9C,EAAEa,mBAEJb,EAAEsD,UACAxB,EAAQS,EAAEnB,IACZpB,EAAEuD,KACAzB,EAAQS,EAAEd,IACfrE,EAAEC,UAAUsC,OAASK,EAAEiD,aAClBjD,EAAEc,kBACA1D,EAAEC,UAAUsC,OAASK,EAAE8C,cACzB9C,EAAEa,mBAEJb,EAAEG,SACA2B,EAAQS,EAAEf,IACfpE,EAAEC,UAAUsC,OAASK,EAAEiD,aAClBjD,EAAEe,mBACA3D,EAAEC,UAAUsC,OAASK,EAAE8C,cACzB9C,EAAEgB,oBAEJhB,EAAEE,UACA4B,EAAQS,EAAEhB,IACfnE,EAAEC,UAAUsC,OAASK,EAAEiD,aAClBjD,EAAEe,mBACA3D,EAAEC,UAAUsC,OAASK,EAAE8C,cACzB9C,EAAEgB,oBAEJhB,EAAEwD,gBANJ,EAvDExD,EAAEpB,MAHFoB,EAAEyD,UAoEb9H,EAAGQ,YAAYuH,YAAc,SAASrH,GACpCV,EAAGQ,YAAYwF,MAAM9B,KAAK,KAAMxD,IAGlCV,EAAGQ,YAAYuH,YAAYjG,UAAY,IAAI9B,EAAGQ,YAAYwF,MAE1DhG,EAAGQ,YAAYuH,YAAYjG,UAAUqB,YAAc,WAC5C8C,KAAAA,QAAU,EACVC,KAAAA,eACA8B,KAAAA,wBAGPhI,EAAGQ,YAAYuH,YAAYjG,UAAUkG,qBAAuB,WACtDvG,IAAAA,EAAI,KAAKX,SAAS,GACtBmH,OAAOC,OAASD,OAAOC,QAAU,GACjCD,OAAOC,OAAOC,QAAU,WACtB1G,EAAEqB,QAAQ9C,EAAG+C,MAAMC,MAAM6E,aAE3BI,OAAOC,OAAOE,OAAS,WACrB3G,EAAEqB,QAAQ9C,EAAG+C,MAAMC,MAAMwB,WAE3ByD,OAAOC,OAAOG,QAAU,WACtB5G,EAAEqB,QAAQ9C,EAAG+C,MAAMC,MAAMC,SAI7BjD,EAAGQ,YAAYgF,KAAK8C,GAAK,CACvB/F,MAAO,GACPD,KAAM,GACNmD,GAAI,GACJC,KAAM,GACNC,MAAO,GACPC,GAAI,GACJC,GAAI,GACJC,GAAI,GACJC,GAAI,IAGN/F,EAAGQ,YAAYgF,KAAK+C,GAAK,CACvBhG,MAAO,GACPD,KAAM,GACNmD,GAAI,GACJC,KAAM,GACNC,MAAO,GACPC,GAAI,GACJC,GAAI,IACJC,GAAI,IACJC,GAAI,KAGN/F,EAAGQ,YAAYgI,YAAc,SAAS9H,GACpCV,EAAGQ,YAAYwF,MAAM9B,KAAK,KAAMxD,IAGlCV,EAAGQ,YAAYgI,YAAY1G,UAAY,IAAI9B,EAAGQ,YAAYwF,MAE1DhG,EAAGQ,YAAYgI,YAAY1G,UAAUqB,YAAc,WAC5C+C,KAAAA,gBAGPlG,EAAGQ,YAAYgI,YAAY1G,UAAUoE,aAAe,WAC9CC,IAAAA,EAAU,GACZC,EAAO,KACPqC,EAAK,KAAK3H,SAAS,GACnB4H,EAAK,KAAK5H,SAAS,GAErBuF,SAASC,iBACP,UACA,SAASC,GACPJ,EAAQI,EAAEC,UAAW,EACjBC,IAAAA,EAAOL,EAAKM,SAASP,EAASnG,EAAGQ,YAAYgF,KAAK8C,GAAI,GAC1DlC,EAAKO,aAAa8B,EAAIhC,GACtBA,EAAOL,EAAKM,SAASP,EAASnG,EAAGQ,YAAYgF,KAAK+C,GAAI,GACtDnC,EAAKO,aAAa+B,EAAIjC,KAExB,GAGFJ,SAASC,iBACP,QACA,SAASC,UACAJ,EAAQI,EAAEC,SACbC,IAAAA,EAAOL,EAAKM,SAASP,EAASnG,EAAGQ,YAAYgF,KAAK8C,GAAI,GAC1DlC,EAAKO,aAAa8B,EAAIhC,GACtBA,EAAOL,EAAKM,SAASP,EAASnG,EAAGQ,YAAYgF,KAAK+C,GAAI,GACtDnC,EAAKO,aAAa+B,EAAIjC,KAExB,IAIJzG,EAAGQ,YAAYgI,YAAY1G,UAAU6E,aAAe,SAASnD,EAASiD,GAChEA,GACFjD,EAAQV,QAAQ2D,IAIpBzG,EAAGQ,YAAYmI,QAAU,SAASjI,GAChCV,EAAGQ,YAAYwF,MAAM9B,KAAK,KAAMxD,GAC3BkI,KAAAA,QAAUlI,EAAQmI,OAClBC,KAAAA,UAAYpI,EAAQqI,SACpBC,KAAAA,WAAatI,EAAQuI,WAAa,KAAKC,WAAWC,UAGzDnJ,EAAGY,UAAUwI,iBAAmB,mBAEhCpJ,EAAGQ,YAAYmI,QAAQ7G,UAAY,IAAI9B,EAAGQ,YAAYwF,MAEtDhG,EAAGQ,YAAYmI,QAAQ7G,UAAUuH,SAAW,CAC1CC,YAAa,cACbC,UAAW,aAGbvJ,EAAGQ,YAAYmI,QAAQ7G,UAAU0H,UAAY,CAC3CC,QAAS,EACTC,YAAa,EACbC,gBAAiB,EACjBC,UAAW,GAGb5J,EAAGQ,YAAYmI,QAAQ7G,UAAU+H,SAAW,CAC1CC,MAAO,QACPC,YAAa,cACbC,gBAAiB,kBACjBZ,iBAAkB,oBAGpBpJ,EAAGQ,YAAYmI,QAAQ7G,UAAUoH,WAAa,CAC5CC,SAAU,IAGZnJ,EAAGQ,YAAYmI,QAAQ7G,UAAUoH,WAAWC,SAASzG,KAAO,WACrDuH,KAAAA,QAAUC,GAAGC,WAGpBnK,EAAGQ,YAAYmI,QAAQ7G,UAAUoH,WAAWC,SAASiB,KAAO,WACrDH,KAAAA,QAAQG,KAAKC,MAAM,KAAKJ,QAASK,YAGxCtK,EAAGQ,YAAYmI,QAAQ7G,UAAUoH,WAAWC,SAASoB,GAAK,WACnDN,KAAAA,QAAQM,GAAGF,MAAM,KAAKJ,QAASK,YAGtCtK,EAAGQ,YAAYmI,QAAQ7G,UAAU0I,YAAc,SAASlJ,GACjD0H,KAAAA,WAAWoB,KAAK,KAAKf,SAASC,YAAa,KAAKR,WAChD2B,KAAAA,sBAGPzK,EAAGQ,YAAYmI,QAAQ7G,UAAU2I,mBAAqB,WAChD/G,IAAAA,EAAW,KAAK5C,WAAW,KAAKmF,SAClCxE,EAAI,KAAKX,SAAS,KAAKmF,SACvB5B,EAAI,KAAKwF,SACTzD,EAAO,KACJ4C,KAAAA,WAAWuB,GAAGlG,EAAEyF,MAAO,SAASrD,GACnC/C,EAASZ,QAAQ2D,KAEduC,KAAAA,WAAWuB,GAAGlG,EAAE0F,YAAa,SAASW,GACzChH,EAASiH,QAAQD,KAEd1B,KAAAA,WAAWuB,GAAGlG,EAAE2F,gBAAiB,SAASU,GAC7ChH,EAASJ,KAAKoH,EAAKE,GACnBlH,EAASmH,KAAKH,EAAKI,KAErBC,YAAY,WACV3E,EAAK4C,WAAWoB,KAAK/F,EAAE0F,YAAatI,EAAEmC,YACrC,KACHmH,YAAY,WACLtJ,EAAEuJ,aACL5E,EAAK4C,WAAWoB,KAAK/F,EAAE2F,gBAAiB,CACtCY,EAAGnJ,EAAEkD,OACLmG,EAAGrJ,EAAEwJ,UAGR,KACC,KAAKrC,SACFI,KAAAA,WAAWuB,GAAG,KAAKV,SAAST,iBAAkB,SAASsB,GACtDQ,IAAAA,EAAI9E,EAAKzF,WAAWX,EAAGY,UAAUwI,kBACpB,mBAAN8B,GACTA,OAMRlL,EAAGQ,YAAYmI,QAAQ7G,UAAU6E,aAAe,SAASlF,EAAG4C,GACtDA,IACG2E,KAAAA,WAAWoB,KAAK,QAAS/F,GAC9B5C,EAAEqB,QAAQuB,KAIdrE,EAAGQ,YAAYmI,QAAQ7G,UAAUqJ,UAAY,SAAS7J,GAC/C0H,KAAAA,WAAWoB,KAAK,KAAKf,SAASE,UAAW,KAAKT,WAC9C2B,KAAAA,sBAGPzK,EAAGQ,YAAYmI,QAAQ7G,UAAUqB,YAAc,WACzCiD,IAAAA,EAAO,KACP,KAAKwC,QACF3C,KAAAA,QAAU,EAEVA,KAAAA,QAAU,EAEZC,KAAAA,eACA8C,KAAAA,WAAWtG,OACXsG,KAAAA,WAAWuB,GAAG,UAAW,WACxBnE,EAAKwC,QACPxC,EAAKoE,YAAYpE,EAAK0C,WAEtB1C,EAAK+E,UAAU/E,EAAK0C,aAGnBE,KAAAA,WAAWuB,GAAG,WAAY,SAASa,GAClCA,IAAahF,EAAKoD,UAAUC,SAC9B4B,MAAM,2CAGLrC,KAAAA,WAAWuB,GAAG,aAAc,WAC/Bc,MAAM,oCAIVrL,EAAGsL,MAAQ,SAAS5K,GACdsD,IAAAA,EAAOtD,EAAQ6K,UAAY,QAC3B5I,EAAU,IAAI3C,EAAGwL,QAEbxH,OADRA,EAAOA,EAAKyH,eAEL,IAAA,QACHzL,EAAGsB,KAAO,IAAItB,EAAGQ,YAAYwF,MAAMtF,GACnC,MACG,IAAA,UACHV,EAAGsB,KAAO,IAAItB,EAAGQ,YAAYmI,QAAQjI,GACrC,MACG,IAAA,cACHV,EAAGsB,KAAO,IAAItB,EAAGQ,YAAYgI,YAAY9H,GACzC,MACG,IAAA,cACHV,EAAGsB,KAAO,IAAItB,EAAGQ,YAAYuH,YAAYrH,GACzC,MACF,QACEV,EAAGsB,KAAO,IAAItB,EAAGQ,YAAYwF,MAAMtF,GAGhCiC,OADP3C,EAAGsB,KAAKoB,KAAKC,GACNA,GAGT3C,EAAGwL,QAAU,WACN5K,KAAAA,UAAY,IAGnBZ,EAAGwL,QAAQ1J,UAAUsB,aAAe,WAC7BxC,KAAAA,UAAUY,QAAQ,SAAS0J,GACb,mBAANA,GACTA,OAKNlL,EAAGwL,QAAQ1J,UAAU4J,MAAQ,SAAS7H,GAC/BjD,KAAAA,UAAUqB,KAAK4B,IAGtB7D,EAAGiB,OAAS,CACV+B,MAAO,CACL2I,MAAO,EACPC,YAAa,IAIjB5L,EAAGiB,OAAOC,MAAQ,SAASR,GACpBS,KAAAA,MAAQT,EAAQS,OAAS,IACzBC,KAAAA,OAASV,EAAQU,QAAU,IAC3BJ,KAAAA,MAAQN,EAAQM,OAAShB,EAAGiB,OAAO+B,MAAM2I,MACzC7K,KAAAA,SAAWJ,EAAQI,SACnB+K,KAAAA,WAAanL,EAAQW,UACrByK,KAAAA,MAAQpL,EAAQY,MAGvBtB,EAAGiB,OAAOC,MAAMY,UAAUY,KAAO,WAC3BqJ,IAAAA,EAAS1F,SAAS2F,cAAc,UACpCD,EAAO5K,MAAQ,KAAKA,MACpB4K,EAAO3K,OAAS,KAAKA,OAChByK,KAAAA,WAAWI,YAAYF,GACvBG,KAAAA,SAAWH,EAAOI,WAAW,MAC7BC,KAAAA,QAAUL,EACVM,KAAAA,WAGPrM,EAAGiB,OAAOC,MAAMY,UAAUD,QAAU,WAC7BgK,KAAAA,WAAWS,YAAY,KAAKF,SAC5BA,KAAAA,aAAUG,EACVL,KAAAA,cAAWK,EACXV,KAAAA,gBAAaU,EACbT,KAAAA,WAAQS,EACRzL,KAAAA,cAAWyL,EACXvL,KAAAA,WAAQuL,GAGfvM,EAAGiB,OAAOC,MAAMY,UAAU0K,WAAa,WACjCC,IAAAA,EAAMpG,SAAS2F,cAAc,OAC/BU,EAAO1M,EAAG2M,OACVvG,EAAO,KACL,KAAKwG,QACFV,KAAAA,SAASW,UAAU,KAAKD,QAAS,EAAG,EAAG,KAAKzL,MAAO,KAAKC,SAE7DqL,EAAIK,IAAM/M,EAAO2M,EAAKvM,QAAQ,KAAKa,OAAOA,MAC1CyL,EAAItL,MAAQ,KAAKA,MACjBsL,EAAIrL,OAAS,KAAKA,OAClBqL,EAAIM,OAAS,WACX3G,EAAKwG,QAAUH,EACfrG,EAAK8F,SAASW,UAAUJ,EAAK,EAAG,EAAGrG,EAAKjF,MAAOiF,EAAKhF,WAK1DpB,EAAGiB,OAAOC,MAAMY,UAAUuK,QAAU,WAE9B5K,IAAAA,EADC+K,KAAAA,aAEA,IAAA,IAAIzK,EAAI,EAAGA,EAAI,KAAKjB,SAASkB,OAAQD,GAAK,EAC7CN,EAAI,KAAKX,SAASiB,GACbmK,KAAAA,SAASW,UAAUpL,EAAEuL,WAAYvL,EAAEkD,OAAQlD,EAAEwJ,SAItDjL,EAAGiB,OAAOC,MAAMY,UAAUmL,YAAc,SAASzJ,EAAS0J,GAClDxJ,IAAAA,EAAW,KAAKoI,MAAMrJ,YAAYe,GAClC2J,EAAUzJ,EAASiB,OAAnBwI,EAA8BzJ,EAASuH,OACvCmC,EAASF,EAAIpC,EAAItH,EAAQ6J,oBAAsBF,EAsB9CD,OApBHA,EAAItC,GAAK,IACXsC,EAAItC,EAAI,GAENsC,EAAItC,GAAK,KAAKzJ,MAAQqC,EAAQ8J,oBAChCJ,EAAItC,EAAI,KAAKzJ,MAAQqC,EAAQ8J,mBAG1BF,IACC5J,EAAQyD,mBAAqBjH,EAAGc,SAASuB,aAAaC,KACpD4K,EAAItC,EAAIpH,EAAQ8J,kBAAoBH,IACtCD,EAAM,KAAKK,qBAAqBL,EAAK1J,EAASE,IAG5CwJ,EAAItC,EAAIuC,EAAOzJ,EAAS4J,oBAC1BJ,EAAM,KAAKK,qBAAqBL,EAAK1J,EAASE,KAK/C8J,KAAAA,wBAAwBhK,EAASE,GAC/BwJ,GAGTlN,EAAGiB,OAAOC,MAAMY,UAAUyL,qBAAuB,SAASL,EAAK1J,EAASE,GAEpEF,OAAAA,EAAQ9B,UAAUsC,OAAShE,EAAG+C,MAAMC,MAAMsE,cAC1C9D,EAAQ9B,UAAUsC,OAAShE,EAAG+C,MAAMC,MAAMmE,eAE1C+F,EAAItC,EAAIpH,EAAQmB,OACTuI,IAGL1J,EAAQyD,mBAAqBjH,EAAGc,SAASuB,aAAaC,MACxDmL,EAAO1I,KAAK2I,IACV,KAAKvM,OAASuC,EAASiB,OAASjB,EAAS4J,kBAAoB9J,EAAQ8J,mBACrEJ,EAAItC,EAAIpH,EAAQmB,QAGlBuI,EAAItC,EAAIpH,EAAQmB,OAAS8I,EACrBA,EAAO,GACT/J,EAASJ,KAAKI,EAASiB,OAAS8I,KAGlCA,EAAO1I,KAAK2I,IAAIhK,EAASiB,OAAQnB,EAAQmB,OAASuI,EAAItC,IAC3C,GACTsC,EAAItC,EAAIpH,EAAQmB,OAAS8I,EACzB/J,EAASJ,KAAKI,EAASiB,OAAS8I,GAC5B/J,EAASiB,OAASjB,EAASkB,WAAasI,EAAItC,IAC9CsC,EAAItC,EAAIlH,EAASiB,OAASjB,EAAS4J,qBAGrCJ,EAAItC,EAAIpH,EAAQmB,OACZjB,EAASiB,OAASjB,EAASkB,WAAasI,EAAItC,IAC9CsC,EAAItC,EAAIlH,EAASiB,OAASjB,EAAS4J,oBAIlCJ,GA1BHO,IAAAA,GA6BNzN,EAAGiB,OAAOC,MAAMY,UAAU0L,wBAA0B,SAAS/E,EAAIC,GAC3DD,EAAG9D,OAAS+D,EAAG/D,QACjB8D,EAAGkF,eAAe3N,EAAGc,SAASuB,aAAaC,MAC3CoG,EAAGiF,eAAe3N,EAAGc,SAASuB,aAAaE,SAE3CkG,EAAGkF,eAAe3N,EAAGc,SAASuB,aAAaE,OAC3CmG,EAAGiF,eAAe3N,EAAGc,SAASuB,aAAaC,QAM/CtC,EAAG+C,MAAQ,GAEX/C,EAAG+C,MAAMC,MAAQ,CACfC,MAAO,QACPsE,KAAM,UACNF,cAAe,mBACf/C,MAAO,WACPwD,SAAU,WACVH,UAAW,YACXC,KAAM,UACNN,aAAc,eACdH,cAAe,gBACf3C,SAAU,WACVD,UAAW,YACXsD,WAAY,aACZ+F,KAAM,OACNrI,IAAK,MACLsI,OAAQ,SACRC,aAAc,eACd7I,SAAU,WACVuC,eAAgB,iBAChBC,gBAAiB,kBACjBC,gBAAiB,kBACjBqG,WAAY,aACZC,oBAAqB,sBACrB5G,UAAW,YACXzB,MAAO,WACPR,kBAAmB,oBACnBD,mBAAoB,qBACpBG,oBAAqB,sBACrBD,mBAAoB,sBAWtBpF,EAAG+C,MAAMkL,KAAO,SAASC,EAAOlK,EAAMmK,GAC/BD,KAAAA,MAAQA,EACRlK,KAAAA,KAAOA,EACPoK,KAAAA,cAAgBD,GAAgB,GAChCE,KAAAA,WAAa,EACbC,KAAAA,aAAe,EACfC,KAAAA,eAAiB,IAGxBvO,EAAG+C,MAAMkL,KAAKnM,UAAU0M,GAAK,SAASC,GAChCrI,IAAAA,EAAO,KACmB,mBAAnB,KAAKsI,WAA0B,KAAKA,YAC1CJ,KAAAA,aAAeG,GAAQ,EACvBE,KAAAA,UAAU,KAAKC,SACfP,KAAAA,UAAYtD,YAAY,WAC3B3E,EAAKuI,UAAUvI,EAAKwI,UACnB,KAAKR,gBAGVpO,EAAG+C,MAAMkL,KAAKnM,UAAU8M,QAAU,aAElC5O,EAAG+C,MAAMkL,KAAKnM,UAAU6M,UAAY,SAAS9K,GACvC4I,IAAAA,EAAMpG,SAAS2F,cAAc,OACxBhM,EAAG2M,OAEZF,EAAM,KAAKoC,OAAO,KAAKX,MAAMjH,kBAAkB,KAAKqH,cAC/CJ,KAAAA,MAAMY,SAASrC,GACpB5I,EAASwG,MAAM,MACV6D,KAAAA,MAAM7B,UACN0C,KAAAA,iBAGP/O,EAAG+C,MAAMkL,KAAKnM,UAAUY,KAAO,SAASmB,GAClCmL,IAEFvC,EAFEuC,EAAS,EACX5I,EAAO,KAEP6I,EAAIjP,EAAGc,SAASuB,aACbwM,KAAAA,OAAS,GACTA,KAAAA,OAAOI,EAAE1M,OAAS,GAClBsM,KAAAA,OAAOI,EAAE3M,MAAQ,GACjB,IAAA,IAAIP,EAAI,EAAGA,EAAI,KAAKmN,YAAanN,GAAK,EACpC,IAAA,IAAMK,KAAe6M,GACxBxC,EAAMpG,SAAS2F,cAAc,QACzBe,OAAS,YACXiC,GAAU,KACwB,EAAnB5I,EAAK8I,aAClBrL,EAASwG,MAAMjE,IAGnBqG,EAAIK,IAAM,KAAKqC,aAAapN,EAAGkN,EAAE7M,IAC5ByM,KAAAA,OAAOI,EAAE7M,IAAcH,KAAKwK,GAGL,mBAArB,KAAK2C,aACTA,KAAAA,eAITpP,EAAG+C,MAAMkL,KAAKnM,UAAUqN,aAAe,SAASE,EAAIC,GAC9C5C,IAAAA,EAAO1M,EAAG2M,OACP5M,OAAAA,EAAO2M,EAAKtM,UAAU,KAAK8N,MAAM1L,WAAW8M,GAAkB,KAAKtL,MAAMqL,IAGlFrP,EAAG+C,MAAMkL,KAAKnM,UAAUH,KAAO,SAASkC,GAKlC,GAJ4B,mBAArB,KAAK0L,aAA4B,KAAKA,cAEjDC,cAAc,KAAKnB,WAEgB,mBAAxB,KAAKE,eAA+B,CACzCkB,IAAAA,EAAO,KAAKlB,eACXA,KAAAA,eAAiB,KACtBkB,IAGGC,KAAAA,aAAc,GAGrB1P,EAAG+C,MAAM4M,UAAY,SAASjP,GAC5BA,EAAUA,GAAW,GACrBV,EAAG+C,MAAMkL,KAAK/J,KAAK,KAAMxD,EAAQwN,MAAOxN,EAAQsD,KAAMtD,EAAQkP,UACzDV,KAAAA,YAAcxO,EAAQmP,OAG7B7P,EAAG+C,MAAM4M,UAAU7N,UAAY,IAAI9B,EAAG+C,MAAMkL,KAE5CjO,EAAG+C,MAAM4M,UAAU7N,UAAUiN,cAAgB,WACtCT,KAAAA,cAAgB,EAChBA,KAAAA,aAAe,KAAKA,aAAe,KAAKY,aAG/ClP,EAAG+C,MAAM+M,MAAQ,SAAS5B,GACxBlO,EAAG+C,MAAM4M,UAAUzL,KAAK,KAAM,CAC5BgK,MAAOA,EACPlK,KAAMhE,EAAG+C,MAAMC,MAAMC,MACrB4M,MAAO,KAIX7P,EAAG+C,MAAM+M,MAAMhO,UAAY,IAAI9B,EAAG+C,MAAM4M,UAExC3P,EAAG+C,MAAM+M,MAAMhO,UAAU4M,UAAY,WAC9BR,KAAAA,MAAMrD,KAAK7K,EAAG2M,OAAOrM,aAG5BN,EAAG+C,MAAMgN,KAAO,SAAS7B,GACvBlO,EAAG+C,MAAM4M,UAAUzL,KAAK,KAAM,CAC5BgK,MAAOA,EACPlK,KAAMhE,EAAG+C,MAAMC,MAAMuE,KACrBsI,MAAO,KAIX7P,EAAG+C,MAAMgN,KAAKjO,UAAY,IAAI9B,EAAG+C,MAAM4M,UAEvC3P,EAAG+C,MAAMgN,KAAKjO,UAAU8M,QAAU,WAC3BV,KAAAA,MAAM5K,KAAK,KAAK4K,MAAMvJ,OAAS,IAC/BuJ,KAAAA,MAAMrD,KAAK7K,EAAG2M,OAAOrM,aAG5BN,EAAG+C,MAAMiN,SAAW,SAAS9B,GAC3BlO,EAAG+C,MAAM4M,UAAUzL,KAAK,KAAM,CAC5BgK,MAAOA,EACPlK,KAAMhE,EAAG+C,MAAMC,MAAMqE,cACrBwI,MAAO,KAIX7P,EAAG+C,MAAMiN,SAASlO,UAAY,IAAI9B,EAAG+C,MAAM4M,UAE3C3P,EAAG+C,MAAMiN,SAASlO,UAAU8M,QAAU,WAC/BV,KAAAA,MAAM5K,KAAK,KAAK4K,MAAMvJ,OAAS,IAC/BuJ,KAAAA,MAAMrD,KAAK7K,EAAG2M,OAAOrM,aAG5BN,EAAG+C,MAAMkN,WAAa,SAAS/B,EAAOlK,EAAM4L,GAC1C5P,EAAG+C,MAAMkL,KAAK/J,KAAK,KAAMgK,EAAOlK,EAAM4L,GACjCM,KAAAA,aAAU3D,GAGjBvM,EAAG+C,MAAMkN,WAAWnO,UAAY,IAAI9B,EAAG+C,MAAMkL,KAE7CjO,EAAG+C,MAAMkN,WAAWnO,UAAUiN,cAAgB,WACxC,KAAKT,cAAgB,KAAKY,YAAc,EACrCZ,KAAAA,aAAe,KAAKY,YAAc,EAElCZ,KAAAA,aAAe,KAAKA,aAAe,GAI5CtO,EAAG+C,MAAMkN,WAAWnO,UAAU4M,UAAY,WACnCwB,KAAAA,QAAU,KAAKhC,MAAMiC,YACrBjC,KAAAA,MAAMkC,QAGbpQ,EAAG+C,MAAMkN,WAAWnO,UAAUyN,YAAc,WACrCrB,KAAAA,MAAMmC,UAGbrQ,EAAG+C,MAAMkN,WAAWnO,UAAUwO,aAAe,WACvCC,IAAAA,EAAgB,KAAKrC,MAAMiC,YAC3BI,EAAgB,KAAKL,SAClBhC,KAAAA,MAAMrD,KAAK,KAAKqD,MAAMjD,OAASsF,EAAgB,KAAKL,SAEvDK,EAAgB,KAAKL,SAClBhC,KAAAA,MAAMrD,KAAK,KAAKqD,MAAMjD,QAAU,KAAKiF,QAAUK,KAIxDvQ,EAAG+C,MAAMyN,KAAO,SAAStC,GACvBlO,EAAG+C,MAAMkN,WAAW/L,KAAK,KAAMgK,EAAOlO,EAAG+C,MAAMC,MAAM4K,KAAM,KACtDsB,KAAAA,YAAc,GAGrBlP,EAAG+C,MAAMyN,KAAK1O,UAAY,IAAI9B,EAAG+C,MAAMkN,WAEvCjQ,EAAG+C,MAAMyN,KAAK1O,UAAU8M,QAAU,WAC3B0B,KAAAA,gBAGPtQ,EAAG+C,MAAM0N,IAAM,SAASvC,GACtBlO,EAAG+C,MAAMkN,WAAW/L,KAAK,KAAMgK,EAAOlO,EAAG+C,MAAMC,MAAMuC,IAAK,KACrD2J,KAAAA,YAAc,IAGrBlP,EAAG+C,MAAM0N,IAAI3O,UAAY,IAAI9B,EAAG+C,MAAMkN,WAEtCjQ,EAAG+C,MAAM0N,IAAI3O,UAAU8M,QAAU,WAC1B0B,KAAAA,gBAGPtQ,EAAG+C,MAAM0N,IAAI3O,UAAU4M,UAAY,WAC5BR,KAAAA,MAAMkC,OACNlC,KAAAA,MAAMrD,KAAK7K,EAAG2M,OAAOrM,YACrB4P,KAAAA,QAAU,KAAKhC,MAAMiC,aAG5BnQ,EAAG+C,MAAM2N,MAAQ,SAASxC,GACxBlO,EAAG+C,MAAMkN,WAAW/L,KAAK,KAAMgK,EAAOlO,EAAG+C,MAAMC,MAAMsB,MAAO,IACvD4K,KAAAA,YAAc,GAGrBlP,EAAG+C,MAAM2N,MAAM5O,UAAY,IAAI9B,EAAG+C,MAAMkN,WAExCjQ,EAAG+C,MAAM2N,MAAM5O,UAAU8M,QAAU,WAC5B0B,KAAAA,eACqB,IAAtB,KAAKhC,cACF3M,KAAAA,QAIT3B,EAAG+C,MAAM4N,MAAQ,SAASzC,GACxBlO,EAAG+C,MAAMkN,WAAW/L,KAAK,KAAMgK,EAAOlO,EAAG+C,MAAMC,MAAM2C,MAAO,IACvDuJ,KAAAA,YAAc,GAGrBlP,EAAG+C,MAAM4N,MAAM7O,UAAY,IAAI9B,EAAG+C,MAAMkN,WAExCjQ,EAAG+C,MAAM4N,MAAM7O,UAAU8M,QAAU,WAC5B0B,KAAAA,eACqB,IAAtB,KAAKhC,cACF3M,KAAAA,QAIT3B,EAAG+C,MAAM6N,QAAU,SAAS1C,GAC1BlO,EAAG+C,MAAMkN,WAAW/L,KAAK,KAAMgK,EAAOlO,EAAG+C,MAAMC,MAAM8E,SAAU,KAC1DoH,KAAAA,YAAc,GAGrBlP,EAAG+C,MAAM6N,QAAQ9O,UAAY,IAAI9B,EAAG+C,MAAMkN,WAE1CjQ,EAAG+C,MAAM6N,QAAQ9O,UAAU8M,QAAU,WACT,IAAtB,KAAKN,eACF3M,KAAAA,OACAuM,KAAAA,MAAMpL,QAAQ9C,EAAG+C,MAAMC,MAAMC,OAC7BiL,KAAAA,MAAMrD,KAAK7K,EAAG2M,OAAOrM,aAEvBgQ,KAAAA,gBAGPtQ,EAAG+C,MAAM8N,kBAAoB,SAAS3C,GACpClO,EAAG+C,MAAMkN,WAAW/L,KAAK,KAAMgK,EAAOlO,EAAG+C,MAAMC,MAAMgL,oBAAqB,KACrEkB,KAAAA,YAAc,GAGrBlP,EAAG+C,MAAM8N,kBAAkB/O,UAAY,IAAI9B,EAAG+C,MAAMkN,WAEpDjQ,EAAG+C,MAAM8N,kBAAkB/O,UAAU8M,QAAU,WACzC,KAAKN,eAAiB,KAAKY,YAAc,GACtCvN,KAAAA,OACAuM,KAAAA,MAAMpL,QAAQ9C,EAAG+C,MAAMC,MAAMC,QAE7BqN,KAAAA,gBAITtQ,EAAG+C,MAAM8N,kBAAkB/O,UAAUyN,YAAc,WAC5CrB,KAAAA,MAAMmC,SACNnC,KAAAA,MAAMrD,KAAK7K,EAAG2M,OAAOrM,aAG5BN,EAAG+C,MAAM+N,OAAS,SAAS5C,GACzBlO,EAAG+C,MAAMkL,KAAK/J,KAAK,KAAMgK,EAAOlO,EAAG+C,MAAMC,MAAM6K,QAC1CqB,KAAAA,YAAc,GAGrBlP,EAAG+C,MAAM+N,OAAOhP,UAAY,IAAI9B,EAAG+C,MAAMkL,KAEzCjO,EAAG+C,MAAM+N,OAAOhP,UAAU8M,QAAU,WAC9B,KAAKN,eAAiB,KAAKY,YAAc,IACtCvN,KAAAA,OACAuM,KAAAA,MAAMpL,QAAQ9C,EAAG+C,MAAMC,MAAMC,SAItCjD,EAAG+C,MAAM+N,OAAOhP,UAAU4M,UAAY,WAC/BR,KAAAA,MAAMkC,QAGbpQ,EAAG+C,MAAM+N,OAAOhP,UAAUyN,YAAc,WACjCrB,KAAAA,MAAMmC,UAGbrQ,EAAG+C,MAAM+N,OAAOhP,UAAUiN,cAAgB,WACnCT,KAAAA,cAAgB,GAGvBtO,EAAG+C,MAAMgO,UAAY,SAAS7C,GAC5BlO,EAAG+C,MAAMkL,KAAK/J,KAAK,KAAMgK,EAAOlO,EAAG+C,MAAMC,MAAM+K,WAAY,IACtDmB,KAAAA,YAAc,IAGrBlP,EAAG+C,MAAMgO,UAAUjP,UAAY,IAAI9B,EAAG+C,MAAMkL,KAE5CjO,EAAG+C,MAAMgO,UAAUjP,UAAU8M,QAAU,WACjC,GAAA,KAAKN,eAAiB,KAAKY,YAAc,EACtCvN,KAAAA,OACAuM,KAAAA,MAAMpL,QAAQ9C,EAAG+C,MAAMC,MAAMgL,yBAC7B,CACDgD,IAAAA,EAAgB,GAChB,KAAK9C,MAAMjH,mBAAqBjH,EAAGc,SAASuB,aAAaC,OAC3D0O,GAAiBA,GAEf,KAAK1C,aAAoB,KAAKY,YAC3BhB,KAAAA,MAAMrD,KAAK,KAAKqD,MAAMjD,OAAS,IAC/BiD,KAAAA,MAAM5K,KAAK,KAAK4K,MAAMvJ,OAASqM,KAQ1ChR,EAAG+C,MAAMgO,UAAUjP,UAAU4M,UAAY,WAClCR,KAAAA,MAAMkC,QAGbpQ,EAAG+C,MAAMgO,UAAUjP,UAAUyN,YAAc,WACpCrB,KAAAA,MAAMmC,UAGbrQ,EAAG+C,MAAMgO,UAAUjP,UAAUiN,cAAgB,WACtCT,KAAAA,cAAgB,GAGvBtO,EAAG+C,MAAMkO,YAAc,SAAS/C,GAC9BlO,EAAG+C,MAAMkL,KAAK/J,KAAK,KAAMgK,EAAOlO,EAAG+C,MAAMC,MAAM8K,cAC1CoB,KAAAA,YAAc,GAGrBlP,EAAG+C,MAAMkO,YAAYnP,UAAY,IAAI9B,EAAG+C,MAAMkL,KAE9CjO,EAAG+C,MAAMkO,YAAYnP,UAAU8M,QAAU,WACnC,KAAKN,eAAiB,KAAKY,YAAc,IACtCvN,KAAAA,OACAuM,KAAAA,MAAMpL,QAAQ9C,EAAG+C,MAAMC,MAAMsB,QAE/BgM,KAAAA,gBAGPtQ,EAAG+C,MAAMkO,YAAYnP,UAAU4M,UAAY,WACpCR,KAAAA,MAAMkC,YACU7D,IAAjB,KAAK2D,UAAuB,KAAKA,QAAU,KAAKhC,MAAMiC,cAG5DnQ,EAAG+C,MAAMkO,YAAYnP,UAAUyN,YAAc,WACtCrB,KAAAA,MAAMmC,UAGbrQ,EAAG+C,MAAMkO,YAAYnP,UAAUiN,cAAgB,WACxCT,KAAAA,cAAgB,GAGvBtO,EAAG+C,MAAMkO,YAAYnP,UAAUwO,aAAe,WACxCC,IAAAA,EAAgB,KAAKrC,MAAMiC,YAC3BI,EAAgB,KAAKL,SAClBhC,KAAAA,MAAMrD,KAAK,KAAKqD,MAAMjD,OAASsF,EAAgB,KAAKL,SAEvDK,EAAgB,KAAKL,SAClBhC,KAAAA,MAAMrD,KAAK,KAAKqD,MAAMjD,QAAU,KAAKiF,QAAUK,KAIxDvQ,EAAG+C,MAAMmO,KAAO,SAAShD,GACvBlO,EAAG+C,MAAMkL,KAAK/J,KAAK,KAAMgK,EAAOlO,EAAG+C,MAAMC,MAAM4E,KAAM,IAChDsH,KAAAA,YAAc,EACdiC,KAAAA,WAAY,GAGnBnR,EAAG+C,MAAMmO,KAAKpP,UAAY,IAAI9B,EAAG+C,MAAMkL,KAEvCjO,EAAG+C,MAAMmO,KAAKpP,UAAUiN,cAAgB,WACjC,KAAKoC,YACH7C,KAAAA,cAAgB,GAEnB,KAAK6C,YACF7C,KAAAA,cAAgB,EACjB,KAAKA,cAAgB,IAClB3M,KAAAA,OACAuM,KAAAA,MAAMpL,QAAQ9C,EAAG+C,MAAMC,MAAMC,SAGlC,KAAKqL,cAAgB,KAAKY,cACvBiC,KAAAA,WAAY,EACZ7C,KAAAA,cAAgB,IAIzBtO,EAAG+C,MAAMmO,KAAKpP,UAAU8M,QAAU,WAC3B,KAAKuC,UAOJ,KAAK7C,eAAiB,KAAKY,YAAc,EACtChB,KAAAA,MAAMrD,KAAK,KAAKqD,MAAMjD,OAAS,IAE/BiD,KAAAA,MAAMrD,KAAK,KAAKqD,MAAMjD,OAAS,IATZ,IAAtB,KAAKqD,aACFJ,KAAAA,MAAMrD,KAAK,KAAKqD,MAAMjD,OAAS,IAE/BiD,KAAAA,MAAMrD,KAAK,KAAKqD,MAAMjD,OAAS,KAW1CjL,EAAG+C,MAAMmO,KAAKpP,UAAUyN,YAAc,WAC/BrB,KAAAA,MAAMmC,UAGbrQ,EAAG+C,MAAMmO,KAAKpP,UAAU4M,UAAY,WAC7ByC,KAAAA,WAAY,EACZjD,KAAAA,MAAMkC,QAGbpQ,EAAG+C,MAAMqO,YAAc,SAASlD,GAC9BlO,EAAG+C,MAAMkL,KAAK/J,KAAK,KAAMgK,EAAOlO,EAAG+C,MAAMC,MAAMsE,aAAc,IACxD4H,KAAAA,YAAc,EACdmC,KAAAA,aAAenD,EAAMb,oBAG5BrN,EAAG+C,MAAMqO,YAAYtP,UAAY,IAAI9B,EAAG+C,MAAMkL,KAE9CjO,EAAG+C,MAAMqO,YAAYtP,UAAUyN,YAAc,WACtCrB,KAAAA,MAAMmC,SACNnC,KAAAA,MAAMoD,UAAU,KAAKD,eAG5BrR,EAAG+C,MAAMqO,YAAYtP,UAAU4M,UAAY,WACpCR,KAAAA,MAAMkC,OACNlC,KAAAA,MAAMoD,UAAU,KAAKD,aAAe,IAG3CrR,EAAG+C,MAAMqO,YAAYtP,UAAUiN,cAAgB,WACxCT,KAAAA,cAAgB,EACjB,KAAKA,cAAgB,KAAKY,cACvBvN,KAAAA,OACAuM,KAAAA,MAAMpL,QAAQ9C,EAAG+C,MAAMC,MAAMC,SAItCjD,EAAG+C,MAAMqO,YAAYtP,UAAU8M,QAAU,WACnC,KAAKN,cAAgB,KAAKY,YAAc,GAAK,GAE1ChB,KAAAA,MAAMrD,KAAK,KAAKqD,MAAMjD,OAAS,IAC/BiD,KAAAA,MAAM5K,KAAK,KAAK4K,MAAMvJ,OAAS,MAG/BuJ,KAAAA,MAAMrD,KAAK,KAAKqD,MAAMjD,OAAS,IAC/BiD,KAAAA,MAAM5K,KAAK,KAAK4K,MAAMvJ,OAAS,MAIxC3E,EAAG+C,MAAMwO,aAAe,SAASrD,GAC/BlO,EAAG+C,MAAMkL,KAAK/J,KAAK,KAAMgK,EAAOlO,EAAG+C,MAAMC,MAAMmE,cAAe,IACzD+H,KAAAA,YAAc,EACdmC,KAAAA,aAAenD,EAAMb,oBAG5BrN,EAAG+C,MAAMwO,aAAazP,UAAY,IAAI9B,EAAG+C,MAAMkL,KAE/CjO,EAAG+C,MAAMwO,aAAazP,UAAUyN,YAAc,WACvCrB,KAAAA,MAAMmC,SACNnC,KAAAA,MAAMoD,UAAU,KAAKD,eAG5BrR,EAAG+C,MAAMwO,aAAazP,UAAU4M,UAAY,WACrCR,KAAAA,MAAMkC,OACNlC,KAAAA,MAAMoD,UAAU,KAAKD,aAAe,IAG3CrR,EAAG+C,MAAMwO,aAAazP,UAAUiN,cAAgB,WACzCT,KAAAA,cAAgB,EACjB,KAAKA,cAAgB,KAAKY,cACvBvN,KAAAA,OACAuM,KAAAA,MAAMpL,QAAQ9C,EAAG+C,MAAMC,MAAMC,SAItCjD,EAAG+C,MAAMwO,aAAazP,UAAU8M,QAAU,WACpC,KAAKN,cAAgB,KAAKY,YAAc,GAAK,GAE1ChB,KAAAA,MAAMrD,KAAK,KAAKqD,MAAMjD,OAAS,IAC/BiD,KAAAA,MAAM5K,KAAK,KAAK4K,MAAMvJ,OAAS,MAG/BuJ,KAAAA,MAAMrD,KAAK,KAAKqD,MAAMjD,OAAS,IAC/BiD,KAAAA,MAAM5K,KAAK,KAAK4K,MAAMvJ,OAAS,MAMxC3E,EAAG+C,MAAMyO,OAAS,SAAS9Q,GACzBA,EAAUA,GAAW,GACrBV,EAAG+C,MAAMkL,KAAK/J,KAAK,KAAMxD,EAAQwN,MAAOxN,EAAQsD,KAAMtD,EAAQkP,UAAY,IACrE6B,KAAAA,QAAU/Q,EAAQ+C,OAClByL,KAAAA,YAAcxO,EAAQmP,MACtBsB,KAAAA,WAAY,EACZO,KAAAA,YAAa,EACbC,KAAAA,aAAejR,EAAQkR,aAAe5R,EAAG+C,MAAMC,MAAMC,MACrD4O,KAAAA,iBAAmBnR,EAAQoR,iBAAmB,GAGrD9R,EAAG+C,MAAMyO,OAAO1P,UAAY,IAAI9B,EAAG+C,MAAMkL,KAEzCjO,EAAG+C,MAAMyO,OAAO1P,UAAUiN,cAAgB,WACnC,KAAKoC,YACH7C,KAAAA,cAAgB,GAEnB,KAAK6C,YACF7C,KAAAA,cAAgB,EACjB,KAAKA,cAAgB,IAClB3M,KAAAA,OACAuM,KAAAA,MAAMpL,QAAQ,KAAK6O,aAAc,KAAKE,oBAG3C,KAAKvD,cAAgB,KAAKY,cACxB,KAAK6C,aACFpQ,KAAAA,OACAuM,KAAAA,MAAMpL,QAAQ,KAAK6O,gBAEnBR,KAAAA,WAAY,EACZ7C,KAAAA,cAAgB,KAK3BtO,EAAG+C,MAAMyO,OAAO1P,UAAU8M,QAAU,WAC7B0B,KAAAA,eACA,KAAKoB,YAAc,KAAKpD,eAAiBvJ,KAAKiN,MAAM,KAAK9C,YAAc,KACrEhB,KAAAA,MAAM/J,OAAO,KAAK8N,aAClBP,KAAAA,YAAa,IAItB1R,EAAG+C,MAAMyO,OAAO1P,UAAUmQ,UAAY,WAC7B,OAAA,KAAKR,SAGdzR,EAAG+C,MAAMyO,OAAO1P,UAAUyN,YAAc,WACjCrB,KAAAA,MAAMmC,UAGbrQ,EAAG+C,MAAMyO,OAAO1P,UAAU4M,UAAY,WAC/ByC,KAAAA,WAAY,EACZO,KAAAA,YAAa,EACbxD,KAAAA,MAAMkC,OACNF,KAAAA,QAAU,KAAKhC,MAAMiC,aAG5BnQ,EAAG+C,MAAMyO,OAAO1P,UAAUwO,aAAe,WACnCC,IAAAA,EAAgB,KAAKrC,MAAMiC,YAC3BI,EAAgB,KAAKL,SAClBhC,KAAAA,MAAMrD,KAAK,KAAKqD,MAAMjD,OAASsF,EAAgB,KAAKL,SAEvDK,EAAgB,KAAKL,SAClBhC,KAAAA,MAAMrD,KAAK,KAAKqD,MAAMjD,QAAU,KAAKiF,QAAUK,KAIxDvQ,EAAG+C,MAAMmP,SAAW,SAAShE,GAC3BlO,EAAG+C,MAAMyO,OAAOtN,KAAK,KAAM,CACzBgK,MAAOA,EACPlK,KAAMhE,EAAG+C,MAAMC,MAAM2E,UACrBkI,MAAO,EACPpM,OAAQ,MAIZzD,EAAG+C,MAAMmP,SAASpQ,UAAY,IAAI9B,EAAG+C,MAAMyO,OAE3CxR,EAAG+C,MAAMoP,QAAU,SAASjE,GAC1BlO,EAAG+C,MAAMyO,OAAOtN,KAAK,KAAM,CACzBgK,MAAOA,EACPlK,KAAMhE,EAAG+C,MAAMC,MAAMwB,SACrBqL,MAAO,EACPpM,OAAQ,MAIZzD,EAAG+C,MAAMoP,QAAQrQ,UAAY,IAAI9B,EAAG+C,MAAMyO,OAE1CxR,EAAG+C,MAAMqP,SAAW,SAASlE,GAC3BlO,EAAG+C,MAAMyO,OAAOtN,KAAK,KAAM,CACzBgK,MAAOA,EACPlK,KAAMhE,EAAG+C,MAAMC,MAAMuB,UACrBsL,MAAO,EACPpM,OAAQ,KAIZzD,EAAG+C,MAAMqP,SAAStQ,UAAY,IAAI9B,EAAG+C,MAAMyO,OAE3CxR,EAAG+C,MAAMsP,UAAY,SAASnE,GAC5BlO,EAAG+C,MAAMyO,OAAOtN,KAAK,KAAM,CACzBgK,MAAOA,EACPlK,KAAMhE,EAAG+C,MAAMC,MAAM6E,WACrBgI,MAAO,EACPpM,OAAQ,MAIZzD,EAAG+C,MAAMsP,UAAUvQ,UAAY,IAAI9B,EAAG+C,MAAMyO,OAE5CxR,EAAG+C,MAAMuP,SAAW,SAASpE,GAC3BlO,EAAG+C,MAAMyO,OAAOtN,KAAK,KAAM,CACzBgK,MAAOA,EACPlK,KAAMhE,EAAG+C,MAAMC,MAAMiC,SACrB4K,MAAO,EACPpM,OAAQ,GACRmM,SAAU,MAId5P,EAAG+C,MAAMuP,SAASxQ,UAAY,IAAI9B,EAAG+C,MAAMyO,OAE3CxR,EAAG+C,MAAMuP,SAASxQ,UAAUyN,YAAc,WACnCrB,KAAAA,MAAMmC,SACNC,KAAAA,gBAGPtQ,EAAG+C,MAAMuP,SAASxQ,UAAU8M,QAAU,WAC/B0B,KAAAA,eACA,KAAKoB,YAAc,KAAKpD,eAAiBvJ,KAAKiN,MAAM,KAAK9C,YAAc,KACrEhB,KAAAA,MAAM/J,OAAO,KAAK8N,aAClBP,KAAAA,YAAa,IAItB1R,EAAG+C,MAAMwP,aAAe,SAASrE,GAC/BlO,EAAG+C,MAAMyO,OAAOtN,KAAK,KAAM,CACzBF,KAAMhE,EAAG+C,MAAMC,MAAMwE,eACrB0G,MAAOA,EACP2B,MAAO,EACPpM,OAAQ,EACRmM,SAAU,GACVgC,YAAa5R,EAAG+C,MAAMC,MAAMsB,MAC5BwN,gBAAiB,KAIrB9R,EAAG+C,MAAMwP,aAAazQ,UAAY,IAAI9B,EAAG+C,MAAMyO,OAE/CxR,EAAG+C,MAAMyP,cAAgB,SAAStE,GAChClO,EAAG+C,MAAMyO,OAAOtN,KAAK,KAAM,CACzBF,KAAMhE,EAAG+C,MAAMC,MAAMyE,gBACrByG,MAAOA,EACP2B,MAAO,EACPpM,OAAQ,EACRmM,SAAU,GACVgC,YAAa5R,EAAG+C,MAAMC,MAAMsB,MAC5BwN,gBAAiB,KAIrB9R,EAAG+C,MAAMyP,cAAc1Q,UAAY,IAAI9B,EAAG+C,MAAMyO,OAEhDxR,EAAG+C,MAAM0P,cAAgB,SAASvE,GAChClO,EAAG+C,MAAMyO,OAAOtN,KAAK,KAAM,CACzBF,KAAMhE,EAAG+C,MAAMC,MAAM0E,gBACrBwG,MAAOA,EACP2B,MAAO,EACPpM,OAAQ,EACRmM,SAAU,GACVgC,YAAa5R,EAAG+C,MAAMC,MAAMsB,MAC5BwN,gBAAiB,KAIrB9R,EAAG+C,MAAM0P,cAAc3Q,UAAY,IAAI9B,EAAG+C,MAAMyO,OAEhDxR,EAAG+C,MAAM2P,SAAW,SAASxE,GAC3BlO,EAAG+C,MAAMyO,OAAOtN,KAAK,KAAM,CACzBgK,MAAOA,EACPlK,KAAMhE,EAAG+C,MAAMC,MAAMoE,UACrByI,MAAO,EACPpM,OAAQ,GACRmM,SAAU,GACVgC,YAAa5R,EAAG+C,MAAMC,MAAMC,QAEzB8O,KAAAA,aAAc,GAGrB/R,EAAG+C,MAAM2P,SAAS5Q,UAAY,IAAI9B,EAAG+C,MAAMyO,OAE3CxR,EAAG+C,MAAM4P,WAAa,SAASzE,EAAOlK,EAAMP,EAAQmP,GAClD5S,EAAG+C,MAAMyO,OAAOtN,KAAK,KAAM,CACzBgK,MAAOA,EACPlK,KAAMA,EACN6L,MAAO,EACPpM,OAAQA,EACRmM,SAAU,KAEPiD,KAAAA,QAAU,CACbjI,GAAI,GACJE,EAAG,IAED8H,IACGC,KAAAA,QAAU,CACbjI,EAAG,GACHE,EAAG,KAGFgI,KAAAA,WAAa,EACbC,KAAAA,SAAW,GAGlB/S,EAAG+C,MAAM4P,WAAW7Q,UAAY,IAAI9B,EAAG+C,MAAMyO,OAE7CxR,EAAG+C,MAAM4P,WAAW7Q,UAAUiN,cAAgB,WACvCT,KAAAA,cAAgB,EAChByE,KAAAA,UAAY,EACb,KAAKD,YAAc,KAAKxE,eACrBA,KAAAA,aAAe,KAAKwE,YAEvB,KAAKC,UAAY,KAAK7D,aACpB,KAAKhB,MAAMxM,UAAUsC,OAAShE,EAAG+C,MAAMC,MAAMuC,MAC1C5D,KAAAA,OACAuM,KAAAA,MAAMpL,QAAQ9C,EAAG+C,MAAMC,MAAMC,OAC7BiL,KAAAA,MAAMrD,KAAK7K,EAAG2M,OAAOrM,cAKhCN,EAAG+C,MAAM4P,WAAW7Q,UAAU8M,QAAU,WACjC,KAAK8C,YAAc,KAAKpD,eAAiB,KAAKwE,aAC5C5E,KAAAA,MAAM/J,OAAO,KAAK8N,aAClBP,KAAAA,YAAa,GAEfxD,KAAAA,MAAMrD,KAAK,KAAKqD,MAAMjD,OAAS,KAAK4H,QAAQ/H,GAC5CoD,KAAAA,MAAM5K,KAAK,KAAK4K,MAAMvJ,OAAS,KAAKkO,QAAQjI,IAGnD5K,EAAG+C,MAAM4P,WAAW7Q,UAAU4M,UAAY,WACnCgD,KAAAA,YAAa,EACbqB,KAAAA,SAAW,EACX7E,KAAAA,MAAMkC,QAGbpQ,EAAG+C,MAAMiQ,SAAW,SAAS9E,EAAO0E,GAC9B5O,IAAAA,EAAOhE,EAAG+C,MAAMC,MAAMkC,mBACtB0N,IACF5O,EAAOhE,EAAG+C,MAAMC,MAAMmC,mBAExBnF,EAAG+C,MAAM4P,WAAWzO,KAAK,KAAMgK,EAAOlK,EAAM,GAAI4O,IAGlD5S,EAAG+C,MAAMiQ,SAASlR,UAAY,IAAI9B,EAAG+C,MAAM4P,WAE3C3S,EAAG+C,MAAMkQ,UAAY,SAAS/E,EAAO0E,GAC/B5O,IAAAA,EAAOhE,EAAG+C,MAAMC,MAAMqC,oBACtBuN,IACF5O,EAAOhE,EAAG+C,MAAMC,MAAMoC,oBAExBpF,EAAG+C,MAAM4P,WAAWzO,KAAK,KAAMgK,EAAOlK,EAAM,EAAG4O,IAGjD5S,EAAG+C,MAAMkQ,UAAUnR,UAAY,IAAI9B,EAAG+C,MAAM4P,WAM5C3S,EAAGc,SAAW,GAEdd,EAAGc,SAASoS,KAAO,CACjBC,SAAS,EACTC,MAAM,GAGRpT,EAAGc,SAASuB,aAAe,CACzBC,KAAM,OACNC,MAAO,SAGTvC,EAAGc,SAASoB,QAAU,SAASxB,GACzByB,IAAAA,EAAOzB,EAAQyB,KAAKsJ,cACpB,IAACzL,EAAGc,SAASoS,KAAK/Q,GACd,KAAA,wBAEHkR,KAAAA,MAAQlR,EACRmR,KAAAA,OAAS5S,EAAQM,MACjB8K,KAAAA,MAAQpL,EAAQY,KAChBiS,KAAAA,MAAQ,IACRC,KAAAA,aAAe9S,EAAQ0B,YACvBqR,KAAAA,OAAS,GACTC,KAAAA,QAAU,GACVC,KAAAA,SAAU,EACVC,KAAAA,UAAY,CACfhJ,EAAG,IACHE,EAAG9K,EAAG2M,OAAOrM,YAEVoC,KAAAA,QAGP1C,EAAGc,SAASoB,QAAQJ,UAAUY,KAAO,SAASmB,GACvCd,KAAAA,MAAQ,GACRA,KAAAA,MAAM/C,EAAG+C,MAAMC,MAAMC,OAAS,IAAIjD,EAAG+C,MAAM+M,MAAM,MACjD/M,KAAAA,MAAM/C,EAAG+C,MAAMC,MAAMuE,MAAQ,IAAIvH,EAAG+C,MAAMgN,KAAK,MAC/ChN,KAAAA,MAAM/C,EAAG+C,MAAMC,MAAMqE,eAAiB,IAAIrH,EAAG+C,MAAMiN,SAAS,MAC5DjN,KAAAA,MAAM/C,EAAG+C,MAAMC,MAAMsB,OAAS,IAAItE,EAAG+C,MAAM2N,MAAM,MACjD3N,KAAAA,MAAM/C,EAAG+C,MAAMC,MAAM2C,OAAS,IAAI3F,EAAG+C,MAAM4N,MAAM,MACjD5N,KAAAA,MAAM/C,EAAG+C,MAAMC,MAAM8E,UAAY,IAAI9H,EAAG+C,MAAM6N,QAAQ,MACtD7N,KAAAA,MAAM/C,EAAG+C,MAAMC,MAAMgL,qBAAuB,IAAIhO,EAAG+C,MAAM8N,kBAAkB,MAC3E9N,KAAAA,MAAM/C,EAAG+C,MAAMC,MAAM2E,WAAa,IAAI3H,EAAG+C,MAAMmP,SAAS,MACxDnP,KAAAA,MAAM/C,EAAG+C,MAAMC,MAAMwB,UAAY,IAAIxE,EAAG+C,MAAMoP,QAAQ,MACtDpP,KAAAA,MAAM/C,EAAG+C,MAAMC,MAAMoE,WAAa,IAAIpH,EAAG+C,MAAM2P,SAAS,MACxD3P,KAAAA,MAAM/C,EAAG+C,MAAMC,MAAMuB,WAAa,IAAIvE,EAAG+C,MAAMqP,SAAS,MACxDrP,KAAAA,MAAM/C,EAAG+C,MAAMC,MAAM6E,YAAc,IAAI7H,EAAG+C,MAAMsP,UAAU,MAC1DtP,KAAAA,MAAM/C,EAAG+C,MAAMC,MAAMiC,UAAY,IAAIjF,EAAG+C,MAAMuP,SAAS,MACvDvP,KAAAA,MAAM/C,EAAG+C,MAAMC,MAAMwE,gBAAkB,IAAIxH,EAAG+C,MAAMwP,aAAa,MACjExP,KAAAA,MAAM/C,EAAG+C,MAAMC,MAAMyE,iBAAmB,IAAIzH,EAAG+C,MAAMyP,cAAc,MACnEzP,KAAAA,MAAM/C,EAAG+C,MAAMC,MAAM0E,iBAAmB,IAAI1H,EAAG+C,MAAM0P,cAAc,MACnE1P,KAAAA,MAAM/C,EAAG+C,MAAMC,MAAM4K,MAAQ,IAAI5N,EAAG+C,MAAMyN,KAAK,MAC/CzN,KAAAA,MAAM/C,EAAG+C,MAAMC,MAAM+K,YAAc,IAAI/N,EAAG+C,MAAMgO,UAAU,MAC1DhO,KAAAA,MAAM/C,EAAG+C,MAAMC,MAAMuC,KAAO,IAAIvF,EAAG+C,MAAM0N,IAAI,MAC7C1N,KAAAA,MAAM/C,EAAG+C,MAAMC,MAAM4E,MAAQ,IAAI5H,EAAG+C,MAAMmO,KAAK,MAC/CnO,KAAAA,MAAM/C,EAAG+C,MAAMC,MAAMmC,mBAAqB,IAAInF,EAAG+C,MAAMiQ,SAAS,MAAM,GACtEjQ,KAAAA,MAAM/C,EAAG+C,MAAMC,MAAMkC,oBAAsB,IAAIlF,EAAG+C,MAAMiQ,SAAS,MAAM,GACvEjQ,KAAAA,MAAM/C,EAAG+C,MAAMC,MAAMoC,oBAAsB,IAAIpF,EAAG+C,MAAMkQ,UAAU,MAAM,GACxElQ,KAAAA,MAAM/C,EAAG+C,MAAMC,MAAMqC,qBAAuB,IAAIrF,EAAG+C,MAAMkQ,UAAU,MAAM,GACzElQ,KAAAA,MAAM/C,EAAG+C,MAAMC,MAAM6K,QAAU,IAAI7N,EAAG+C,MAAM+N,OAAO,MACnD/N,KAAAA,MAAM/C,EAAG+C,MAAMC,MAAM8K,cAAgB,IAAI9N,EAAG+C,MAAMkO,YAAY,MAC9DlO,KAAAA,MAAM/C,EAAG+C,MAAMC,MAAMsE,cAAgB,IAAItH,EAAG+C,MAAMqO,YAAY,MAC9DrO,KAAAA,MAAM/C,EAAG+C,MAAMC,MAAMmE,eAAiB,IAAInH,EAAG+C,MAAMwO,aAAa,MAEjEsC,IAAAA,EAAc,EACZhR,EAAQqE,OAAO1B,KAAK,KAAKzC,OAAOf,OAEjC,IAAA,IAAMyE,KAAQ,KAAK1D,MACjBA,KAAAA,MAAM0D,GAAM/D,KAAK,YACpBmR,GAAe,KACKhR,GACM,mBAAbgB,GACTA,OAOV7D,EAAGc,SAASoB,QAAQJ,UAAUkJ,UAAY,WACpC,IAAC,KAAK8I,aAAc,OAAO,EACzBrN,IAAAA,EAAO,KAAKqN,aAAaC,MACzB1P,EAAIrE,EAAG+C,MAAMC,MAEjByD,OAAAA,IAASpC,EAAEuD,MACXnB,IAASpC,EAAE8C,eACXV,IAASpC,EAAEiD,cACXb,IAASpC,EAAEc,mBACXsB,IAASpC,EAAEa,oBACXuB,IAASpC,EAAEe,oBACXqB,IAASpC,EAAEgB,qBAOfrF,EAAGc,SAASoB,QAAQJ,UAAUU,QAAU,WAC/B,OAAA,KAAK6Q,OAGdrT,EAAGc,SAASoB,QAAQJ,UAAUuB,SAAW,SAASrC,GAC3CsS,KAAAA,OAAStS,GAGhBhB,EAAGc,SAASoB,QAAQJ,UAAU8C,SAAW,WACnC,OAAA,KAAKoP,eAAiB,KAAKA,cAAc7S,MACpC,KAAK6S,cAAc7S,MAErB,KAAKsS,QAGdzT,EAAGc,SAASoB,QAAQJ,UAAUwL,gBAAkB,WACvC,OAAA,KAAKmG,QAGdzT,EAAGc,SAASoB,QAAQJ,UAAUuL,iBAAmB,WAC3C,OAAA,KAAK2G,eAAiB,KAAKA,cAAc5S,OACpC,KAAK4S,cAAc5S,OAErB,KAAKsS,SAGd1T,EAAGc,SAASoB,QAAQJ,UAAUuL,iBAAmB,WACxC,OAAA,KAAKqG,SAGd1T,EAAGc,SAASoB,QAAQJ,UAAUwP,UAAY,SAASlQ,GAC5CsS,KAAAA,QAAUtS,GAGjBpB,EAAGc,SAASoB,QAAQJ,UAAUmS,SAAW,SAAS9S,GAC3CsS,KAAAA,OAAStS,GAGhBnB,EAAGc,SAASoB,QAAQJ,UAAU6L,eAAiB,SAASvL,GACjDoR,KAAAA,aAAepR,GAGtBpC,EAAGc,SAASoB,QAAQJ,UAAUmF,eAAiB,SAAS7E,GAC/C,OAAA,KAAKoR,cAGdxT,EAAGc,SAASoB,QAAQJ,UAAUuK,QAAU,WAClC,KAAKiH,QAAyC,mBAAxB,KAAKA,OAAOjH,SAC/BiH,KAAAA,OAAOjH,QAAQ,OAIxBrM,EAAGc,SAASoB,QAAQJ,UAAU6C,KAAO,WAC5B,OAAA,KAAKiP,UAAUhJ,GAGxB5K,EAAGc,SAASoB,QAAQJ,UAAUsO,KAAO,WAC9BuD,KAAAA,SAAU,GAGjB3T,EAAGc,SAASoB,QAAQJ,UAAUuO,OAAS,WAChCsD,KAAAA,SAAU,GAGjB3T,EAAGc,SAASoB,QAAQJ,UAAUmJ,KAAO,WAC5B,OAAA,KAAK2I,UAAU9I,GAGxB9K,EAAGc,SAASoB,QAAQJ,UAAUwB,KAAO,SAASsH,GACvCgJ,KAAAA,UAAUhJ,EAAI,KAAK0I,OAAOrG,YAAY,KAAM,CAAErC,EAAGA,EAAGE,EAAG,KAAKG,SAAUL,GAG7E5K,EAAGc,SAASoB,QAAQJ,UAAU+I,KAAO,SAASC,GACvC8I,KAAAA,UAAU9I,EAAIA,GAGrB9K,EAAGc,SAASoB,QAAQJ,UAAUgN,SAAW,SAASoF,GAC3CF,KAAAA,cAAgBE,GAGvBlU,EAAGc,SAASoB,QAAQJ,UAAUkL,SAAW,WAChC,OAAA,KAAKgH,eAGdhU,EAAGc,SAASoB,QAAQJ,UAAUqC,OAAS,SAASV,GACzCqI,KAAAA,MAAMvI,gBAAgB,KAAME,IAGnCzD,EAAGc,SAASoB,QAAQJ,UAAUmC,aAAe,SAASR,EAAQ0Q,GACxD9P,IAAAA,EAAIrE,EAAG+C,MAAMC,MAsBV,OApBH,KAAKtB,UAAUsC,OAASK,EAAEsB,MAC5BlC,GAAUzD,EAAG2M,OAAOpM,cAEf8P,KAAAA,SACD,KAAK3O,UAAUsC,OAASK,EAAEC,MACvBxB,KAAAA,QAAQuB,EAAEyJ,cAEXqG,IAAe9P,EAAEY,UAAYkP,IAAe9P,EAAE+C,UAC3CtE,KAAAA,QAAQuB,EAAE0J,YAEVjL,KAAAA,QAAQuB,EAAEwJ,SAIhBlD,KAAAA,QAAQ,KAAK/G,UAAYH,GACP,IAAnB,KAAKG,YACFkI,KAAAA,MAAMxG,YAAY,MAClB+K,KAAAA,SACAvN,KAAAA,QAAQ9C,EAAG+C,MAAMC,MAAM4K,OAEvB,KAAKhK,WAGd5D,EAAGc,SAASoB,QAAQJ,UAAU6I,QAAU,SAASyJ,GAC1Cb,KAAAA,MAAQxO,KAAKsP,IAAID,EAAM,IAG9BpU,EAAGc,SAASoB,QAAQJ,UAAU8B,QAAU,WAC/B,OAAA,KAAK2P,OAGdvT,EAAGc,SAASoB,QAAQJ,UAAUqO,UAAY,WACpCmE,IAAAA,EAAU,KAAKN,cAAc5S,OAAS,KAAK6J,OACxC,OAAA,KAAKqI,OAAOlS,OAASkT,GAG9BtU,EAAGc,SAASoB,QAAQJ,UAAUgB,QAAU,SAAS2D,EAAMgI,GACrDA,EAAOA,GAAQ,EACXpK,IAAAA,EAAIrE,EAAG+C,MAAMC,MACfuR,EAAc,KAAKT,aAEjB,KAAErN,KAAQ,KAAK1D,OAAQ,KAAM,uCAAyC0D,EAEtE,KAAKqN,cAAgB,KAAKA,aAAa9P,OAASyC,IAGlDA,IAASpC,EAAEc,mBACXsB,IAASpC,EAAEa,oBACXuB,IAASpC,EAAEe,oBACXqB,IAASpC,EAAEgB,qBAEPkP,EAAYjG,cAAgBiG,EAAYrF,YAAc,IACnD4E,KAAAA,aAAanS,OACb0O,KAAAA,SACAyD,KAAAA,aAAe,KAAK/Q,MAAM0D,GAC1BqN,KAAAA,aAAa5E,YAAcqF,EAAYrF,YAAcqF,EAAYjG,cAItE,KAAKqF,SAAWlN,IAASpC,EAAEkB,MAE3B,KAAKuO,cAAkD,mBAA3B,KAAKA,aAAanS,MAAqB,KAAKmS,aAAanS,OAEpFmS,KAAAA,aAAe,KAAK/Q,MAAM0D,GAC1BqN,KAAAA,aAAatF,GAAGC,MAGvBzO,EAAGc,SAASoB,QAAQJ,UAAUJ,QAAU,WAC/B,OAAA,KAAKoS,cAGd7L,OAAOjI,GAAKA,EAluDd","file":"mk.ad554de9.map","sourceRoot":"../mk/game","sourcesContent":["import * as images from '../images/**/*.png';\n\nconsole.log(images);\n\n(function() {\n  var mk = {};\n\n  mk.callbacks = {\n    ATTACK: 'attack',\n    GAME_END: 'game-end'\n  };\n\n  mk.config = {\n    ARENAS: 'arenas',\n    FIGHTERS: 'fighters',\n    STEP_DURATION: 80,\n    PLAYER_TOP: 230,\n    BLOCK_DAMAGE: 0.2\n  };\n\n  mk.controllers = {};\n\n  mk.controllers.Base = function(options) {\n    if (!options) return;\n\n    this._callbacks = options.callbacks || {};\n\n    this._initializeFighters(options.fighters);\n\n    const a = options.arena;\n    this.arena = new mk.arenas.Arena({\n      fighters: this.fighters,\n      arena: a.arena,\n      width: a.width,\n      height: a.height,\n      container: a.container,\n      game: this\n    });\n  };\n\n  mk.reset = function() {\n    var game = this.game;\n    if (typeof game.reset === 'function') game.reset();\n    game.fighters.forEach(function(f) {\n      f.getMove().stop();\n    });\n    game.fighters = null;\n    game._opponents = null;\n    game.arena.destroy();\n    game.arena = null;\n    game._callbacks = null;\n    this.game = null;\n  };\n\n  mk.controllers.Base.prototype._initializeFighters = function(fighters) {\n    this.fighters = [];\n    this._opponents = {};\n\n    for (var i = 0; i < fighters.length; i += 1) {\n      this.fighters.push(\n        new mk.fighters.Fighter({\n          name: fighters[i].name,\n          arena: this.arena,\n          orientation: i === 0 ? mk.fighters.orientations.LEFT : mk.fighters.orientations.RIGHT,\n          game: this\n        })\n      );\n    }\n    this._opponents[this.fighters[0].getName()] = this.fighters[1];\n    this._opponents[this.fighters[1].getName()] = this.fighters[0];\n  };\n\n  mk.controllers.Base.prototype.getOpponent = function(f) {\n    return this._opponents[f.getName(name)];\n  };\n\n  mk.controllers.Base.prototype.init = function(promise) {\n    let current = 0;\n    const total = this.fighters.length;\n    for (let i = 0; i < this.fighters.length; i += 1) {\n      let f = this.fighters[i];\n      f.init(() => {\n        f.setMove(mk.moves.types.STAND);\n        current += 1;\n        if (current === total) {\n          this.arena.init();\n          this._setFighersArena();\n          this._initialize();\n          promise._initialized();\n        }\n      });\n    }\n  };\n\n  mk.controllers.Base.prototype._initialize = function() {\n    throw '_initialize is not implemented for this controller!';\n  };\n\n  mk.controllers.Base.prototype._setFighersArena = function() {\n    let f;\n    for (var i = 0; i < this.fighters.length; i += 1) {\n      f = this.fighters[i];\n      f.setArena(this.arena);\n    }\n    f.setX(310); //testing\n  };\n\n  mk.controllers.Base.prototype.fighterAttacked = function(fighter, damage) {\n    var opponent = this.getOpponent(fighter),\n      opponentLife = opponent.getLife(),\n      callback = this._callbacks[mk.callbacks.ATTACK];\n    if (\n      this._requiredDistance(fighter, opponent) &&\n      this._attackCompatible(fighter.getMove().type, opponent.getMove().type)\n    ) {\n      opponent.endureAttack(damage, fighter.getMove().type);\n      if (typeof callback === 'function') {\n        callback.call(null, fighter, opponent, opponentLife - opponent.getLife());\n      }\n    }\n  };\n\n  mk.controllers.Base.prototype._attackCompatible = function(attack, opponentStand) {\n    var m = mk.moves.types;\n    if (opponentStand === m.SQUAT) {\n      if (attack !== m.LOW_PUNCH && attack !== m.LOW_KICK) {\n        return false;\n      }\n    }\n    return true;\n  };\n\n  /**\n   * Checks wheter the attacker is in the required distance to his opponent\n   *\n   * @private\n   * @param {Fighter} attacker The fighter who attacks\n   * @param {Fighter} opponent The fighter who will endure the attack\n   * @return {boolean} true/false depending on the distance between the fighters\n   */\n  mk.controllers.Base.prototype._requiredDistance = function(attacker, opponent) {\n    var fMiddle = attacker.getX() + attacker.getWidth() / 2,\n      oMiddle = opponent.getX() + opponent.getWidth() / 2,\n      distance = Math.abs(fMiddle - oMiddle),\n      m = mk.moves.types,\n      type = attacker.getMove().type,\n      width = opponent.getWidth();\n    if (distance <= width) {\n      return true;\n    }\n    if (type === m.UPPERCUT && distance <= width * 1.2) {\n      return true;\n    }\n    if (\n      (type === m.BACKWARD_JUMP_KICK ||\n        type === m.FORWARD_JUMP_KICK ||\n        type === m.FORWARD_JUMP_PUNCH ||\n        type === m.BACKWARD_JUMP_PUNCH) &&\n      distance <= width * 1.5\n    ) {\n      return true;\n    }\n    return false;\n  };\n\n  mk.controllers.Base.prototype.fighterDead = function(fighter) {\n    var opponent = this.getOpponent(fighter),\n      callback = this._callbacks[mk.callbacks.GAME_END];\n    opponent.getMove().stop();\n    opponent.setMove(mk.moves.types.WIN);\n    if (typeof callback === 'function') {\n      callback.call(null, fighter);\n    }\n  };\n\n  mk.controllers.keys = {\n    RIGHT: 39,\n    LEFT: 37,\n    UP: 38,\n    DOWN: 40,\n    BLOCK: 16,\n    HP: 65,\n    LP: 83,\n    LK: 68,\n    HK: 70\n  };\n\n  mk.controllers.Basic = function(options) {\n    mk.controllers.Base.call(this, options);\n  };\n\n  mk.controllers.Basic.prototype = new mk.controllers.Base();\n\n  mk.controllers.Basic.prototype._initialize = function() {\n    this._player = 0;\n    this._addHandlers();\n  };\n\n  mk.controllers.Basic.prototype._addHandlers = function() {\n    var pressed = {},\n      self = this,\n      f = this.fighters[this._player];\n    document.addEventListener(\n      'keydown',\n      function(e) {\n        pressed[e.keyCode] = true;\n        var move = self._getMove(pressed, mk.controllers.keys, self._player);\n        self._moveFighter(f, move);\n      },\n      false\n    );\n    document.addEventListener(\n      'keyup',\n      function(e) {\n        delete pressed[e.keyCode];\n        var move = self._getMove(pressed, mk.controllers.keys, self._player);\n        self._moveFighter(f, move);\n      },\n      false\n    );\n  };\n\n  mk.controllers.Basic.prototype._moveFighter = function(f, m) {\n    if (m) {\n      f.setMove(m);\n    }\n  };\n\n  mk.controllers.Basic.prototype._getMove = function(pressed, k, p) {\n    const m = mk.moves.types;\n    const f = this.fighters[p];\n    const leftOrient = mk.fighters.orientations.LEFT;\n    const rightOrient = mk.fighters.orientations.RIGHT;\n    const orient = f.getOrientation();\n\n    if (f.getMove().type === m.SQUAT && !pressed[k.DOWN]) {\n      return m.STAND_UP;\n    }\n    if (f.getMove().type === m.BLOCK && !pressed[k.BLOCK]) {\n      return m.STAND;\n    }\n    if (Object.keys(pressed).length === 0) {\n      return m.STAND;\n    }\n    if (pressed[k.BLOCK]) {\n      return m.BLOCK;\n    } else if (pressed[k.LEFT]) {\n      if (pressed[k.UP]) {\n        return m.BACKWARD_JUMP;\n      } else if (pressed[k.HK] && orient === leftOrient) {\n        return m.SPIN_KICK;\n      }\n      return m.WALK_BACKWARD;\n    } else if (pressed[k.RIGHT]) {\n      if (pressed[k.UP]) {\n        return m.FORWARD_JUMP;\n      } else if (pressed[k.HK] && orient === rightOrient) {\n        return m.SPIN_KICK;\n      }\n      return m.WALK;\n    } else if (pressed[k.DOWN]) {\n      if (pressed[k.HP]) {\n        return m.UPPERCUT;\n      } else if (pressed[k.LK]) {\n        return m.SQUAT_LOW_KICK;\n      } else if (pressed[k.HK]) {\n        return m.SQUAT_HIGH_KICK;\n      } else if (pressed[k.LP]) {\n        return m.SQUAT_LOW_PUNCH;\n      }\n      return m.SQUAT;\n    } else if (pressed[k.HK]) {\n      if (f.getMove().type === m.FORWARD_JUMP) {\n        return m.FORWARD_JUMP_KICK;\n      } else if (f.getMove().type === m.BACKWARD_JUMP) {\n        return m.BACKWARD_JUMP_KICK;\n      }\n      return m.HIGH_KICK;\n    } else if (pressed[k.UP]) {\n      return m.JUMP;\n    } else if (pressed[k.LK]) {\n      if (f.getMove().type === m.FORWARD_JUMP) {\n        return m.FORWARD_JUMP_KICK;\n      } else if (f.getMove().type === m.BACKWARD_JUMP) {\n        return m.BACKWARD_JUMP_KICK;\n      }\n      return m.LOW_KICK;\n    } else if (pressed[k.LP]) {\n      if (f.getMove().type === m.FORWARD_JUMP) {\n        return m.FORWARD_JUMP_PUNCH;\n      } else if (f.getMove().type === m.BACKWARD_JUMP) {\n        return m.BACKWARD_JUMP_PUNCH;\n      }\n      return m.LOW_PUNCH;\n    } else if (pressed[k.HP]) {\n      if (f.getMove().type === m.FORWARD_JUMP) {\n        return m.FORWARD_JUMP_PUNCH;\n      } else if (f.getMove().type === m.BACKWARD_JUMP) {\n        return m.BACKWARD_JUMP_PUNCH;\n      }\n      return m.HIGH_PUNCH;\n    }\n  };\n\n  mk.controllers.WebcamInput = function(options) {\n    mk.controllers.Basic.call(this, options);\n  };\n\n  mk.controllers.WebcamInput.prototype = new mk.controllers.Basic();\n\n  mk.controllers.WebcamInput.prototype._initialize = function() {\n    this._player = 1;\n    this._addHandlers();\n    this._addMovementHandlers();\n  };\n\n  mk.controllers.WebcamInput.prototype._addMovementHandlers = function() {\n    var f = this.fighters[0];\n    window.Detect = window.Detect || {};\n    window.Detect.onPunch = function() {\n      f.setMove(mk.moves.types.HIGH_PUNCH);\n    };\n    window.Detect.onKick = function() {\n      f.setMove(mk.moves.types.LOW_KICK);\n    };\n    window.Detect.onStand = function() {\n      f.setMove(mk.moves.types.STAND);\n    };\n  };\n\n  mk.controllers.keys.p1 = {\n    RIGHT: 74,\n    LEFT: 71,\n    UP: 89,\n    DOWN: 72,\n    BLOCK: 16,\n    HP: 65,\n    LP: 83,\n    LK: 68,\n    HK: 70\n  };\n\n  mk.controllers.keys.p2 = {\n    RIGHT: 39,\n    LEFT: 37,\n    UP: 38,\n    DOWN: 40,\n    BLOCK: 17,\n    HP: 80,\n    LP: 219,\n    LK: 221,\n    HK: 220\n  };\n\n  mk.controllers.Multiplayer = function(options) {\n    mk.controllers.Basic.call(this, options);\n  };\n\n  mk.controllers.Multiplayer.prototype = new mk.controllers.Basic();\n\n  mk.controllers.Multiplayer.prototype._initialize = function() {\n    this._addHandlers();\n  };\n\n  mk.controllers.Multiplayer.prototype._addHandlers = function() {\n    var pressed = {},\n      self = this,\n      f1 = this.fighters[0],\n      f2 = this.fighters[1];\n\n    document.addEventListener(\n      'keydown',\n      function(e) {\n        pressed[e.keyCode] = true;\n        var move = self._getMove(pressed, mk.controllers.keys.p1, 0);\n        self._moveFighter(f1, move);\n        move = self._getMove(pressed, mk.controllers.keys.p2, 1);\n        self._moveFighter(f2, move);\n      },\n      false\n    );\n\n    document.addEventListener(\n      'keyup',\n      function(e) {\n        delete pressed[e.keyCode];\n        var move = self._getMove(pressed, mk.controllers.keys.p1, 0);\n        self._moveFighter(f1, move);\n        move = self._getMove(pressed, mk.controllers.keys.p2, 1);\n        self._moveFighter(f2, move);\n      },\n      false\n    );\n  };\n\n  mk.controllers.Multiplayer.prototype._moveFighter = function(fighter, move) {\n    if (move) {\n      fighter.setMove(move);\n    }\n  };\n\n  mk.controllers.Network = function(options) {\n    mk.controllers.Basic.call(this, options);\n    this._isHost = options.isHost;\n    this._gameName = options.gameName;\n    this._transport = options.transport || this.Transports.socketio;\n  };\n\n  mk.callbacks.PLAYER_CONNECTED = 'player-connected';\n\n  mk.controllers.Network.prototype = new mk.controllers.Basic();\n\n  mk.controllers.Network.prototype.Requests = {\n    CREATE_GAME: 'create-game',\n    JOIN_GAME: 'join-game'\n  };\n\n  mk.controllers.Network.prototype.Responses = {\n    SUCCESS: 0,\n    GAME_EXISTS: 1,\n    GAME_NOT_EXISTS: 2,\n    GAME_FULL: 3\n  };\n\n  mk.controllers.Network.prototype.Messages = {\n    EVENT: 'event',\n    LIFE_UPDATE: 'life-update',\n    POSITION_UPDATE: 'position-update',\n    PLAYER_CONNECTED: 'player-connected'\n  };\n\n  mk.controllers.Network.prototype.Transports = {\n    socketio: {}\n  };\n\n  mk.controllers.Network.prototype.Transports.socketio.init = function() {\n    this._socket = io.connect();\n  };\n\n  mk.controllers.Network.prototype.Transports.socketio.emit = function() {\n    this._socket.emit.apply(this._socket, arguments);\n  };\n\n  mk.controllers.Network.prototype.Transports.socketio.on = function() {\n    this._socket.on.apply(this._socket, arguments);\n  };\n\n  mk.controllers.Network.prototype._createGame = function(game) {\n    this._transport.emit(this.Requests.CREATE_GAME, this._gameName);\n    this._addSocketHandlers();\n  };\n\n  mk.controllers.Network.prototype._addSocketHandlers = function() {\n    var opponent = this.fighters[+!this._player],\n      f = this.fighters[this._player],\n      m = this.Messages,\n      self = this;\n    this._transport.on(m.EVENT, function(move) {\n      opponent.setMove(move);\n    });\n    this._transport.on(m.LIFE_UPDATE, function(data) {\n      opponent.setLife(data);\n    });\n    this._transport.on(m.POSITION_UPDATE, function(data) {\n      opponent.setX(data.x);\n      opponent.setY(data.y);\n    });\n    setInterval(function() {\n      self._transport.emit(m.LIFE_UPDATE, f.getLife());\n    }, 2000);\n    setInterval(function() {\n      if (!f.isJumping()) {\n        self._transport.emit(m.POSITION_UPDATE, {\n          x: f.getX(),\n          y: f.getY()\n        });\n      }\n    }, 500);\n    if (this._isHost) {\n      this._transport.on(this.Messages.PLAYER_CONNECTED, function(data) {\n        var c = self._callbacks[mk.callbacks.PLAYER_CONNECTED];\n        if (typeof c === 'function') {\n          c();\n        }\n      });\n    }\n  };\n\n  mk.controllers.Network.prototype._moveFighter = function(f, m) {\n    if (m) {\n      this._transport.emit('event', m);\n      f.setMove(m);\n    }\n  };\n\n  mk.controllers.Network.prototype._joinGame = function(game) {\n    this._transport.emit(this.Requests.JOIN_GAME, this._gameName);\n    this._addSocketHandlers();\n  };\n\n  mk.controllers.Network.prototype._initialize = function() {\n    var self = this;\n    if (this._isHost) {\n      this._player = 1;\n    } else {\n      this._player = 0;\n    }\n    this._addHandlers();\n    this._transport.init();\n    this._transport.on('connect', function() {\n      if (self._isHost) {\n        self._createGame(self._gameName);\n      } else {\n        self._joinGame(self._gameName);\n      }\n    });\n    this._transport.on('response', function(response) {\n      if (response !== self.Responses.SUCCESS) {\n        alert('Error while connecting to the server.');\n      }\n    });\n    this._transport.on('disconnect', function() {\n      alert('Disconnected from the server.');\n    });\n  };\n\n  mk.start = function(options) {\n    var type = options.gameType || 'basic';\n    var promise = new mk.Promise();\n    type = type.toLowerCase();\n    switch (type) {\n      case 'basic':\n        mk.game = new mk.controllers.Basic(options);\n        break;\n      case 'network':\n        mk.game = new mk.controllers.Network(options);\n        break;\n      case 'multiplayer':\n        mk.game = new mk.controllers.Multiplayer(options);\n        break;\n      case 'webcaminput':\n        mk.game = new mk.controllers.WebcamInput(options);\n        break;\n      default:\n        mk.game = new mk.controllers.Basic(options);\n    }\n    mk.game.init(promise);\n    return promise;\n  };\n\n  mk.Promise = function() {\n    this.callbacks = [];\n  };\n\n  mk.Promise.prototype._initialized = function() {\n    this.callbacks.forEach(function(c) {\n      if (typeof c === 'function') {\n        c();\n      }\n    });\n  };\n\n  mk.Promise.prototype.ready = function(callback) {\n    this.callbacks.push(callback);\n  };\n\n  mk.arenas = {\n    types: {\n      TOWER: 0,\n      THRONE_ROOM: 1\n    }\n  };\n\n  mk.arenas.Arena = function(options) {\n    this.width = options.width || 600;\n    this.height = options.height || 400;\n    this.arena = options.arena || mk.arenas.types.TOWER;\n    this.fighters = options.fighters;\n    this._container = options.container;\n    this._game = options.game;\n  };\n\n  mk.arenas.Arena.prototype.init = function() {\n    var canvas = document.createElement('canvas');\n    canvas.width = this.width;\n    canvas.height = this.height;\n    this._container.appendChild(canvas);\n    this._context = canvas.getContext('2d');\n    this._canvas = canvas;\n    this.refresh();\n  };\n\n  mk.arenas.Arena.prototype.destroy = function() {\n    this._container.removeChild(this._canvas);\n    this._canvas = undefined;\n    this._context = undefined;\n    this._container = undefined;\n    this._game = undefined;\n    this.fighters = undefined;\n    this.arena = undefined;\n  };\n\n  mk.arenas.Arena.prototype._drawArena = function() {\n    var img = document.createElement('img'),\n      conf = mk.config,\n      self = this;\n    if (this.texture) {\n      this._context.drawImage(this.texture, 0, 0, this.width, this.height);\n    } else {\n      img.src = images[conf.ARENAS][this.arena].arena;\n      img.width = this.width;\n      img.height = this.height;\n      img.onload = function() {\n        self.texture = img;\n        self._context.drawImage(img, 0, 0, self.width, self.height);\n      };\n    }\n  };\n\n  mk.arenas.Arena.prototype.refresh = function() {\n    this._drawArena();\n    var f;\n    for (var i = 0; i < this.fighters.length; i += 1) {\n      f = this.fighters[i];\n      this._context.drawImage(f.getState(), f.getX(), f.getY());\n    }\n  };\n\n  mk.arenas.Arena.prototype.moveFighter = function(fighter, pos) {\n    const opponent = this._game.getOpponent(fighter);\n    const op = { x: opponent.getX(), y: opponent.getY() };\n    const isOver = pos.y + fighter.getVisibleHeight() <= op.y;\n\n    if (pos.x <= 0) {\n      pos.x = 0;\n    }\n    if (pos.x >= this.width - fighter.getVisibleWidth()) {\n      pos.x = this.width - fighter.getVisibleWidth();\n    }\n\n    if (!isOver) {\n      if (fighter.getOrientation() === mk.fighters.orientations.LEFT) {\n        if (pos.x + fighter.getVisibleWidth() > op.x) {\n          pos = this._synchronizeFighters(pos, fighter, opponent);\n        }\n      } else {\n        if (pos.x < op.x + opponent.getVisibleWidth()) {\n          pos = this._synchronizeFighters(pos, fighter, opponent);\n        }\n      }\n    }\n\n    this._setFightersOrientation(fighter, opponent);\n    return pos;\n  };\n\n  mk.arenas.Arena.prototype._synchronizeFighters = function(pos, fighter, opponent) {\n    if (\n      fighter.getMove().type === mk.moves.types.FORWARD_JUMP ||\n      fighter.getMove().type === mk.moves.types.BACKWARD_JUMP\n    ) {\n      pos.x = fighter.getX();\n      return pos;\n    }\n    let diff;\n    if (fighter.getOrientation() === mk.fighters.orientations.LEFT) {\n      diff = Math.min(\n        this.width - (opponent.getX() + opponent.getVisibleWidth() + fighter.getVisibleWidth()),\n        pos.x - fighter.getX()\n      );\n\n      pos.x = fighter.getX() + diff;\n      if (diff > 0) {\n        opponent.setX(opponent.getX() + diff);\n      }\n    } else {\n      diff = Math.min(opponent.getX(), fighter.getX() - pos.x);\n      if (diff > 0) {\n        pos.x = fighter.getX() - diff;\n        opponent.setX(opponent.getX() - diff);\n        if (opponent.getX() + opponent.getWidth() > pos.x) {\n          pos.x = opponent.getX() + opponent.getVisibleWidth();\n        }\n      } else {\n        pos.x = fighter.getX();\n        if (opponent.getX() + opponent.getWidth() > pos.x) {\n          pos.x = opponent.getX() + opponent.getVisibleWidth();\n        }\n      }\n    }\n    return pos;\n  };\n\n  mk.arenas.Arena.prototype._setFightersOrientation = function(f1, f2) {\n    if (f1.getX() < f2.getX()) {\n      f1.setOrientation(mk.fighters.orientations.LEFT);\n      f2.setOrientation(mk.fighters.orientations.RIGHT);\n    } else {\n      f1.setOrientation(mk.fighters.orientations.RIGHT);\n      f2.setOrientation(mk.fighters.orientations.LEFT);\n    }\n  };\n\n  /* * * * * * * * * * * * * * * * Definition of all movements * * * * * * * * * * * * * * * */\n\n  mk.moves = {};\n\n  mk.moves.types = {\n    STAND: 'stand',\n    WALK: 'walking',\n    WALK_BACKWARD: 'walking-backward',\n    SQUAT: 'squating',\n    STAND_UP: 'stand-up',\n    HIGH_KICK: 'high-kick',\n    JUMP: 'jumping',\n    FORWARD_JUMP: 'forward-jump',\n    BACKWARD_JUMP: 'backward-jump',\n    LOW_KICK: 'low-kick',\n    LOW_PUNCH: 'low-punch',\n    HIGH_PUNCH: 'high-punch',\n    FALL: 'fall',\n    WIN: 'win',\n    ENDURE: 'endure',\n    SQUAT_ENDURE: 'squat-endure',\n    UPPERCUT: 'uppercut',\n    SQUAT_LOW_KICK: 'squat-low-kick',\n    SQUAT_HIGH_KICK: 'squat-high-kick',\n    SQUAT_LOW_PUNCH: 'squat-low-punch',\n    KNOCK_DOWN: 'knock-down',\n    ATTRACTIVE_STAND_UP: 'attractive-stand-up',\n    SPIN_KICK: 'spin-kick',\n    BLOCK: 'blocking',\n    FORWARD_JUMP_KICK: 'forward-jump-kick',\n    BACKWARD_JUMP_KICK: 'backward-jump-kick',\n    BACKWARD_JUMP_PUNCH: 'backward-jump-punch',\n    FORWARD_JUMP_PUNCH: 'forward-jump-punch'\n  };\n\n  /**\n   * Base constructor for all movements\n   *\n   * @constructor\n   * @param {Fighter} owner Owner of the movement\n   * @param {string} type Type of the movement\n   * @param {number} stepDuration Duration between the movements steps\n   */\n  mk.moves.Move = function(owner, type, stepDuration) {\n    this.owner = owner;\n    this.type = type;\n    this._stepDuration = stepDuration || 80;\n    this._interval = -1;\n    this._currentStep = 0;\n    this._actionPending = [];\n  };\n\n  mk.moves.Move.prototype.go = function(step) {\n    var self = this;\n    if (typeof this._beforeGo === 'function') this._beforeGo();\n    this._currentStep = step || 0;\n    this._nextStep(this._action);\n    this._interval = setInterval(function() {\n      self._nextStep(self._action);\n    }, this._stepDuration);\n  };\n\n  mk.moves.Move.prototype._action = function() {};\n\n  mk.moves.Move.prototype._nextStep = function(callback) {\n    var img = document.createElement('img'),\n      conf = mk.config;\n\n    img = this._steps[this.owner.getOrientation()][this._currentStep];\n    this.owner.setState(img);\n    callback.apply(this);\n    this.owner.refresh();\n    this._moveNextStep();\n  };\n\n  mk.moves.Move.prototype.init = function(callback) {\n    var loaded = 0,\n      self = this,\n      img,\n      o = mk.fighters.orientations;\n    this._steps = {};\n    this._steps[o.RIGHT] = [];\n    this._steps[o.LEFT] = [];\n    for (let i = 0; i < this._totalSteps; i += 1) {\n      for (const orientation in o) {\n        img = document.createElement('img');\n        img.onload = function() {\n          loaded += 1;\n          if (loaded === self._totalSteps * 2) {\n            callback.apply(self);\n          }\n        };\n        img.src = this._getImageUrl(i, o[orientation]);\n        this._steps[o[orientation]].push(img);\n      }\n    }\n    if (typeof this.addHandlers === 'function') {\n      this.addHandlers();\n    }\n  };\n\n  mk.moves.Move.prototype._getImageUrl = function(id, ownerOrientation) {\n    var conf = mk.config;\n    return images[conf.FIGHTERS][this.owner.getName()][ownerOrientation][this.type][id];\n  };\n\n  mk.moves.Move.prototype.stop = function(callback) {\n    if (typeof this._beforeStop === 'function') this._beforeStop();\n\n    clearInterval(this._interval);\n\n    if (typeof this._actionPending === 'function') {\n      var func = this._actionPending;\n      this._actionPending = null;\n      func();\n    }\n\n    this._shouldStop = false;\n  };\n\n  mk.moves.CycleMove = function(options) {\n    options = options || {};\n    mk.moves.Move.call(this, options.owner, options.type, options.duration);\n    this._totalSteps = options.steps;\n  };\n\n  mk.moves.CycleMove.prototype = new mk.moves.Move();\n\n  mk.moves.CycleMove.prototype._moveNextStep = function() {\n    this._currentStep += 1;\n    this._currentStep = this._currentStep % this._totalSteps;\n  };\n\n  mk.moves.Stand = function(owner) {\n    mk.moves.CycleMove.call(this, {\n      owner: owner,\n      type: mk.moves.types.STAND,\n      steps: 9\n    });\n  };\n\n  mk.moves.Stand.prototype = new mk.moves.CycleMove();\n\n  mk.moves.Stand.prototype._beforeGo = function() {\n    this.owner.setY(mk.config.PLAYER_TOP);\n  };\n\n  mk.moves.Walk = function(owner) {\n    mk.moves.CycleMove.call(this, {\n      owner: owner,\n      type: mk.moves.types.WALK,\n      steps: 9\n    });\n  };\n\n  mk.moves.Walk.prototype = new mk.moves.CycleMove();\n\n  mk.moves.Walk.prototype._action = function() {\n    this.owner.setX(this.owner.getX() + 10);\n    this.owner.setY(mk.config.PLAYER_TOP);\n  };\n\n  mk.moves.WalkBack = function(owner) {\n    mk.moves.CycleMove.call(this, {\n      owner: owner,\n      type: mk.moves.types.WALK_BACKWARD,\n      steps: 9\n    });\n  };\n\n  mk.moves.WalkBack.prototype = new mk.moves.CycleMove();\n\n  mk.moves.WalkBack.prototype._action = function() {\n    this.owner.setX(this.owner.getX() - 10);\n    this.owner.setY(mk.config.PLAYER_TOP);\n  };\n\n  mk.moves.FiniteMove = function(owner, type, duration) {\n    mk.moves.Move.call(this, owner, type, duration);\n    this._bottom = undefined;\n  };\n\n  mk.moves.FiniteMove.prototype = new mk.moves.Move();\n\n  mk.moves.FiniteMove.prototype._moveNextStep = function() {\n    if (this._currentStep >= this._totalSteps - 1) {\n      this._currentStep = this._totalSteps - 1;\n    } else {\n      this._currentStep = this._currentStep + 1;\n    }\n  };\n\n  mk.moves.FiniteMove.prototype._beforeGo = function() {\n    this._bottom = this.owner.getBottom();\n    this.owner.lock();\n  };\n\n  mk.moves.FiniteMove.prototype._beforeStop = function() {\n    this.owner.unlock();\n  };\n\n  mk.moves.FiniteMove.prototype.keepDistance = function() {\n    var currentBottom = this.owner.getBottom();\n    if (currentBottom > this._bottom) {\n      this.owner.setY(this.owner.getY() + currentBottom - this._bottom);\n    }\n    if (currentBottom < this._bottom) {\n      this.owner.setY(this.owner.getY() - (this._bottom - currentBottom));\n    }\n  };\n\n  mk.moves.Fall = function(owner) {\n    mk.moves.FiniteMove.call(this, owner, mk.moves.types.FALL, 100);\n    this._totalSteps = 7;\n  };\n\n  mk.moves.Fall.prototype = new mk.moves.FiniteMove();\n\n  mk.moves.Fall.prototype._action = function() {\n    this.keepDistance();\n  };\n\n  mk.moves.Win = function(owner) {\n    mk.moves.FiniteMove.call(this, owner, mk.moves.types.WIN, 100);\n    this._totalSteps = 10;\n  };\n\n  mk.moves.Win.prototype = new mk.moves.FiniteMove();\n\n  mk.moves.Win.prototype._action = function() {\n    this.keepDistance();\n  };\n\n  mk.moves.Win.prototype._beforeGo = function() {\n    this.owner.lock();\n    this.owner.setY(mk.config.PLAYER_TOP);\n    this._bottom = this.owner.getBottom();\n  };\n\n  mk.moves.Squat = function(owner) {\n    mk.moves.FiniteMove.call(this, owner, mk.moves.types.SQUAT, 40);\n    this._totalSteps = 3;\n  };\n\n  mk.moves.Squat.prototype = new mk.moves.FiniteMove();\n\n  mk.moves.Squat.prototype._action = function() {\n    this.keepDistance();\n    if (this._currentStep === 2) {\n      this.stop();\n    }\n  };\n\n  mk.moves.Block = function(owner) {\n    mk.moves.FiniteMove.call(this, owner, mk.moves.types.BLOCK, 40);\n    this._totalSteps = 3;\n  };\n\n  mk.moves.Block.prototype = new mk.moves.FiniteMove();\n\n  mk.moves.Block.prototype._action = function() {\n    this.keepDistance();\n    if (this._currentStep === 2) {\n      this.stop();\n    }\n  };\n\n  mk.moves.StandUp = function(owner) {\n    mk.moves.FiniteMove.call(this, owner, mk.moves.types.STAND_UP, 100);\n    this._totalSteps = 3;\n  };\n\n  mk.moves.StandUp.prototype = new mk.moves.FiniteMove();\n\n  mk.moves.StandUp.prototype._action = function() {\n    if (this._currentStep === 2) {\n      this.stop();\n      this.owner.setMove(mk.moves.types.STAND);\n      this.owner.setY(mk.config.PLAYER_TOP);\n    }\n    this.keepDistance();\n  };\n\n  mk.moves.AttractiveStandUp = function(owner) {\n    mk.moves.FiniteMove.call(this, owner, mk.moves.types.ATTRACTIVE_STAND_UP, 100);\n    this._totalSteps = 4;\n  };\n\n  mk.moves.AttractiveStandUp.prototype = new mk.moves.FiniteMove();\n\n  mk.moves.AttractiveStandUp.prototype._action = function() {\n    if (this._currentStep === this._totalSteps - 1) {\n      this.stop();\n      this.owner.setMove(mk.moves.types.STAND);\n    } else {\n      this.keepDistance();\n    }\n  };\n\n  mk.moves.AttractiveStandUp.prototype._beforeStop = function() {\n    this.owner.unlock();\n    this.owner.setY(mk.config.PLAYER_TOP);\n  };\n\n  mk.moves.Endure = function(owner) {\n    mk.moves.Move.call(this, owner, mk.moves.types.ENDURE);\n    this._totalSteps = 3;\n  };\n\n  mk.moves.Endure.prototype = new mk.moves.Move();\n\n  mk.moves.Endure.prototype._action = function() {\n    if (this._currentStep === this._totalSteps - 1) {\n      this.stop();\n      this.owner.setMove(mk.moves.types.STAND);\n    }\n  };\n\n  mk.moves.Endure.prototype._beforeGo = function() {\n    this.owner.lock();\n  };\n\n  mk.moves.Endure.prototype._beforeStop = function() {\n    this.owner.unlock();\n  };\n\n  mk.moves.Endure.prototype._moveNextStep = function() {\n    this._currentStep += 1;\n  };\n\n  mk.moves.KnockDown = function(owner) {\n    mk.moves.Move.call(this, owner, mk.moves.types.KNOCK_DOWN, 80);\n    this._totalSteps = 10;\n  };\n\n  mk.moves.KnockDown.prototype = new mk.moves.Move();\n\n  mk.moves.KnockDown.prototype._action = function() {\n    if (this._currentStep === this._totalSteps - 1) {\n      this.stop();\n      this.owner.setMove(mk.moves.types.ATTRACTIVE_STAND_UP);\n    } else {\n      var xDisplacement = 25;\n      if (this.owner.getOrientation() === mk.fighters.orientations.LEFT) {\n        xDisplacement = -xDisplacement;\n      }\n      if (this._currentStep + 1 > (this._totalSteps - 1) / 2) {\n        this.owner.setY(this.owner.getY() + 10);\n        this.owner.setX(this.owner.getX() + xDisplacement);\n      } else {\n        this.owner.setY(this.owner.getY() + 10);\n        this.owner.setX(this.owner.getX() + xDisplacement);\n      }\n    }\n  };\n\n  mk.moves.KnockDown.prototype._beforeGo = function() {\n    this.owner.lock();\n  };\n\n  mk.moves.KnockDown.prototype._beforeStop = function() {\n    this.owner.unlock();\n  };\n\n  mk.moves.KnockDown.prototype._moveNextStep = function() {\n    this._currentStep += 1;\n  };\n\n  mk.moves.SquatEndure = function(owner) {\n    mk.moves.Move.call(this, owner, mk.moves.types.SQUAT_ENDURE);\n    this._totalSteps = 3;\n  };\n\n  mk.moves.SquatEndure.prototype = new mk.moves.Move();\n\n  mk.moves.SquatEndure.prototype._action = function() {\n    if (this._currentStep === this._totalSteps - 1) {\n      this.stop();\n      this.owner.setMove(mk.moves.types.SQUAT);\n    }\n    this.keepDistance();\n  };\n\n  mk.moves.SquatEndure.prototype._beforeGo = function() {\n    this.owner.lock();\n    if (this._bottom === undefined) this._bottom = this.owner.getBottom();\n  };\n\n  mk.moves.SquatEndure.prototype._beforeStop = function() {\n    this.owner.unlock();\n  };\n\n  mk.moves.SquatEndure.prototype._moveNextStep = function() {\n    this._currentStep += 1;\n  };\n\n  mk.moves.SquatEndure.prototype.keepDistance = function() {\n    var currentBottom = this.owner.getBottom();\n    if (currentBottom > this._bottom) {\n      this.owner.setY(this.owner.getY() + currentBottom - this._bottom);\n    }\n    if (currentBottom < this._bottom) {\n      this.owner.setY(this.owner.getY() - (this._bottom - currentBottom));\n    }\n  };\n\n  mk.moves.Jump = function(owner) {\n    mk.moves.Move.call(this, owner, mk.moves.types.JUMP, 60);\n    this._totalSteps = 6;\n    this._moveBack = false;\n  };\n\n  mk.moves.Jump.prototype = new mk.moves.Move();\n\n  mk.moves.Jump.prototype._moveNextStep = function() {\n    if (!this._moveBack) {\n      this._currentStep += 1;\n    }\n    if (this._moveBack) {\n      this._currentStep -= 1;\n      if (this._currentStep <= 0) {\n        this.stop();\n        this.owner.setMove(mk.moves.types.STAND);\n      }\n    }\n    if (this._currentStep >= this._totalSteps) {\n      this._moveBack = true;\n      this._currentStep -= 1;\n    }\n  };\n\n  mk.moves.Jump.prototype._action = function() {\n    if (!this._moveBack) {\n      if (this._currentStep === 0) {\n        this.owner.setY(this.owner.getY() + 20);\n      } else {\n        this.owner.setY(this.owner.getY() - 20);\n      }\n    } else {\n      if (this._currentStep === this._totalSteps - 1) {\n        this.owner.setY(this.owner.getY() - 20);\n      } else {\n        this.owner.setY(this.owner.getY() + 25);\n      }\n    }\n  };\n\n  mk.moves.Jump.prototype._beforeStop = function() {\n    this.owner.unlock();\n  };\n\n  mk.moves.Jump.prototype._beforeGo = function() {\n    this._moveBack = false;\n    this.owner.lock();\n  };\n\n  mk.moves.ForwardJump = function(owner) {\n    mk.moves.Move.call(this, owner, mk.moves.types.FORWARD_JUMP, 80);\n    this._totalSteps = 8;\n    this._ownerHeight = owner.getVisibleHeight();\n  };\n\n  mk.moves.ForwardJump.prototype = new mk.moves.Move();\n\n  mk.moves.ForwardJump.prototype._beforeStop = function() {\n    this.owner.unlock();\n    this.owner.setHeight(this._ownerHeight);\n  };\n\n  mk.moves.ForwardJump.prototype._beforeGo = function() {\n    this.owner.lock();\n    this.owner.setHeight(this._ownerHeight / 2);\n  };\n\n  mk.moves.ForwardJump.prototype._moveNextStep = function() {\n    this._currentStep += 1;\n    if (this._currentStep >= this._totalSteps) {\n      this.stop();\n      this.owner.setMove(mk.moves.types.STAND);\n    }\n  };\n\n  mk.moves.ForwardJump.prototype._action = function() {\n    if (this._currentStep > (this._totalSteps - 1) / 2) {\n      //Move down\n      this.owner.setY(this.owner.getY() + 26);\n      this.owner.setX(this.owner.getX() + 23);\n    } else {\n      //Move up\n      this.owner.setY(this.owner.getY() - 26);\n      this.owner.setX(this.owner.getX() + 23);\n    }\n  };\n\n  mk.moves.BackwardJump = function(owner) {\n    mk.moves.Move.call(this, owner, mk.moves.types.BACKWARD_JUMP, 80);\n    this._totalSteps = 8;\n    this._ownerHeight = owner.getVisibleHeight();\n  };\n\n  mk.moves.BackwardJump.prototype = new mk.moves.Move();\n\n  mk.moves.BackwardJump.prototype._beforeStop = function() {\n    this.owner.unlock();\n    this.owner.setHeight(this._ownerHeight);\n  };\n\n  mk.moves.BackwardJump.prototype._beforeGo = function() {\n    this.owner.lock();\n    this.owner.setHeight(this._ownerHeight / 2);\n  };\n\n  mk.moves.BackwardJump.prototype._moveNextStep = function() {\n    this._currentStep += 1;\n    if (this._currentStep >= this._totalSteps) {\n      this.stop();\n      this.owner.setMove(mk.moves.types.STAND);\n    }\n  };\n\n  mk.moves.BackwardJump.prototype._action = function() {\n    if (this._currentStep > (this._totalSteps - 1) / 2) {\n      //Move down\n      this.owner.setY(this.owner.getY() + 26);\n      this.owner.setX(this.owner.getX() - 23);\n    } else {\n      //Move up\n      this.owner.setY(this.owner.getY() - 26);\n      this.owner.setX(this.owner.getX() - 23);\n    }\n  };\n\n  /* * * * * * * * * * * * * * Standard attacks * * * * * * * * * * * * * * * */\n\n  mk.moves.Attack = function(options) {\n    options = options || {};\n    mk.moves.Move.call(this, options.owner, options.type, options.duration || 40);\n    this._damage = options.damage;\n    this._totalSteps = options.steps;\n    this._moveBack = false;\n    this._hitPassed = false;\n    this._returnStand = options.returnStand || mk.moves.types.STAND;\n    this._returnStandStep = options.returnStandStep || 0;\n  };\n\n  mk.moves.Attack.prototype = new mk.moves.Move();\n\n  mk.moves.Attack.prototype._moveNextStep = function() {\n    if (!this._moveBack) {\n      this._currentStep += 1;\n    }\n    if (this._moveBack) {\n      this._currentStep -= 1;\n      if (this._currentStep <= 0) {\n        this.stop();\n        this.owner.setMove(this._returnStand, this._returnStandStep);\n      }\n    }\n    if (this._currentStep >= this._totalSteps) {\n      if (this._dontReturn) {\n        this.stop();\n        this.owner.setMove(this._returnStand);\n      } else {\n        this._moveBack = true;\n        this._currentStep -= 1;\n      }\n    }\n  };\n\n  mk.moves.Attack.prototype._action = function() {\n    this.keepDistance();\n    if (!this._hitPassed && this._currentStep === Math.round(this._totalSteps / 2)) {\n      this.owner.attack(this.getDamage());\n      this._hitPassed = true;\n    }\n  };\n\n  mk.moves.Attack.prototype.getDamage = function() {\n    return this._damage;\n  };\n\n  mk.moves.Attack.prototype._beforeStop = function() {\n    this.owner.unlock();\n  };\n\n  mk.moves.Attack.prototype._beforeGo = function() {\n    this._moveBack = false;\n    this._hitPassed = false;\n    this.owner.lock();\n    this._bottom = this.owner.getBottom();\n  };\n\n  mk.moves.Attack.prototype.keepDistance = function() {\n    var currentBottom = this.owner.getBottom();\n    if (currentBottom > this._bottom) {\n      this.owner.setY(this.owner.getY() + currentBottom - this._bottom);\n    }\n    if (currentBottom < this._bottom) {\n      this.owner.setY(this.owner.getY() - (this._bottom - currentBottom));\n    }\n  };\n\n  mk.moves.HighKick = function(owner) {\n    mk.moves.Attack.call(this, {\n      owner: owner,\n      type: mk.moves.types.HIGH_KICK,\n      steps: 7,\n      damage: 10\n    });\n  };\n\n  mk.moves.HighKick.prototype = new mk.moves.Attack();\n\n  mk.moves.LowKick = function(owner) {\n    mk.moves.Attack.call(this, {\n      owner: owner,\n      type: mk.moves.types.LOW_KICK,\n      steps: 6,\n      damage: 25\n    });\n  };\n\n  mk.moves.LowKick.prototype = new mk.moves.Attack();\n\n  mk.moves.LowPunch = function(owner) {\n    mk.moves.Attack.call(this, {\n      owner: owner,\n      type: mk.moves.types.LOW_PUNCH,\n      steps: 5,\n      damage: 5\n    });\n  };\n\n  mk.moves.LowPunch.prototype = new mk.moves.Attack();\n\n  mk.moves.HighPunch = function(owner) {\n    mk.moves.Attack.call(this, {\n      owner: owner,\n      type: mk.moves.types.HIGH_PUNCH,\n      steps: 5,\n      damage: 20\n    });\n  };\n\n  mk.moves.HighPunch.prototype = new mk.moves.Attack();\n\n  mk.moves.Uppercut = function(owner) {\n    mk.moves.Attack.call(this, {\n      owner: owner,\n      type: mk.moves.types.UPPERCUT,\n      steps: 5,\n      damage: 13,\n      duration: 60\n    });\n  };\n\n  mk.moves.Uppercut.prototype = new mk.moves.Attack();\n\n  mk.moves.Uppercut.prototype._beforeStop = function() {\n    this.owner.unlock();\n    this.keepDistance();\n  };\n\n  mk.moves.Uppercut.prototype._action = function() {\n    this.keepDistance();\n    if (!this._hitPassed && this._currentStep === Math.round(this._totalSteps / 2)) {\n      this.owner.attack(this.getDamage());\n      this._hitPassed = true;\n    }\n  };\n\n  mk.moves.SquatLowKick = function(owner) {\n    mk.moves.Attack.call(this, {\n      type: mk.moves.types.SQUAT_LOW_KICK,\n      owner: owner,\n      steps: 3,\n      damage: 4,\n      duration: 70,\n      returnStand: mk.moves.types.SQUAT,\n      returnStandStep: 2\n    });\n  };\n\n  mk.moves.SquatLowKick.prototype = new mk.moves.Attack();\n\n  mk.moves.SquatHighKick = function(owner) {\n    mk.moves.Attack.call(this, {\n      type: mk.moves.types.SQUAT_HIGH_KICK,\n      owner: owner,\n      steps: 4,\n      damage: 6,\n      duration: 70,\n      returnStand: mk.moves.types.SQUAT,\n      returnStandStep: 2\n    });\n  };\n\n  mk.moves.SquatHighKick.prototype = new mk.moves.Attack();\n\n  mk.moves.SquatLowPunch = function(owner) {\n    mk.moves.Attack.call(this, {\n      type: mk.moves.types.SQUAT_LOW_PUNCH,\n      owner: owner,\n      steps: 3,\n      damage: 4,\n      duration: 70,\n      returnStand: mk.moves.types.SQUAT,\n      returnStandStep: 2\n    });\n  };\n\n  mk.moves.SquatLowPunch.prototype = new mk.moves.Attack();\n\n  mk.moves.SpinKick = function(owner) {\n    mk.moves.Attack.call(this, {\n      owner: owner,\n      type: mk.moves.types.SPIN_KICK,\n      steps: 8,\n      damage: 13,\n      duration: 60,\n      returnStand: mk.moves.types.STAND\n    });\n    this._dontReturn = true;\n  };\n\n  mk.moves.SpinKick.prototype = new mk.moves.Attack();\n\n  mk.moves.JumpAttack = function(owner, type, damage, isForward) {\n    mk.moves.Attack.call(this, {\n      owner: owner,\n      type: type,\n      steps: 3, //to be overriden by the fighter\n      damage: damage,\n      duration: 80\n    });\n    this._offset = {\n      x: -23,\n      y: 26\n    };\n    if (isForward) {\n      this._offset = {\n        x: 23,\n        y: 26\n      };\n    }\n    this._totalPics = 2;\n    this._counter = 0;\n  };\n\n  mk.moves.JumpAttack.prototype = new mk.moves.Attack();\n\n  mk.moves.JumpAttack.prototype._moveNextStep = function() {\n    this._currentStep += 1;\n    this._counter += 1;\n    if (this._totalPics <= this._currentStep) {\n      this._currentStep = this._totalPics;\n    }\n    if (this._counter >= this._totalSteps) {\n      if (this.owner.getMove().type !== mk.moves.types.WIN) {\n        this.stop();\n        this.owner.setMove(mk.moves.types.STAND);\n        this.owner.setY(mk.config.PLAYER_TOP);\n      }\n    }\n  };\n\n  mk.moves.JumpAttack.prototype._action = function() {\n    if (!this._hitPassed && this._currentStep === this._totalPics) {\n      this.owner.attack(this.getDamage());\n      this._hitPassed = true;\n    }\n    this.owner.setY(this.owner.getY() + this._offset.y);\n    this.owner.setX(this.owner.getX() + this._offset.x);\n  };\n\n  mk.moves.JumpAttack.prototype._beforeGo = function() {\n    this._hitPassed = false;\n    this._counter = 0;\n    this.owner.lock();\n  };\n\n  mk.moves.JumpKick = function(owner, isForward) {\n    var type = mk.moves.types.BACKWARD_JUMP_KICK;\n    if (isForward) {\n      type = mk.moves.types.FORWARD_JUMP_KICK;\n    }\n    mk.moves.JumpAttack.call(this, owner, type, 10, isForward);\n  };\n\n  mk.moves.JumpKick.prototype = new mk.moves.JumpAttack();\n\n  mk.moves.JumpPunch = function(owner, isForward) {\n    var type = mk.moves.types.BACKWARD_JUMP_PUNCH;\n    if (isForward) {\n      type = mk.moves.types.FORWARD_JUMP_PUNCH;\n    }\n    mk.moves.JumpAttack.call(this, owner, type, 9, isForward);\n  };\n\n  mk.moves.JumpPunch.prototype = new mk.moves.JumpAttack();\n\n  /* * * * * * * * * * * * * * End of the standard attacks * * * * * * * * * * * * * * * */\n\n  /* * * * * * * * * * * * * End of the movements definition * * * * * * * * * * * * * * */\n\n  mk.fighters = {};\n\n  mk.fighters.list = {\n    subzero: true,\n    kano: true\n  };\n\n  mk.fighters.orientations = {\n    LEFT: 'left',\n    RIGHT: 'right'\n  };\n\n  mk.fighters.Fighter = function(options) {\n    var name = options.name.toLowerCase();\n    if (!mk.fighters.list[name]) {\n      throw 'Invalid fighter name!';\n    }\n    this._name = name;\n    this._arena = options.arena;\n    this._game = options.game;\n    this._life = 100;\n    this._orientation = options.orientation;\n    this._width = 30;\n    this._height = 60;\n    this._locked = false;\n    this._position = {\n      x: 260,\n      y: mk.config.PLAYER_TOP\n    };\n    this.init();\n  };\n\n  mk.fighters.Fighter.prototype.init = function(callback) {\n    this.moves = {};\n    this.moves[mk.moves.types.STAND] = new mk.moves.Stand(this);\n    this.moves[mk.moves.types.WALK] = new mk.moves.Walk(this);\n    this.moves[mk.moves.types.WALK_BACKWARD] = new mk.moves.WalkBack(this);\n    this.moves[mk.moves.types.SQUAT] = new mk.moves.Squat(this);\n    this.moves[mk.moves.types.BLOCK] = new mk.moves.Block(this);\n    this.moves[mk.moves.types.STAND_UP] = new mk.moves.StandUp(this);\n    this.moves[mk.moves.types.ATTRACTIVE_STAND_UP] = new mk.moves.AttractiveStandUp(this);\n    this.moves[mk.moves.types.HIGH_KICK] = new mk.moves.HighKick(this);\n    this.moves[mk.moves.types.LOW_KICK] = new mk.moves.LowKick(this);\n    this.moves[mk.moves.types.SPIN_KICK] = new mk.moves.SpinKick(this);\n    this.moves[mk.moves.types.LOW_PUNCH] = new mk.moves.LowPunch(this);\n    this.moves[mk.moves.types.HIGH_PUNCH] = new mk.moves.HighPunch(this);\n    this.moves[mk.moves.types.UPPERCUT] = new mk.moves.Uppercut(this);\n    this.moves[mk.moves.types.SQUAT_LOW_KICK] = new mk.moves.SquatLowKick(this);\n    this.moves[mk.moves.types.SQUAT_HIGH_KICK] = new mk.moves.SquatHighKick(this);\n    this.moves[mk.moves.types.SQUAT_LOW_PUNCH] = new mk.moves.SquatLowPunch(this);\n    this.moves[mk.moves.types.FALL] = new mk.moves.Fall(this);\n    this.moves[mk.moves.types.KNOCK_DOWN] = new mk.moves.KnockDown(this);\n    this.moves[mk.moves.types.WIN] = new mk.moves.Win(this);\n    this.moves[mk.moves.types.JUMP] = new mk.moves.Jump(this);\n    this.moves[mk.moves.types.FORWARD_JUMP_KICK] = new mk.moves.JumpKick(this, true);\n    this.moves[mk.moves.types.BACKWARD_JUMP_KICK] = new mk.moves.JumpKick(this, false);\n    this.moves[mk.moves.types.FORWARD_JUMP_PUNCH] = new mk.moves.JumpPunch(this, true);\n    this.moves[mk.moves.types.BACKWARD_JUMP_PUNCH] = new mk.moves.JumpPunch(this, false);\n    this.moves[mk.moves.types.ENDURE] = new mk.moves.Endure(this);\n    this.moves[mk.moves.types.SQUAT_ENDURE] = new mk.moves.SquatEndure(this);\n    this.moves[mk.moves.types.FORWARD_JUMP] = new mk.moves.ForwardJump(this);\n    this.moves[mk.moves.types.BACKWARD_JUMP] = new mk.moves.BackwardJump(this);\n\n    let initialized = 0;\n    const total = Object.keys(this.moves).length;\n\n    for (const move in this.moves) {\n      this.moves[move].init(function() {\n        initialized += 1;\n        if (initialized === total) {\n          if (typeof callback === 'function') {\n            callback();\n          }\n        }\n      });\n    }\n  };\n\n  mk.fighters.Fighter.prototype.isJumping = function() {\n    if (!this._currentMove) return false;\n    const move = this._currentMove.typep;\n    const m = mk.moves.types;\n    if (\n      move === m.JUMP ||\n      move === m.BACKWARD_JUMP ||\n      move === m.FORWARD_JUMP ||\n      move === m.FORWARD_JUMP_KICK ||\n      move === m.BACKWARD_JUMP_KICK ||\n      move === m.FORWARD_JUMP_PUNCH ||\n      move === m.BACKWARD_JUMP_PUNCH\n    ) {\n      return true;\n    }\n    return false;\n  };\n\n  mk.fighters.Fighter.prototype.getName = function() {\n    return this._name;\n  };\n\n  mk.fighters.Fighter.prototype.setArena = function(arena) {\n    this._arena = arena;\n  };\n\n  mk.fighters.Fighter.prototype.getWidth = function() {\n    if (this._currentState && this._currentState.width) {\n      return this._currentState.width;\n    }\n    return this._width;\n  };\n\n  mk.fighters.Fighter.prototype.getVisibleWidth = function() {\n    return this._width;\n  };\n\n  mk.fighters.Fighter.prototype.getVisibleHeight = function() {\n    if (this._currentState && this._currentState.height) {\n      return this._currentState.height;\n    }\n    return this._height;\n  };\n\n  mk.fighters.Fighter.prototype.getVisibleHeight = function() {\n    return this._height;\n  };\n\n  mk.fighters.Fighter.prototype.setHeight = function(height) {\n    this._height = height;\n  };\n\n  mk.fighters.Fighter.prototype.setWidth = function(width) {\n    this._width = width;\n  };\n\n  mk.fighters.Fighter.prototype.setOrientation = function(orientation) {\n    this._orientation = orientation;\n  };\n\n  mk.fighters.Fighter.prototype.getOrientation = function(orientation) {\n    return this._orientation;\n  };\n\n  mk.fighters.Fighter.prototype.refresh = function() {\n    if (this._arena && typeof this._arena.refresh === 'function') {\n      this._arena.refresh(this);\n    }\n  };\n\n  mk.fighters.Fighter.prototype.getX = function() {\n    return this._position.x;\n  };\n\n  mk.fighters.Fighter.prototype.lock = function() {\n    this._locked = true;\n  };\n\n  mk.fighters.Fighter.prototype.unlock = function() {\n    this._locked = false;\n  };\n\n  mk.fighters.Fighter.prototype.getY = function() {\n    return this._position.y;\n  };\n\n  mk.fighters.Fighter.prototype.setX = function(x) {\n    this._position.x = this._arena.moveFighter(this, { x: x, y: this.getY() }).x;\n  };\n\n  mk.fighters.Fighter.prototype.setY = function(y) {\n    this._position.y = y;\n  };\n\n  mk.fighters.Fighter.prototype.setState = function(state) {\n    this._currentState = state;\n  };\n\n  mk.fighters.Fighter.prototype.getState = function() {\n    return this._currentState;\n  };\n\n  mk.fighters.Fighter.prototype.attack = function(damage) {\n    this._game.fighterAttacked(this, damage);\n  };\n\n  mk.fighters.Fighter.prototype.endureAttack = function(damage, attackType) {\n    var m = mk.moves.types;\n\n    if (this.getMove().type === m.BLOCK) {\n      damage *= mk.config.BLOCK_DAMAGE;\n    } else {\n      this.unlock();\n      if (this.getMove().type === m.SQUAT) {\n        this.setMove(m.SQUAT_ENDURE);\n      } else {\n        if (attackType === m.UPPERCUT || attackType === m.SPIN_KICK) {\n          this.setMove(m.KNOCK_DOWN);\n        } else {\n          this.setMove(m.ENDURE);\n        }\n      }\n    }\n    this.setLife(this.getLife() - damage);\n    if (this.getLife() === 0) {\n      this._game.fighterDead(this);\n      this.unlock();\n      this.setMove(mk.moves.types.FALL);\n    }\n    return this.getLife();\n  };\n\n  mk.fighters.Fighter.prototype.setLife = function(life) {\n    this._life = Math.max(life, 0);\n  };\n\n  mk.fighters.Fighter.prototype.getLife = function() {\n    return this._life;\n  };\n\n  mk.fighters.Fighter.prototype.getBottom = function() {\n    var bottomY = this._currentState.height + this.getY();\n    return this._arena.height - bottomY;\n  };\n\n  mk.fighters.Fighter.prototype.setMove = function(move, step) {\n    step = step || 0;\n    var m = mk.moves.types,\n      currentMove = this._currentMove;\n\n    if (!(move in this.moves)) throw 'This player does not has the move - ' + move;\n\n    if (this._currentMove && this._currentMove.type === move) return;\n\n    if (\n      move === m.FORWARD_JUMP_KICK ||\n      move === m.BACKWARD_JUMP_KICK ||\n      move === m.FORWARD_JUMP_PUNCH ||\n      move === m.BACKWARD_JUMP_PUNCH\n    ) {\n      if (currentMove._currentStep >= currentMove._totalSteps / 2) {\n        this._currentMove.stop();\n        this.unlock();\n        this._currentMove = this.moves[move];\n        this._currentMove._totalSteps = currentMove._totalSteps - currentMove._currentStep;\n      }\n    }\n\n    if (this._locked && move !== m.WIN) return;\n\n    if (this._currentMove && typeof this._currentMove.stop === 'function') this._currentMove.stop();\n\n    this._currentMove = this.moves[move];\n    this._currentMove.go(step);\n  };\n\n  mk.fighters.Fighter.prototype.getMove = function() {\n    return this._currentMove;\n  };\n\n  window.mk = mk;\n})();\n"]}