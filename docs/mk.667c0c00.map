{"version":3,"sources":["src/mk.js"],"names":["console","log","images","mk","callbacks","ATTACK","GAME_END","config","ARENAS","FIGHTERS","STEP_DURATION","PLAYER_TOP","BLOCK_DAMAGE","controllers","Base","options","_callbacks","_initializeFighters","fighters","a","arena","arenas","Arena","width","height","container","game","reset","forEach","f","getMove","stop","_opponents","destroy","prototype","i","length","push","Fighter","name","orientation","orientations","LEFT","RIGHT","getName","getOpponent","init","promise","current","total","setMove","moves","types","STAND","_setFighersArena","_initialize","_initialized","setArena","setX","fighterAttacked","fighter","damage","opponent","opponentLife","getLife","callback","_requiredDistance","_attackCompatible","type","endureAttack","call","attack","opponentStand","m","SQUAT","LOW_PUNCH","LOW_KICK","attacker","fMiddle","getX","getWidth","oMiddle","distance","Math","abs","UPPERCUT","BACKWARD_JUMP_KICK","FORWARD_JUMP_KICK","FORWARD_JUMP_PUNCH","BACKWARD_JUMP_PUNCH","fighterDead","WIN","keys","UP","DOWN","BLOCK","HP","LP","LK","HK","Basic","_player","_addHandlers","pressed","self","document","addEventListener","e","keyCode","move","_getMove","_moveFighter","k","p","leftOrient","rightOrient","orient","getOrientation","STAND_UP","Object","BACKWARD_JUMP","SPIN_KICK","WALK_BACKWARD","FORWARD_JUMP","WALK","SQUAT_LOW_KICK","SQUAT_HIGH_KICK","SQUAT_LOW_PUNCH","HIGH_KICK","JUMP","HIGH_PUNCH","WebcamInput","_addMovementHandlers","window","Detect","onPunch","onKick","onStand","p1","p2","Multiplayer","f1","f2","Network","_isHost","isHost","_gameName","gameName","_transport","transport","Transports","socketio","PLAYER_CONNECTED","Requests","CREATE_GAME","JOIN_GAME","Responses","SUCCESS","GAME_EXISTS","GAME_NOT_EXISTS","GAME_FULL","Messages","EVENT","LIFE_UPDATE","POSITION_UPDATE","_socket","io","connect","emit","apply","arguments","on","_createGame","_addSocketHandlers","data","setLife","x","setY","y","setInterval","isJumping","getY","c","_joinGame","response","alert","start","gameType","Promise","toLowerCase","ready","TOWER","THRONE_ROOM","_container","_game","canvas","createElement","appendChild","_context","getContext","_canvas","refresh","removeChild","undefined","_drawArena","img","conf","texture","drawImage","src","onload","getState","moveFighter","pos","op","isOver","getVisibleHeight","getVisibleWidth","_synchronizeFighters","_setFightersOrientation","diff","min","setOrientation","FALL","ENDURE","SQUAT_ENDURE","KNOCK_DOWN","ATTRACTIVE_STAND_UP","Move","owner","stepDuration","_stepDuration","_interval","_currentStep","_actionPending","go","step","_beforeGo","_nextStep","_action","_steps","setState","_moveNextStep","loaded","o","_totalSteps","_getImageUrl","addHandlers","id","ownerOrientation","_beforeStop","clearInterval","func","_shouldStop","CycleMove","duration","steps","Stand","Walk","WalkBack","FiniteMove","_bottom","getBottom","lock","unlock","keepDistance","currentBottom","Fall","Win","Squat","Block","StandUp","AttractiveStandUp","Endure","KnockDown","xDisplacement","SquatEndure","Jump","_moveBack","ForwardJump","_ownerHeight","setHeight","BackwardJump","Attack","_damage","_hitPassed","_returnStand","returnStand","_returnStandStep","returnStandStep","_dontReturn","round","getDamage","HighKick","LowKick","LowPunch","HighPunch","Uppercut","SquatLowKick","SquatHighKick","SquatLowPunch","SpinKick","JumpAttack","isForward","_offset","_totalPics","_counter","JumpKick","JumpPunch","list","subzero","kano","_name","_arena","_life","_orientation","_width","_height","_locked","_position","initialized","_currentMove","typep","_currentState","setWidth","state","attackType","life","max","bottomY","currentMove"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","file":"mk.667c0c00.map","sourceRoot":"../mk/game","sourcesContent":["import * as images from '../images/**/*.png';\n\nconsole.log(images);\n\n(function() {\n  var mk = {};\n\n  mk.callbacks = {\n    ATTACK: 'attack',\n    GAME_END: 'game-end'\n  };\n\n  mk.config = {\n    ARENAS: 'arenas',\n    FIGHTERS: 'fighters',\n    STEP_DURATION: 80,\n    PLAYER_TOP: 230,\n    BLOCK_DAMAGE: 0.2\n  };\n\n  mk.controllers = {};\n\n  mk.controllers.Base = function(options) {\n    if (!options) return;\n\n    this._callbacks = options.callbacks || {};\n\n    this._initializeFighters(options.fighters);\n\n    const a = options.arena;\n    this.arena = new mk.arenas.Arena({\n      fighters: this.fighters,\n      arena: a.arena,\n      width: a.width,\n      height: a.height,\n      container: a.container,\n      game: this\n    });\n  };\n\n  mk.reset = function() {\n    var game = this.game;\n    if (typeof game.reset === 'function') game.reset();\n    game.fighters.forEach(function(f) {\n      f.getMove().stop();\n    });\n    game.fighters = null;\n    game._opponents = null;\n    game.arena.destroy();\n    game.arena = null;\n    game._callbacks = null;\n    this.game = null;\n  };\n\n  mk.controllers.Base.prototype._initializeFighters = function(fighters) {\n    this.fighters = [];\n    this._opponents = {};\n\n    for (var i = 0; i < fighters.length; i += 1) {\n      this.fighters.push(\n        new mk.fighters.Fighter({\n          name: fighters[i].name,\n          arena: this.arena,\n          orientation: i === 0 ? mk.fighters.orientations.LEFT : mk.fighters.orientations.RIGHT,\n          game: this\n        })\n      );\n    }\n    this._opponents[this.fighters[0].getName()] = this.fighters[1];\n    this._opponents[this.fighters[1].getName()] = this.fighters[0];\n  };\n\n  mk.controllers.Base.prototype.getOpponent = function(f) {\n    return this._opponents[f.getName(name)];\n  };\n\n  mk.controllers.Base.prototype.init = function(promise) {\n    let current = 0;\n    const total = this.fighters.length;\n    for (let i = 0; i < this.fighters.length; i += 1) {\n      let f = this.fighters[i];\n      f.init(() => {\n        f.setMove(mk.moves.types.STAND);\n        current += 1;\n        if (current === total) {\n          this.arena.init();\n          this._setFighersArena();\n          this._initialize();\n          promise._initialized();\n        }\n      });\n    }\n  };\n\n  mk.controllers.Base.prototype._initialize = function() {\n    throw '_initialize is not implemented for this controller!';\n  };\n\n  mk.controllers.Base.prototype._setFighersArena = function() {\n    let f;\n    for (var i = 0; i < this.fighters.length; i += 1) {\n      f = this.fighters[i];\n      f.setArena(this.arena);\n    }\n    f.setX(310); //testing\n  };\n\n  mk.controllers.Base.prototype.fighterAttacked = function(fighter, damage) {\n    var opponent = this.getOpponent(fighter),\n      opponentLife = opponent.getLife(),\n      callback = this._callbacks[mk.callbacks.ATTACK];\n    if (\n      this._requiredDistance(fighter, opponent) &&\n      this._attackCompatible(fighter.getMove().type, opponent.getMove().type)\n    ) {\n      opponent.endureAttack(damage, fighter.getMove().type);\n      if (typeof callback === 'function') {\n        callback.call(null, fighter, opponent, opponentLife - opponent.getLife());\n      }\n    }\n  };\n\n  mk.controllers.Base.prototype._attackCompatible = function(attack, opponentStand) {\n    var m = mk.moves.types;\n    if (opponentStand === m.SQUAT) {\n      if (attack !== m.LOW_PUNCH && attack !== m.LOW_KICK) {\n        return false;\n      }\n    }\n    return true;\n  };\n\n  /**\n   * Checks wheter the attacker is in the required distance to his opponent\n   *\n   * @private\n   * @param {Fighter} attacker The fighter who attacks\n   * @param {Fighter} opponent The fighter who will endure the attack\n   * @return {boolean} true/false depending on the distance between the fighters\n   */\n  mk.controllers.Base.prototype._requiredDistance = function(attacker, opponent) {\n    var fMiddle = attacker.getX() + attacker.getWidth() / 2,\n      oMiddle = opponent.getX() + opponent.getWidth() / 2,\n      distance = Math.abs(fMiddle - oMiddle),\n      m = mk.moves.types,\n      type = attacker.getMove().type,\n      width = opponent.getWidth();\n    if (distance <= width) {\n      return true;\n    }\n    if (type === m.UPPERCUT && distance <= width * 1.2) {\n      return true;\n    }\n    if (\n      (type === m.BACKWARD_JUMP_KICK ||\n        type === m.FORWARD_JUMP_KICK ||\n        type === m.FORWARD_JUMP_PUNCH ||\n        type === m.BACKWARD_JUMP_PUNCH) &&\n      distance <= width * 1.5\n    ) {\n      return true;\n    }\n    return false;\n  };\n\n  mk.controllers.Base.prototype.fighterDead = function(fighter) {\n    var opponent = this.getOpponent(fighter),\n      callback = this._callbacks[mk.callbacks.GAME_END];\n    opponent.getMove().stop();\n    opponent.setMove(mk.moves.types.WIN);\n    if (typeof callback === 'function') {\n      callback.call(null, fighter);\n    }\n  };\n\n  mk.controllers.keys = {\n    RIGHT: 39,\n    LEFT: 37,\n    UP: 38,\n    DOWN: 40,\n    BLOCK: 16,\n    HP: 65,\n    LP: 83,\n    LK: 68,\n    HK: 70\n  };\n\n  mk.controllers.Basic = function(options) {\n    mk.controllers.Base.call(this, options);\n  };\n\n  mk.controllers.Basic.prototype = new mk.controllers.Base();\n\n  mk.controllers.Basic.prototype._initialize = function() {\n    this._player = 0;\n    this._addHandlers();\n  };\n\n  mk.controllers.Basic.prototype._addHandlers = function() {\n    var pressed = {},\n      self = this,\n      f = this.fighters[this._player];\n    document.addEventListener(\n      'keydown',\n      function(e) {\n        pressed[e.keyCode] = true;\n        var move = self._getMove(pressed, mk.controllers.keys, self._player);\n        self._moveFighter(f, move);\n      },\n      false\n    );\n    document.addEventListener(\n      'keyup',\n      function(e) {\n        delete pressed[e.keyCode];\n        var move = self._getMove(pressed, mk.controllers.keys, self._player);\n        self._moveFighter(f, move);\n      },\n      false\n    );\n  };\n\n  mk.controllers.Basic.prototype._moveFighter = function(f, m) {\n    if (m) {\n      f.setMove(m);\n    }\n  };\n\n  mk.controllers.Basic.prototype._getMove = function(pressed, k, p) {\n    const m = mk.moves.types;\n    const f = this.fighters[p];\n    const leftOrient = mk.fighters.orientations.LEFT;\n    const rightOrient = mk.fighters.orientations.RIGHT;\n    const orient = f.getOrientation();\n\n    if (f.getMove().type === m.SQUAT && !pressed[k.DOWN]) {\n      return m.STAND_UP;\n    }\n    if (f.getMove().type === m.BLOCK && !pressed[k.BLOCK]) {\n      return m.STAND;\n    }\n    if (Object.keys(pressed).length === 0) {\n      return m.STAND;\n    }\n    if (pressed[k.BLOCK]) {\n      return m.BLOCK;\n    } else if (pressed[k.LEFT]) {\n      if (pressed[k.UP]) {\n        return m.BACKWARD_JUMP;\n      } else if (pressed[k.HK] && orient === leftOrient) {\n        return m.SPIN_KICK;\n      }\n      return m.WALK_BACKWARD;\n    } else if (pressed[k.RIGHT]) {\n      if (pressed[k.UP]) {\n        return m.FORWARD_JUMP;\n      } else if (pressed[k.HK] && orient === rightOrient) {\n        return m.SPIN_KICK;\n      }\n      return m.WALK;\n    } else if (pressed[k.DOWN]) {\n      if (pressed[k.HP]) {\n        return m.UPPERCUT;\n      } else if (pressed[k.LK]) {\n        return m.SQUAT_LOW_KICK;\n      } else if (pressed[k.HK]) {\n        return m.SQUAT_HIGH_KICK;\n      } else if (pressed[k.LP]) {\n        return m.SQUAT_LOW_PUNCH;\n      }\n      return m.SQUAT;\n    } else if (pressed[k.HK]) {\n      if (f.getMove().type === m.FORWARD_JUMP) {\n        return m.FORWARD_JUMP_KICK;\n      } else if (f.getMove().type === m.BACKWARD_JUMP) {\n        return m.BACKWARD_JUMP_KICK;\n      }\n      return m.HIGH_KICK;\n    } else if (pressed[k.UP]) {\n      return m.JUMP;\n    } else if (pressed[k.LK]) {\n      if (f.getMove().type === m.FORWARD_JUMP) {\n        return m.FORWARD_JUMP_KICK;\n      } else if (f.getMove().type === m.BACKWARD_JUMP) {\n        return m.BACKWARD_JUMP_KICK;\n      }\n      return m.LOW_KICK;\n    } else if (pressed[k.LP]) {\n      if (f.getMove().type === m.FORWARD_JUMP) {\n        return m.FORWARD_JUMP_PUNCH;\n      } else if (f.getMove().type === m.BACKWARD_JUMP) {\n        return m.BACKWARD_JUMP_PUNCH;\n      }\n      return m.LOW_PUNCH;\n    } else if (pressed[k.HP]) {\n      if (f.getMove().type === m.FORWARD_JUMP) {\n        return m.FORWARD_JUMP_PUNCH;\n      } else if (f.getMove().type === m.BACKWARD_JUMP) {\n        return m.BACKWARD_JUMP_PUNCH;\n      }\n      return m.HIGH_PUNCH;\n    }\n  };\n\n  mk.controllers.WebcamInput = function(options) {\n    mk.controllers.Basic.call(this, options);\n  };\n\n  mk.controllers.WebcamInput.prototype = new mk.controllers.Basic();\n\n  mk.controllers.WebcamInput.prototype._initialize = function() {\n    this._player = 1;\n    this._addHandlers();\n    this._addMovementHandlers();\n  };\n\n  mk.controllers.WebcamInput.prototype._addMovementHandlers = function() {\n    var f = this.fighters[0];\n    window.Detect = window.Detect || {};\n    window.Detect.onPunch = function() {\n      f.setMove(mk.moves.types.HIGH_PUNCH);\n    };\n    window.Detect.onKick = function() {\n      f.setMove(mk.moves.types.LOW_KICK);\n    };\n    window.Detect.onStand = function() {\n      f.setMove(mk.moves.types.STAND);\n    };\n  };\n\n  mk.controllers.keys.p1 = {\n    RIGHT: 74,\n    LEFT: 71,\n    UP: 89,\n    DOWN: 72,\n    BLOCK: 16,\n    HP: 65,\n    LP: 83,\n    LK: 68,\n    HK: 70\n  };\n\n  mk.controllers.keys.p2 = {\n    RIGHT: 39,\n    LEFT: 37,\n    UP: 38,\n    DOWN: 40,\n    BLOCK: 17,\n    HP: 80,\n    LP: 219,\n    LK: 221,\n    HK: 220\n  };\n\n  mk.controllers.Multiplayer = function(options) {\n    mk.controllers.Basic.call(this, options);\n  };\n\n  mk.controllers.Multiplayer.prototype = new mk.controllers.Basic();\n\n  mk.controllers.Multiplayer.prototype._initialize = function() {\n    this._addHandlers();\n  };\n\n  mk.controllers.Multiplayer.prototype._addHandlers = function() {\n    var pressed = {},\n      self = this,\n      f1 = this.fighters[0],\n      f2 = this.fighters[1];\n\n    document.addEventListener(\n      'keydown',\n      function(e) {\n        pressed[e.keyCode] = true;\n        var move = self._getMove(pressed, mk.controllers.keys.p1, 0);\n        self._moveFighter(f1, move);\n        move = self._getMove(pressed, mk.controllers.keys.p2, 1);\n        self._moveFighter(f2, move);\n      },\n      false\n    );\n\n    document.addEventListener(\n      'keyup',\n      function(e) {\n        delete pressed[e.keyCode];\n        var move = self._getMove(pressed, mk.controllers.keys.p1, 0);\n        self._moveFighter(f1, move);\n        move = self._getMove(pressed, mk.controllers.keys.p2, 1);\n        self._moveFighter(f2, move);\n      },\n      false\n    );\n  };\n\n  mk.controllers.Multiplayer.prototype._moveFighter = function(fighter, move) {\n    if (move) {\n      fighter.setMove(move);\n    }\n  };\n\n  mk.controllers.Network = function(options) {\n    mk.controllers.Basic.call(this, options);\n    this._isHost = options.isHost;\n    this._gameName = options.gameName;\n    this._transport = options.transport || this.Transports.socketio;\n  };\n\n  mk.callbacks.PLAYER_CONNECTED = 'player-connected';\n\n  mk.controllers.Network.prototype = new mk.controllers.Basic();\n\n  mk.controllers.Network.prototype.Requests = {\n    CREATE_GAME: 'create-game',\n    JOIN_GAME: 'join-game'\n  };\n\n  mk.controllers.Network.prototype.Responses = {\n    SUCCESS: 0,\n    GAME_EXISTS: 1,\n    GAME_NOT_EXISTS: 2,\n    GAME_FULL: 3\n  };\n\n  mk.controllers.Network.prototype.Messages = {\n    EVENT: 'event',\n    LIFE_UPDATE: 'life-update',\n    POSITION_UPDATE: 'position-update',\n    PLAYER_CONNECTED: 'player-connected'\n  };\n\n  mk.controllers.Network.prototype.Transports = {\n    socketio: {}\n  };\n\n  mk.controllers.Network.prototype.Transports.socketio.init = function() {\n    this._socket = io.connect();\n  };\n\n  mk.controllers.Network.prototype.Transports.socketio.emit = function() {\n    this._socket.emit.apply(this._socket, arguments);\n  };\n\n  mk.controllers.Network.prototype.Transports.socketio.on = function() {\n    this._socket.on.apply(this._socket, arguments);\n  };\n\n  mk.controllers.Network.prototype._createGame = function(game) {\n    this._transport.emit(this.Requests.CREATE_GAME, this._gameName);\n    this._addSocketHandlers();\n  };\n\n  mk.controllers.Network.prototype._addSocketHandlers = function() {\n    var opponent = this.fighters[+!this._player],\n      f = this.fighters[this._player],\n      m = this.Messages,\n      self = this;\n    this._transport.on(m.EVENT, function(move) {\n      opponent.setMove(move);\n    });\n    this._transport.on(m.LIFE_UPDATE, function(data) {\n      opponent.setLife(data);\n    });\n    this._transport.on(m.POSITION_UPDATE, function(data) {\n      opponent.setX(data.x);\n      opponent.setY(data.y);\n    });\n    setInterval(function() {\n      self._transport.emit(m.LIFE_UPDATE, f.getLife());\n    }, 2000);\n    setInterval(function() {\n      if (!f.isJumping()) {\n        self._transport.emit(m.POSITION_UPDATE, {\n          x: f.getX(),\n          y: f.getY()\n        });\n      }\n    }, 500);\n    if (this._isHost) {\n      this._transport.on(this.Messages.PLAYER_CONNECTED, function(data) {\n        var c = self._callbacks[mk.callbacks.PLAYER_CONNECTED];\n        if (typeof c === 'function') {\n          c();\n        }\n      });\n    }\n  };\n\n  mk.controllers.Network.prototype._moveFighter = function(f, m) {\n    if (m) {\n      this._transport.emit('event', m);\n      f.setMove(m);\n    }\n  };\n\n  mk.controllers.Network.prototype._joinGame = function(game) {\n    this._transport.emit(this.Requests.JOIN_GAME, this._gameName);\n    this._addSocketHandlers();\n  };\n\n  mk.controllers.Network.prototype._initialize = function() {\n    var self = this;\n    if (this._isHost) {\n      this._player = 1;\n    } else {\n      this._player = 0;\n    }\n    this._addHandlers();\n    this._transport.init();\n    this._transport.on('connect', function() {\n      if (self._isHost) {\n        self._createGame(self._gameName);\n      } else {\n        self._joinGame(self._gameName);\n      }\n    });\n    this._transport.on('response', function(response) {\n      if (response !== self.Responses.SUCCESS) {\n        alert('Error while connecting to the server.');\n      }\n    });\n    this._transport.on('disconnect', function() {\n      alert('Disconnected from the server.');\n    });\n  };\n\n  mk.start = function(options) {\n    var type = options.gameType || 'basic';\n    var promise = new mk.Promise();\n    type = type.toLowerCase();\n    switch (type) {\n      case 'basic':\n        mk.game = new mk.controllers.Basic(options);\n        break;\n      case 'network':\n        mk.game = new mk.controllers.Network(options);\n        break;\n      case 'multiplayer':\n        mk.game = new mk.controllers.Multiplayer(options);\n        break;\n      case 'webcaminput':\n        mk.game = new mk.controllers.WebcamInput(options);\n        break;\n      default:\n        mk.game = new mk.controllers.Basic(options);\n    }\n    mk.game.init(promise);\n    return promise;\n  };\n\n  mk.Promise = function() {\n    this.callbacks = [];\n  };\n\n  mk.Promise.prototype._initialized = function() {\n    this.callbacks.forEach(function(c) {\n      if (typeof c === 'function') {\n        c();\n      }\n    });\n  };\n\n  mk.Promise.prototype.ready = function(callback) {\n    this.callbacks.push(callback);\n  };\n\n  mk.arenas = {\n    types: {\n      TOWER: 0,\n      THRONE_ROOM: 1\n    }\n  };\n\n  mk.arenas.Arena = function(options) {\n    this.width = options.width || 600;\n    this.height = options.height || 400;\n    this.arena = options.arena || mk.arenas.types.TOWER;\n    this.fighters = options.fighters;\n    this._container = options.container;\n    this._game = options.game;\n  };\n\n  mk.arenas.Arena.prototype.init = function() {\n    var canvas = document.createElement('canvas');\n    canvas.width = this.width;\n    canvas.height = this.height;\n    this._container.appendChild(canvas);\n    this._context = canvas.getContext('2d');\n    this._canvas = canvas;\n    this.refresh();\n  };\n\n  mk.arenas.Arena.prototype.destroy = function() {\n    this._container.removeChild(this._canvas);\n    this._canvas = undefined;\n    this._context = undefined;\n    this._container = undefined;\n    this._game = undefined;\n    this.fighters = undefined;\n    this.arena = undefined;\n  };\n\n  mk.arenas.Arena.prototype._drawArena = function() {\n    var img = document.createElement('img'),\n      conf = mk.config,\n      self = this;\n    if (this.texture) {\n      this._context.drawImage(this.texture, 0, 0, this.width, this.height);\n    } else {\n      img.src = images[conf.ARENAS][this.arena].arena;\n      img.width = this.width;\n      img.height = this.height;\n      img.onload = function() {\n        self.texture = img;\n        self._context.drawImage(img, 0, 0, self.width, self.height);\n      };\n    }\n  };\n\n  mk.arenas.Arena.prototype.refresh = function() {\n    this._drawArena();\n    var f;\n    for (var i = 0; i < this.fighters.length; i += 1) {\n      f = this.fighters[i];\n      this._context.drawImage(f.getState(), f.getX(), f.getY());\n    }\n  };\n\n  mk.arenas.Arena.prototype.moveFighter = function(fighter, pos) {\n    const opponent = this._game.getOpponent(fighter);\n    const op = { x: opponent.getX(), y: opponent.getY() };\n    const isOver = pos.y + fighter.getVisibleHeight() <= op.y;\n\n    if (pos.x <= 0) {\n      pos.x = 0;\n    }\n    if (pos.x >= this.width - fighter.getVisibleWidth()) {\n      pos.x = this.width - fighter.getVisibleWidth();\n    }\n\n    if (!isOver) {\n      if (fighter.getOrientation() === mk.fighters.orientations.LEFT) {\n        if (pos.x + fighter.getVisibleWidth() > op.x) {\n          pos = this._synchronizeFighters(pos, fighter, opponent);\n        }\n      } else {\n        if (pos.x < op.x + opponent.getVisibleWidth()) {\n          pos = this._synchronizeFighters(pos, fighter, opponent);\n        }\n      }\n    }\n\n    this._setFightersOrientation(fighter, opponent);\n    return pos;\n  };\n\n  mk.arenas.Arena.prototype._synchronizeFighters = function(pos, fighter, opponent) {\n    if (\n      fighter.getMove().type === mk.moves.types.FORWARD_JUMP ||\n      fighter.getMove().type === mk.moves.types.BACKWARD_JUMP\n    ) {\n      pos.x = fighter.getX();\n      return pos;\n    }\n    let diff;\n    if (fighter.getOrientation() === mk.fighters.orientations.LEFT) {\n      diff = Math.min(\n        this.width - (opponent.getX() + opponent.getVisibleWidth() + fighter.getVisibleWidth()),\n        pos.x - fighter.getX()\n      );\n\n      pos.x = fighter.getX() + diff;\n      if (diff > 0) {\n        opponent.setX(opponent.getX() + diff);\n      }\n    } else {\n      diff = Math.min(opponent.getX(), fighter.getX() - pos.x);\n      if (diff > 0) {\n        pos.x = fighter.getX() - diff;\n        opponent.setX(opponent.getX() - diff);\n        if (opponent.getX() + opponent.getWidth() > pos.x) {\n          pos.x = opponent.getX() + opponent.getVisibleWidth();\n        }\n      } else {\n        pos.x = fighter.getX();\n        if (opponent.getX() + opponent.getWidth() > pos.x) {\n          pos.x = opponent.getX() + opponent.getVisibleWidth();\n        }\n      }\n    }\n    return pos;\n  };\n\n  mk.arenas.Arena.prototype._setFightersOrientation = function(f1, f2) {\n    if (f1.getX() < f2.getX()) {\n      f1.setOrientation(mk.fighters.orientations.LEFT);\n      f2.setOrientation(mk.fighters.orientations.RIGHT);\n    } else {\n      f1.setOrientation(mk.fighters.orientations.RIGHT);\n      f2.setOrientation(mk.fighters.orientations.LEFT);\n    }\n  };\n\n  /* * * * * * * * * * * * * * * * Definition of all movements * * * * * * * * * * * * * * * */\n\n  mk.moves = {};\n\n  mk.moves.types = {\n    STAND: 'stand',\n    WALK: 'walking',\n    WALK_BACKWARD: 'walking-backward',\n    SQUAT: 'squating',\n    STAND_UP: 'stand-up',\n    HIGH_KICK: 'high-kick',\n    JUMP: 'jumping',\n    FORWARD_JUMP: 'forward-jump',\n    BACKWARD_JUMP: 'backward-jump',\n    LOW_KICK: 'low-kick',\n    LOW_PUNCH: 'low-punch',\n    HIGH_PUNCH: 'high-punch',\n    FALL: 'fall',\n    WIN: 'win',\n    ENDURE: 'endure',\n    SQUAT_ENDURE: 'squat-endure',\n    UPPERCUT: 'uppercut',\n    SQUAT_LOW_KICK: 'squat-low-kick',\n    SQUAT_HIGH_KICK: 'squat-high-kick',\n    SQUAT_LOW_PUNCH: 'squat-low-punch',\n    KNOCK_DOWN: 'knock-down',\n    ATTRACTIVE_STAND_UP: 'attractive-stand-up',\n    SPIN_KICK: 'spin-kick',\n    BLOCK: 'blocking',\n    FORWARD_JUMP_KICK: 'forward-jump-kick',\n    BACKWARD_JUMP_KICK: 'backward-jump-kick',\n    BACKWARD_JUMP_PUNCH: 'backward-jump-punch',\n    FORWARD_JUMP_PUNCH: 'forward-jump-punch'\n  };\n\n  /**\n   * Base constructor for all movements\n   *\n   * @constructor\n   * @param {Fighter} owner Owner of the movement\n   * @param {string} type Type of the movement\n   * @param {number} stepDuration Duration between the movements steps\n   */\n  mk.moves.Move = function(owner, type, stepDuration) {\n    this.owner = owner;\n    this.type = type;\n    this._stepDuration = stepDuration || 80;\n    this._interval = -1;\n    this._currentStep = 0;\n    this._actionPending = [];\n  };\n\n  mk.moves.Move.prototype.go = function(step) {\n    var self = this;\n    if (typeof this._beforeGo === 'function') this._beforeGo();\n    this._currentStep = step || 0;\n    this._nextStep(this._action);\n    this._interval = setInterval(function() {\n      self._nextStep(self._action);\n    }, this._stepDuration);\n  };\n\n  mk.moves.Move.prototype._action = function() {};\n\n  mk.moves.Move.prototype._nextStep = function(callback) {\n    var img = document.createElement('img'),\n      conf = mk.config;\n\n    img = this._steps[this.owner.getOrientation()][this._currentStep];\n    this.owner.setState(img);\n    callback.apply(this);\n    this.owner.refresh();\n    this._moveNextStep();\n  };\n\n  mk.moves.Move.prototype.init = function(callback) {\n    var loaded = 0,\n      self = this,\n      img,\n      o = mk.fighters.orientations;\n    this._steps = {};\n    this._steps[o.RIGHT] = [];\n    this._steps[o.LEFT] = [];\n    for (let i = 0; i < this._totalSteps; i += 1) {\n      for (const orientation in o) {\n        img = document.createElement('img');\n        img.onload = function() {\n          loaded += 1;\n          if (loaded === self._totalSteps * 2) {\n            callback.apply(self);\n          }\n        };\n        img.src = this._getImageUrl(i, o[orientation]);\n        this._steps[o[orientation]].push(img);\n      }\n    }\n    if (typeof this.addHandlers === 'function') {\n      this.addHandlers();\n    }\n  };\n\n  mk.moves.Move.prototype._getImageUrl = function(id, ownerOrientation) {\n    var conf = mk.config;\n    return images[conf.FIGHTERS][this.owner.getName()][ownerOrientation][this.type][id];\n  };\n\n  mk.moves.Move.prototype.stop = function(callback) {\n    if (typeof this._beforeStop === 'function') this._beforeStop();\n\n    clearInterval(this._interval);\n\n    if (typeof this._actionPending === 'function') {\n      var func = this._actionPending;\n      this._actionPending = null;\n      func();\n    }\n\n    this._shouldStop = false;\n  };\n\n  mk.moves.CycleMove = function(options) {\n    options = options || {};\n    mk.moves.Move.call(this, options.owner, options.type, options.duration);\n    this._totalSteps = options.steps;\n  };\n\n  mk.moves.CycleMove.prototype = new mk.moves.Move();\n\n  mk.moves.CycleMove.prototype._moveNextStep = function() {\n    this._currentStep += 1;\n    this._currentStep = this._currentStep % this._totalSteps;\n  };\n\n  mk.moves.Stand = function(owner) {\n    mk.moves.CycleMove.call(this, {\n      owner: owner,\n      type: mk.moves.types.STAND,\n      steps: 9\n    });\n  };\n\n  mk.moves.Stand.prototype = new mk.moves.CycleMove();\n\n  mk.moves.Stand.prototype._beforeGo = function() {\n    this.owner.setY(mk.config.PLAYER_TOP);\n  };\n\n  mk.moves.Walk = function(owner) {\n    mk.moves.CycleMove.call(this, {\n      owner: owner,\n      type: mk.moves.types.WALK,\n      steps: 9\n    });\n  };\n\n  mk.moves.Walk.prototype = new mk.moves.CycleMove();\n\n  mk.moves.Walk.prototype._action = function() {\n    this.owner.setX(this.owner.getX() + 10);\n    this.owner.setY(mk.config.PLAYER_TOP);\n  };\n\n  mk.moves.WalkBack = function(owner) {\n    mk.moves.CycleMove.call(this, {\n      owner: owner,\n      type: mk.moves.types.WALK_BACKWARD,\n      steps: 9\n    });\n  };\n\n  mk.moves.WalkBack.prototype = new mk.moves.CycleMove();\n\n  mk.moves.WalkBack.prototype._action = function() {\n    this.owner.setX(this.owner.getX() - 10);\n    this.owner.setY(mk.config.PLAYER_TOP);\n  };\n\n  mk.moves.FiniteMove = function(owner, type, duration) {\n    mk.moves.Move.call(this, owner, type, duration);\n    this._bottom = undefined;\n  };\n\n  mk.moves.FiniteMove.prototype = new mk.moves.Move();\n\n  mk.moves.FiniteMove.prototype._moveNextStep = function() {\n    if (this._currentStep >= this._totalSteps - 1) {\n      this._currentStep = this._totalSteps - 1;\n    } else {\n      this._currentStep = this._currentStep + 1;\n    }\n  };\n\n  mk.moves.FiniteMove.prototype._beforeGo = function() {\n    this._bottom = this.owner.getBottom();\n    this.owner.lock();\n  };\n\n  mk.moves.FiniteMove.prototype._beforeStop = function() {\n    this.owner.unlock();\n  };\n\n  mk.moves.FiniteMove.prototype.keepDistance = function() {\n    var currentBottom = this.owner.getBottom();\n    if (currentBottom > this._bottom) {\n      this.owner.setY(this.owner.getY() + currentBottom - this._bottom);\n    }\n    if (currentBottom < this._bottom) {\n      this.owner.setY(this.owner.getY() - (this._bottom - currentBottom));\n    }\n  };\n\n  mk.moves.Fall = function(owner) {\n    mk.moves.FiniteMove.call(this, owner, mk.moves.types.FALL, 100);\n    this._totalSteps = 7;\n  };\n\n  mk.moves.Fall.prototype = new mk.moves.FiniteMove();\n\n  mk.moves.Fall.prototype._action = function() {\n    this.keepDistance();\n  };\n\n  mk.moves.Win = function(owner) {\n    mk.moves.FiniteMove.call(this, owner, mk.moves.types.WIN, 100);\n    this._totalSteps = 10;\n  };\n\n  mk.moves.Win.prototype = new mk.moves.FiniteMove();\n\n  mk.moves.Win.prototype._action = function() {\n    this.keepDistance();\n  };\n\n  mk.moves.Win.prototype._beforeGo = function() {\n    this.owner.lock();\n    this.owner.setY(mk.config.PLAYER_TOP);\n    this._bottom = this.owner.getBottom();\n  };\n\n  mk.moves.Squat = function(owner) {\n    mk.moves.FiniteMove.call(this, owner, mk.moves.types.SQUAT, 40);\n    this._totalSteps = 3;\n  };\n\n  mk.moves.Squat.prototype = new mk.moves.FiniteMove();\n\n  mk.moves.Squat.prototype._action = function() {\n    this.keepDistance();\n    if (this._currentStep === 2) {\n      this.stop();\n    }\n  };\n\n  mk.moves.Block = function(owner) {\n    mk.moves.FiniteMove.call(this, owner, mk.moves.types.BLOCK, 40);\n    this._totalSteps = 3;\n  };\n\n  mk.moves.Block.prototype = new mk.moves.FiniteMove();\n\n  mk.moves.Block.prototype._action = function() {\n    this.keepDistance();\n    if (this._currentStep === 2) {\n      this.stop();\n    }\n  };\n\n  mk.moves.StandUp = function(owner) {\n    mk.moves.FiniteMove.call(this, owner, mk.moves.types.STAND_UP, 100);\n    this._totalSteps = 3;\n  };\n\n  mk.moves.StandUp.prototype = new mk.moves.FiniteMove();\n\n  mk.moves.StandUp.prototype._action = function() {\n    if (this._currentStep === 2) {\n      this.stop();\n      this.owner.setMove(mk.moves.types.STAND);\n      this.owner.setY(mk.config.PLAYER_TOP);\n    }\n    this.keepDistance();\n  };\n\n  mk.moves.AttractiveStandUp = function(owner) {\n    mk.moves.FiniteMove.call(this, owner, mk.moves.types.ATTRACTIVE_STAND_UP, 100);\n    this._totalSteps = 4;\n  };\n\n  mk.moves.AttractiveStandUp.prototype = new mk.moves.FiniteMove();\n\n  mk.moves.AttractiveStandUp.prototype._action = function() {\n    if (this._currentStep === this._totalSteps - 1) {\n      this.stop();\n      this.owner.setMove(mk.moves.types.STAND);\n    } else {\n      this.keepDistance();\n    }\n  };\n\n  mk.moves.AttractiveStandUp.prototype._beforeStop = function() {\n    this.owner.unlock();\n    this.owner.setY(mk.config.PLAYER_TOP);\n  };\n\n  mk.moves.Endure = function(owner) {\n    mk.moves.Move.call(this, owner, mk.moves.types.ENDURE);\n    this._totalSteps = 3;\n  };\n\n  mk.moves.Endure.prototype = new mk.moves.Move();\n\n  mk.moves.Endure.prototype._action = function() {\n    if (this._currentStep === this._totalSteps - 1) {\n      this.stop();\n      this.owner.setMove(mk.moves.types.STAND);\n    }\n  };\n\n  mk.moves.Endure.prototype._beforeGo = function() {\n    this.owner.lock();\n  };\n\n  mk.moves.Endure.prototype._beforeStop = function() {\n    this.owner.unlock();\n  };\n\n  mk.moves.Endure.prototype._moveNextStep = function() {\n    this._currentStep += 1;\n  };\n\n  mk.moves.KnockDown = function(owner) {\n    mk.moves.Move.call(this, owner, mk.moves.types.KNOCK_DOWN, 80);\n    this._totalSteps = 10;\n  };\n\n  mk.moves.KnockDown.prototype = new mk.moves.Move();\n\n  mk.moves.KnockDown.prototype._action = function() {\n    if (this._currentStep === this._totalSteps - 1) {\n      this.stop();\n      this.owner.setMove(mk.moves.types.ATTRACTIVE_STAND_UP);\n    } else {\n      var xDisplacement = 25;\n      if (this.owner.getOrientation() === mk.fighters.orientations.LEFT) {\n        xDisplacement = -xDisplacement;\n      }\n      if (this._currentStep + 1 > (this._totalSteps - 1) / 2) {\n        this.owner.setY(this.owner.getY() + 10);\n        this.owner.setX(this.owner.getX() + xDisplacement);\n      } else {\n        this.owner.setY(this.owner.getY() + 10);\n        this.owner.setX(this.owner.getX() + xDisplacement);\n      }\n    }\n  };\n\n  mk.moves.KnockDown.prototype._beforeGo = function() {\n    this.owner.lock();\n  };\n\n  mk.moves.KnockDown.prototype._beforeStop = function() {\n    this.owner.unlock();\n  };\n\n  mk.moves.KnockDown.prototype._moveNextStep = function() {\n    this._currentStep += 1;\n  };\n\n  mk.moves.SquatEndure = function(owner) {\n    mk.moves.Move.call(this, owner, mk.moves.types.SQUAT_ENDURE);\n    this._totalSteps = 3;\n  };\n\n  mk.moves.SquatEndure.prototype = new mk.moves.Move();\n\n  mk.moves.SquatEndure.prototype._action = function() {\n    if (this._currentStep === this._totalSteps - 1) {\n      this.stop();\n      this.owner.setMove(mk.moves.types.SQUAT);\n    }\n    this.keepDistance();\n  };\n\n  mk.moves.SquatEndure.prototype._beforeGo = function() {\n    this.owner.lock();\n    if (this._bottom === undefined) this._bottom = this.owner.getBottom();\n  };\n\n  mk.moves.SquatEndure.prototype._beforeStop = function() {\n    this.owner.unlock();\n  };\n\n  mk.moves.SquatEndure.prototype._moveNextStep = function() {\n    this._currentStep += 1;\n  };\n\n  mk.moves.SquatEndure.prototype.keepDistance = function() {\n    var currentBottom = this.owner.getBottom();\n    if (currentBottom > this._bottom) {\n      this.owner.setY(this.owner.getY() + currentBottom - this._bottom);\n    }\n    if (currentBottom < this._bottom) {\n      this.owner.setY(this.owner.getY() - (this._bottom - currentBottom));\n    }\n  };\n\n  mk.moves.Jump = function(owner) {\n    mk.moves.Move.call(this, owner, mk.moves.types.JUMP, 60);\n    this._totalSteps = 6;\n    this._moveBack = false;\n  };\n\n  mk.moves.Jump.prototype = new mk.moves.Move();\n\n  mk.moves.Jump.prototype._moveNextStep = function() {\n    if (!this._moveBack) {\n      this._currentStep += 1;\n    }\n    if (this._moveBack) {\n      this._currentStep -= 1;\n      if (this._currentStep <= 0) {\n        this.stop();\n        this.owner.setMove(mk.moves.types.STAND);\n      }\n    }\n    if (this._currentStep >= this._totalSteps) {\n      this._moveBack = true;\n      this._currentStep -= 1;\n    }\n  };\n\n  mk.moves.Jump.prototype._action = function() {\n    if (!this._moveBack) {\n      if (this._currentStep === 0) {\n        this.owner.setY(this.owner.getY() + 20);\n      } else {\n        this.owner.setY(this.owner.getY() - 20);\n      }\n    } else {\n      if (this._currentStep === this._totalSteps - 1) {\n        this.owner.setY(this.owner.getY() - 20);\n      } else {\n        this.owner.setY(this.owner.getY() + 25);\n      }\n    }\n  };\n\n  mk.moves.Jump.prototype._beforeStop = function() {\n    this.owner.unlock();\n  };\n\n  mk.moves.Jump.prototype._beforeGo = function() {\n    this._moveBack = false;\n    this.owner.lock();\n  };\n\n  mk.moves.ForwardJump = function(owner) {\n    mk.moves.Move.call(this, owner, mk.moves.types.FORWARD_JUMP, 80);\n    this._totalSteps = 8;\n    this._ownerHeight = owner.getVisibleHeight();\n  };\n\n  mk.moves.ForwardJump.prototype = new mk.moves.Move();\n\n  mk.moves.ForwardJump.prototype._beforeStop = function() {\n    this.owner.unlock();\n    this.owner.setHeight(this._ownerHeight);\n  };\n\n  mk.moves.ForwardJump.prototype._beforeGo = function() {\n    this.owner.lock();\n    this.owner.setHeight(this._ownerHeight / 2);\n  };\n\n  mk.moves.ForwardJump.prototype._moveNextStep = function() {\n    this._currentStep += 1;\n    if (this._currentStep >= this._totalSteps) {\n      this.stop();\n      this.owner.setMove(mk.moves.types.STAND);\n    }\n  };\n\n  mk.moves.ForwardJump.prototype._action = function() {\n    if (this._currentStep > (this._totalSteps - 1) / 2) {\n      //Move down\n      this.owner.setY(this.owner.getY() + 26);\n      this.owner.setX(this.owner.getX() + 23);\n    } else {\n      //Move up\n      this.owner.setY(this.owner.getY() - 26);\n      this.owner.setX(this.owner.getX() + 23);\n    }\n  };\n\n  mk.moves.BackwardJump = function(owner) {\n    mk.moves.Move.call(this, owner, mk.moves.types.BACKWARD_JUMP, 80);\n    this._totalSteps = 8;\n    this._ownerHeight = owner.getVisibleHeight();\n  };\n\n  mk.moves.BackwardJump.prototype = new mk.moves.Move();\n\n  mk.moves.BackwardJump.prototype._beforeStop = function() {\n    this.owner.unlock();\n    this.owner.setHeight(this._ownerHeight);\n  };\n\n  mk.moves.BackwardJump.prototype._beforeGo = function() {\n    this.owner.lock();\n    this.owner.setHeight(this._ownerHeight / 2);\n  };\n\n  mk.moves.BackwardJump.prototype._moveNextStep = function() {\n    this._currentStep += 1;\n    if (this._currentStep >= this._totalSteps) {\n      this.stop();\n      this.owner.setMove(mk.moves.types.STAND);\n    }\n  };\n\n  mk.moves.BackwardJump.prototype._action = function() {\n    if (this._currentStep > (this._totalSteps - 1) / 2) {\n      //Move down\n      this.owner.setY(this.owner.getY() + 26);\n      this.owner.setX(this.owner.getX() - 23);\n    } else {\n      //Move up\n      this.owner.setY(this.owner.getY() - 26);\n      this.owner.setX(this.owner.getX() - 23);\n    }\n  };\n\n  /* * * * * * * * * * * * * * Standard attacks * * * * * * * * * * * * * * * */\n\n  mk.moves.Attack = function(options) {\n    options = options || {};\n    mk.moves.Move.call(this, options.owner, options.type, options.duration || 40);\n    this._damage = options.damage;\n    this._totalSteps = options.steps;\n    this._moveBack = false;\n    this._hitPassed = false;\n    this._returnStand = options.returnStand || mk.moves.types.STAND;\n    this._returnStandStep = options.returnStandStep || 0;\n  };\n\n  mk.moves.Attack.prototype = new mk.moves.Move();\n\n  mk.moves.Attack.prototype._moveNextStep = function() {\n    if (!this._moveBack) {\n      this._currentStep += 1;\n    }\n    if (this._moveBack) {\n      this._currentStep -= 1;\n      if (this._currentStep <= 0) {\n        this.stop();\n        this.owner.setMove(this._returnStand, this._returnStandStep);\n      }\n    }\n    if (this._currentStep >= this._totalSteps) {\n      if (this._dontReturn) {\n        this.stop();\n        this.owner.setMove(this._returnStand);\n      } else {\n        this._moveBack = true;\n        this._currentStep -= 1;\n      }\n    }\n  };\n\n  mk.moves.Attack.prototype._action = function() {\n    this.keepDistance();\n    if (!this._hitPassed && this._currentStep === Math.round(this._totalSteps / 2)) {\n      this.owner.attack(this.getDamage());\n      this._hitPassed = true;\n    }\n  };\n\n  mk.moves.Attack.prototype.getDamage = function() {\n    return this._damage;\n  };\n\n  mk.moves.Attack.prototype._beforeStop = function() {\n    this.owner.unlock();\n  };\n\n  mk.moves.Attack.prototype._beforeGo = function() {\n    this._moveBack = false;\n    this._hitPassed = false;\n    this.owner.lock();\n    this._bottom = this.owner.getBottom();\n  };\n\n  mk.moves.Attack.prototype.keepDistance = function() {\n    var currentBottom = this.owner.getBottom();\n    if (currentBottom > this._bottom) {\n      this.owner.setY(this.owner.getY() + currentBottom - this._bottom);\n    }\n    if (currentBottom < this._bottom) {\n      this.owner.setY(this.owner.getY() - (this._bottom - currentBottom));\n    }\n  };\n\n  mk.moves.HighKick = function(owner) {\n    mk.moves.Attack.call(this, {\n      owner: owner,\n      type: mk.moves.types.HIGH_KICK,\n      steps: 7,\n      damage: 10\n    });\n  };\n\n  mk.moves.HighKick.prototype = new mk.moves.Attack();\n\n  mk.moves.LowKick = function(owner) {\n    mk.moves.Attack.call(this, {\n      owner: owner,\n      type: mk.moves.types.LOW_KICK,\n      steps: 6,\n      damage: 25\n    });\n  };\n\n  mk.moves.LowKick.prototype = new mk.moves.Attack();\n\n  mk.moves.LowPunch = function(owner) {\n    mk.moves.Attack.call(this, {\n      owner: owner,\n      type: mk.moves.types.LOW_PUNCH,\n      steps: 5,\n      damage: 5\n    });\n  };\n\n  mk.moves.LowPunch.prototype = new mk.moves.Attack();\n\n  mk.moves.HighPunch = function(owner) {\n    mk.moves.Attack.call(this, {\n      owner: owner,\n      type: mk.moves.types.HIGH_PUNCH,\n      steps: 5,\n      damage: 20\n    });\n  };\n\n  mk.moves.HighPunch.prototype = new mk.moves.Attack();\n\n  mk.moves.Uppercut = function(owner) {\n    mk.moves.Attack.call(this, {\n      owner: owner,\n      type: mk.moves.types.UPPERCUT,\n      steps: 5,\n      damage: 13,\n      duration: 60\n    });\n  };\n\n  mk.moves.Uppercut.prototype = new mk.moves.Attack();\n\n  mk.moves.Uppercut.prototype._beforeStop = function() {\n    this.owner.unlock();\n    this.keepDistance();\n  };\n\n  mk.moves.Uppercut.prototype._action = function() {\n    this.keepDistance();\n    if (!this._hitPassed && this._currentStep === Math.round(this._totalSteps / 2)) {\n      this.owner.attack(this.getDamage());\n      this._hitPassed = true;\n    }\n  };\n\n  mk.moves.SquatLowKick = function(owner) {\n    mk.moves.Attack.call(this, {\n      type: mk.moves.types.SQUAT_LOW_KICK,\n      owner: owner,\n      steps: 3,\n      damage: 4,\n      duration: 70,\n      returnStand: mk.moves.types.SQUAT,\n      returnStandStep: 2\n    });\n  };\n\n  mk.moves.SquatLowKick.prototype = new mk.moves.Attack();\n\n  mk.moves.SquatHighKick = function(owner) {\n    mk.moves.Attack.call(this, {\n      type: mk.moves.types.SQUAT_HIGH_KICK,\n      owner: owner,\n      steps: 4,\n      damage: 6,\n      duration: 70,\n      returnStand: mk.moves.types.SQUAT,\n      returnStandStep: 2\n    });\n  };\n\n  mk.moves.SquatHighKick.prototype = new mk.moves.Attack();\n\n  mk.moves.SquatLowPunch = function(owner) {\n    mk.moves.Attack.call(this, {\n      type: mk.moves.types.SQUAT_LOW_PUNCH,\n      owner: owner,\n      steps: 3,\n      damage: 4,\n      duration: 70,\n      returnStand: mk.moves.types.SQUAT,\n      returnStandStep: 2\n    });\n  };\n\n  mk.moves.SquatLowPunch.prototype = new mk.moves.Attack();\n\n  mk.moves.SpinKick = function(owner) {\n    mk.moves.Attack.call(this, {\n      owner: owner,\n      type: mk.moves.types.SPIN_KICK,\n      steps: 8,\n      damage: 13,\n      duration: 60,\n      returnStand: mk.moves.types.STAND\n    });\n    this._dontReturn = true;\n  };\n\n  mk.moves.SpinKick.prototype = new mk.moves.Attack();\n\n  mk.moves.JumpAttack = function(owner, type, damage, isForward) {\n    mk.moves.Attack.call(this, {\n      owner: owner,\n      type: type,\n      steps: 3, //to be overriden by the fighter\n      damage: damage,\n      duration: 80\n    });\n    this._offset = {\n      x: -23,\n      y: 26\n    };\n    if (isForward) {\n      this._offset = {\n        x: 23,\n        y: 26\n      };\n    }\n    this._totalPics = 2;\n    this._counter = 0;\n  };\n\n  mk.moves.JumpAttack.prototype = new mk.moves.Attack();\n\n  mk.moves.JumpAttack.prototype._moveNextStep = function() {\n    this._currentStep += 1;\n    this._counter += 1;\n    if (this._totalPics <= this._currentStep) {\n      this._currentStep = this._totalPics;\n    }\n    if (this._counter >= this._totalSteps) {\n      if (this.owner.getMove().type !== mk.moves.types.WIN) {\n        this.stop();\n        this.owner.setMove(mk.moves.types.STAND);\n        this.owner.setY(mk.config.PLAYER_TOP);\n      }\n    }\n  };\n\n  mk.moves.JumpAttack.prototype._action = function() {\n    if (!this._hitPassed && this._currentStep === this._totalPics) {\n      this.owner.attack(this.getDamage());\n      this._hitPassed = true;\n    }\n    this.owner.setY(this.owner.getY() + this._offset.y);\n    this.owner.setX(this.owner.getX() + this._offset.x);\n  };\n\n  mk.moves.JumpAttack.prototype._beforeGo = function() {\n    this._hitPassed = false;\n    this._counter = 0;\n    this.owner.lock();\n  };\n\n  mk.moves.JumpKick = function(owner, isForward) {\n    var type = mk.moves.types.BACKWARD_JUMP_KICK;\n    if (isForward) {\n      type = mk.moves.types.FORWARD_JUMP_KICK;\n    }\n    mk.moves.JumpAttack.call(this, owner, type, 10, isForward);\n  };\n\n  mk.moves.JumpKick.prototype = new mk.moves.JumpAttack();\n\n  mk.moves.JumpPunch = function(owner, isForward) {\n    var type = mk.moves.types.BACKWARD_JUMP_PUNCH;\n    if (isForward) {\n      type = mk.moves.types.FORWARD_JUMP_PUNCH;\n    }\n    mk.moves.JumpAttack.call(this, owner, type, 9, isForward);\n  };\n\n  mk.moves.JumpPunch.prototype = new mk.moves.JumpAttack();\n\n  /* * * * * * * * * * * * * * End of the standard attacks * * * * * * * * * * * * * * * */\n\n  /* * * * * * * * * * * * * End of the movements definition * * * * * * * * * * * * * * */\n\n  mk.fighters = {};\n\n  mk.fighters.list = {\n    subzero: true,\n    kano: true\n  };\n\n  mk.fighters.orientations = {\n    LEFT: 'left',\n    RIGHT: 'right'\n  };\n\n  mk.fighters.Fighter = function(options) {\n    var name = options.name.toLowerCase();\n    if (!mk.fighters.list[name]) {\n      throw 'Invalid fighter name!';\n    }\n    this._name = name;\n    this._arena = options.arena;\n    this._game = options.game;\n    this._life = 100;\n    this._orientation = options.orientation;\n    this._width = 30;\n    this._height = 60;\n    this._locked = false;\n    this._position = {\n      x: 260,\n      y: mk.config.PLAYER_TOP\n    };\n    this.init();\n  };\n\n  mk.fighters.Fighter.prototype.init = function(callback) {\n    this.moves = {};\n    this.moves[mk.moves.types.STAND] = new mk.moves.Stand(this);\n    this.moves[mk.moves.types.WALK] = new mk.moves.Walk(this);\n    this.moves[mk.moves.types.WALK_BACKWARD] = new mk.moves.WalkBack(this);\n    this.moves[mk.moves.types.SQUAT] = new mk.moves.Squat(this);\n    this.moves[mk.moves.types.BLOCK] = new mk.moves.Block(this);\n    this.moves[mk.moves.types.STAND_UP] = new mk.moves.StandUp(this);\n    this.moves[mk.moves.types.ATTRACTIVE_STAND_UP] = new mk.moves.AttractiveStandUp(this);\n    this.moves[mk.moves.types.HIGH_KICK] = new mk.moves.HighKick(this);\n    this.moves[mk.moves.types.LOW_KICK] = new mk.moves.LowKick(this);\n    this.moves[mk.moves.types.SPIN_KICK] = new mk.moves.SpinKick(this);\n    this.moves[mk.moves.types.LOW_PUNCH] = new mk.moves.LowPunch(this);\n    this.moves[mk.moves.types.HIGH_PUNCH] = new mk.moves.HighPunch(this);\n    this.moves[mk.moves.types.UPPERCUT] = new mk.moves.Uppercut(this);\n    this.moves[mk.moves.types.SQUAT_LOW_KICK] = new mk.moves.SquatLowKick(this);\n    this.moves[mk.moves.types.SQUAT_HIGH_KICK] = new mk.moves.SquatHighKick(this);\n    this.moves[mk.moves.types.SQUAT_LOW_PUNCH] = new mk.moves.SquatLowPunch(this);\n    this.moves[mk.moves.types.FALL] = new mk.moves.Fall(this);\n    this.moves[mk.moves.types.KNOCK_DOWN] = new mk.moves.KnockDown(this);\n    this.moves[mk.moves.types.WIN] = new mk.moves.Win(this);\n    this.moves[mk.moves.types.JUMP] = new mk.moves.Jump(this);\n    this.moves[mk.moves.types.FORWARD_JUMP_KICK] = new mk.moves.JumpKick(this, true);\n    this.moves[mk.moves.types.BACKWARD_JUMP_KICK] = new mk.moves.JumpKick(this, false);\n    this.moves[mk.moves.types.FORWARD_JUMP_PUNCH] = new mk.moves.JumpPunch(this, true);\n    this.moves[mk.moves.types.BACKWARD_JUMP_PUNCH] = new mk.moves.JumpPunch(this, false);\n    this.moves[mk.moves.types.ENDURE] = new mk.moves.Endure(this);\n    this.moves[mk.moves.types.SQUAT_ENDURE] = new mk.moves.SquatEndure(this);\n    this.moves[mk.moves.types.FORWARD_JUMP] = new mk.moves.ForwardJump(this);\n    this.moves[mk.moves.types.BACKWARD_JUMP] = new mk.moves.BackwardJump(this);\n\n    let initialized = 0;\n    const total = Object.keys(this.moves).length;\n\n    for (const move in this.moves) {\n      this.moves[move].init(function() {\n        initialized += 1;\n        if (initialized === total) {\n          if (typeof callback === 'function') {\n            callback();\n          }\n        }\n      });\n    }\n  };\n\n  mk.fighters.Fighter.prototype.isJumping = function() {\n    if (!this._currentMove) return false;\n    const move = this._currentMove.typep;\n    const m = mk.moves.types;\n    if (\n      move === m.JUMP ||\n      move === m.BACKWARD_JUMP ||\n      move === m.FORWARD_JUMP ||\n      move === m.FORWARD_JUMP_KICK ||\n      move === m.BACKWARD_JUMP_KICK ||\n      move === m.FORWARD_JUMP_PUNCH ||\n      move === m.BACKWARD_JUMP_PUNCH\n    ) {\n      return true;\n    }\n    return false;\n  };\n\n  mk.fighters.Fighter.prototype.getName = function() {\n    return this._name;\n  };\n\n  mk.fighters.Fighter.prototype.setArena = function(arena) {\n    this._arena = arena;\n  };\n\n  mk.fighters.Fighter.prototype.getWidth = function() {\n    if (this._currentState && this._currentState.width) {\n      return this._currentState.width;\n    }\n    return this._width;\n  };\n\n  mk.fighters.Fighter.prototype.getVisibleWidth = function() {\n    return this._width;\n  };\n\n  mk.fighters.Fighter.prototype.getVisibleHeight = function() {\n    if (this._currentState && this._currentState.height) {\n      return this._currentState.height;\n    }\n    return this._height;\n  };\n\n  mk.fighters.Fighter.prototype.getVisibleHeight = function() {\n    return this._height;\n  };\n\n  mk.fighters.Fighter.prototype.setHeight = function(height) {\n    this._height = height;\n  };\n\n  mk.fighters.Fighter.prototype.setWidth = function(width) {\n    this._width = width;\n  };\n\n  mk.fighters.Fighter.prototype.setOrientation = function(orientation) {\n    this._orientation = orientation;\n  };\n\n  mk.fighters.Fighter.prototype.getOrientation = function(orientation) {\n    return this._orientation;\n  };\n\n  mk.fighters.Fighter.prototype.refresh = function() {\n    if (this._arena && typeof this._arena.refresh === 'function') {\n      this._arena.refresh(this);\n    }\n  };\n\n  mk.fighters.Fighter.prototype.getX = function() {\n    return this._position.x;\n  };\n\n  mk.fighters.Fighter.prototype.lock = function() {\n    this._locked = true;\n  };\n\n  mk.fighters.Fighter.prototype.unlock = function() {\n    this._locked = false;\n  };\n\n  mk.fighters.Fighter.prototype.getY = function() {\n    return this._position.y;\n  };\n\n  mk.fighters.Fighter.prototype.setX = function(x) {\n    this._position.x = this._arena.moveFighter(this, { x: x, y: this.getY() }).x;\n  };\n\n  mk.fighters.Fighter.prototype.setY = function(y) {\n    this._position.y = y;\n  };\n\n  mk.fighters.Fighter.prototype.setState = function(state) {\n    this._currentState = state;\n  };\n\n  mk.fighters.Fighter.prototype.getState = function() {\n    return this._currentState;\n  };\n\n  mk.fighters.Fighter.prototype.attack = function(damage) {\n    this._game.fighterAttacked(this, damage);\n  };\n\n  mk.fighters.Fighter.prototype.endureAttack = function(damage, attackType) {\n    var m = mk.moves.types;\n\n    if (this.getMove().type === m.BLOCK) {\n      damage *= mk.config.BLOCK_DAMAGE;\n    } else {\n      this.unlock();\n      if (this.getMove().type === m.SQUAT) {\n        this.setMove(m.SQUAT_ENDURE);\n      } else {\n        if (attackType === m.UPPERCUT || attackType === m.SPIN_KICK) {\n          this.setMove(m.KNOCK_DOWN);\n        } else {\n          this.setMove(m.ENDURE);\n        }\n      }\n    }\n    this.setLife(this.getLife() - damage);\n    if (this.getLife() === 0) {\n      this._game.fighterDead(this);\n      this.unlock();\n      this.setMove(mk.moves.types.FALL);\n    }\n    return this.getLife();\n  };\n\n  mk.fighters.Fighter.prototype.setLife = function(life) {\n    this._life = Math.max(life, 0);\n  };\n\n  mk.fighters.Fighter.prototype.getLife = function() {\n    return this._life;\n  };\n\n  mk.fighters.Fighter.prototype.getBottom = function() {\n    var bottomY = this._currentState.height + this.getY();\n    return this._arena.height - bottomY;\n  };\n\n  mk.fighters.Fighter.prototype.setMove = function(move, step) {\n    step = step || 0;\n    var m = mk.moves.types,\n      currentMove = this._currentMove;\n\n    if (!(move in this.moves)) throw 'This player does not has the move - ' + move;\n\n    if (this._currentMove && this._currentMove.type === move) return;\n\n    if (\n      move === m.FORWARD_JUMP_KICK ||\n      move === m.BACKWARD_JUMP_KICK ||\n      move === m.FORWARD_JUMP_PUNCH ||\n      move === m.BACKWARD_JUMP_PUNCH\n    ) {\n      if (currentMove._currentStep >= currentMove._totalSteps / 2) {\n        this._currentMove.stop();\n        this.unlock();\n        this._currentMove = this.moves[move];\n        this._currentMove._totalSteps = currentMove._totalSteps - currentMove._currentStep;\n      }\n    }\n\n    if (this._locked && move !== m.WIN) return;\n\n    if (this._currentMove && typeof this._currentMove.stop === 'function') this._currentMove.stop();\n\n    this._currentMove = this.moves[move];\n    this._currentMove.go(step);\n  };\n\n  mk.fighters.Fighter.prototype.getMove = function() {\n    return this._currentMove;\n  };\n\n  window.mk = mk;\n})();\n"]}